"use strict";const getGlobalThis=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==this)return this;throw new Error("Unable to locate global `this`")},globalObject=getGlobalThis();var loader;!function(v){let T=0;const C=[],S=[],A={baseUrl:""},E={};function c(v,C,S){let A=null,R={},z=null;"function"==typeof v?R=v:"string"==typeof v?(A=v,"function"==typeof C?R=C:C instanceof Array&&(z=C,R=S)):v instanceof Array&&(z=v,"function"==typeof C&&(R=C)),z=z||["require","exports","module"],null===A&&(A="unnamed-module-"+T++),A=g(A),z=(z||[]).map((v=>function(v,T){return v?b(T,v):T}(A,v))),E[A]||(E[A]={name:A,parent:null,dclamd:1,dependencies:z,handlers:[],exports:{},dependants:new Set}),E[A].dependencies=z,p(z,(function(v){const T=E[A];if(!T)throw new Error("Could not access registered module "+A);let C=T.exports;C="function"==typeof R?R.apply(globalObject,v)||C:R,T.exports=C,d(A)}),(v=>{if("function"!=typeof onerror)throw v;onerror(v)}),A)}function d(v){const T=E[v];if(!T)throw new Error("Could not access registered module "+v);T.dclamd=2;const C=T.handlers;if(C&&C.length)for(let T=0;T<C.length;T++)C[T](E[v])}function u(v,T,C){if(!E[v])return null;if(v===T||50===C)return[v];const S=E[v].dependencies;for(let A=0,E=S.length;A<E;A++){const E=u(S[A],T,C+1);if(null!==E)return E.push(v),E}return null}function a(v,T){const C=E[v];if(!C)return!1;const S={};for(const v in E)S[v]=!1;const A=[];for(A.push(C),S[v]=!0;A.length>0;){const v=A.shift().dependencies;if(v)for(let C=0,R=v.length;C<R;C++){const R=v[C];if(R===T)return!0;const z=E[R];z&&!S[R]&&(S[R]=!0,A.push(z))}}return!1}function p(v,T,C,A){const R=new Array(v.length).fill(null);let z=0,O=!1;if("string"==typeof v){if(E[v]){if(1===E[v].dclamd)throw new Error(`Trying to load ${v} from ${A}. The first module is still loading.`);return E[v]}throw new Error(v+" has not been defined. Please include it as a dependency in "+A+"'s define()")}const M=v.length;for(let B=0;B<M;B++)switch(v[B]){case"require":const h=function(v,T,C){return p(v,T,C,A)};h.toUrl=function(v){return b(v,A)},R[B]=h,z++;break;case"exports":if(!E[A])throw new Error("Parent module "+A+" not registered yet");R[B]=E[A].exports,z++;break;case"module":R[B]={id:A,uri:b(A)},z++;break;default:{const V=v[B],m=()=>{R[B]=E[V].exports,z++,z===M&&T&&(O=!0,T(R))};if(a(V,A)){const v=u(V,A,0);v&&(v.reverse(),v.push(V),S.push(v)),w(V,(()=>{}),C,A),m()}else w(V,m,C,A);break}}!O&&z===M&&T&&T(R)}function h(v,T){return function(){return dcl.callRpc(v,T.name,C.slice.call(arguments,0))}}function w(v,T,C,S){if(E[v])return E[v].dependants.add(S),void(1===E[v].dclamd?T&&E[v].handlers.push(T):T&&T(E[v]));if(E[v]={name:v,parent:S,dclamd:1,handlers:[T],dependencies:[],dependants:new Set([S]),exports:{}},0===v.indexOf("@")){const T=E[v].exports;if("function"!=typeof dcl.loadModule)throw new Error("Asynchronous modules will not work because loadModule function is not present");dcl.loadModule(v,T).then((C=>{for(const v in C.methods){const S=C.methods[v];T[S.name]=h(C.rpcHandle,S)}d(v)})).catch((v=>{C(v)}))}}function g(v){let T,C=v;for(T=/\/\.\//;T.test(C);)C=C.replace(T,"/");for(C=C.replace(/^\.\//g,""),T=/\/(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//;T.test(C);)C=C.replace(T,"/");return C=C.replace(/^(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//,""),C=C.replace(/^\//g,""),C}function b(v,T){switch(v){case"require":case"exports":case"module":return v}return T?function(v,T){let C=v;if(!C.startsWith("@")&&(C.startsWith("./")||C.startsWith("../"))){const v=T.split("/");v.pop(),C=g(v.join("/")+"/"+C)}return C}(v,T):g(v)}v.config=function(v){if("object"==typeof v)for(const T in v)v.hasOwnProperty(T)&&(A[T]=v[T])},v.define=c,function(v){v.amd={},v.modules=E}(c=v.define||(v.define={})),v.require=p,"undefined"!=typeof dcl&&dcl.onStart((()=>{const v=new Set,T=[];for(const C in E)E[C]&&(1===E[C].dclamd&&T.push(E[C]),E[C].dependencies.forEach((T=>{"require"!==T&&"exports"!==T&&"module"!==T&&(E[T]||v.add(T))})));const C=[];if(S.length&&C.push(`\n> Cyclic dependencies: ${S.map((v=>"\n  - "+v.join(" -> "))).join("")}`),v.size&&C.push(`\n> Undeclared/unknown modules: ${Array.from(v).map((v=>"\n  - "+v)).join("")}`),T.length&&C.push(`\n> These modules didn't load: ${T.map((v=>"\n  - "+v.name)).join("")}.\n`),C.length)throw new Error(C.join("\n"))})),p.toUrl=b}(loader||(loader={})),globalObject.define=loader.define,globalObject.dclamd=loader,function(v){var T=function(){function t(){}return t.AVATAR={getEntityRepresentation:function(v){return v.avatarEntity}},t.FIRST_PERSON_CAMERA={getEntityRepresentation:function(v){return v.firstPersonCameraEntity}},t}(),n=function(v,T){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,T){v.__proto__=T}||function(v,T){for(var C in T)Object.prototype.hasOwnProperty.call(T,C)&&(v[C]=T[C])})(v,T)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function i(v,T){if("function"!=typeof T&&null!==T)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function i(){this.constructor=v}n(v,T),v.prototype=null===T?Object.create(T):(i.prototype=T.prototype,new i)}var o=function(){return(o=Object.assign||function(v){for(var T,C=1,S=arguments.length;C<S;C++)for(var A in T=arguments[C])Object.prototype.hasOwnProperty.call(T,A)&&(v[A]=T[A]);return v}).apply(this,arguments)};function r(v,T,C,S){var A,E=arguments.length,R=E<3?T:null===S?S=Object.getOwnPropertyDescriptor(T,C):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)R=Reflect.decorate(v,T,C,S);else for(var z=v.length-1;z>=0;z--)(A=v[z])&&(R=(E<3?A(R):E>3?A(T,C,R):A(T,C))||R);return E>3&&R&&Object.defineProperty(T,C,R),R}function s(v,T){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(v,T)}function h(v){var T="function"==typeof Symbol&&Symbol.iterator,C=T&&v[T],S=0;if(C)return C.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&S>=v.length&&(v=void 0),{value:v&&v[S++],done:!v}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(v,T){var C="function"==typeof Symbol&&v[Symbol.iterator];if(!C)return v;var S,A,E=C.call(v),R=[];try{for(;(void 0===T||T-- >0)&&!(S=E.next()).done;)R.push(S.value)}catch(v){A={error:v}}finally{try{S&&!S.done&&(C=E.return)&&C.call(E)}finally{if(A)throw A.error}}return R}function p(v,T){for(var C=0,S=T.length,A=v.length;C<S;C++,A++)v[A]=T[C];return v}var C=0;function c(){for(var v=[],T=0;T<arguments.length;T++)v[T]=arguments[T];"undefined"!=typeof dcl?dcl.log.apply(dcl,p([],l(v))):console.log.apply(console,p(["DEBUG:"],l(v)))}function y(v,T){"undefined"!=typeof dcl?dcl.error(v,T):console.error("ERROR:",v,T)}function f(v){if(C++,0===v.length)throw new Error("newId(type: string): type cannot be empty");return v+C.toString(36)}function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(v){var T=16*Math.random()|0;return("x"===v?T:3&T|8).toString(16)}))}var S=[];function _(v){if(!("__event_name__"in v)||"string"!=typeof v.__event_name__)throw new Error("The EventConstructor is not registered");return v.__event_name__}var A=function(){function t(){this.listeners={}}return t.prototype.addListener=function(v,T,C){if(!v||"function"!=typeof v)throw new Error("Invalid EventConstructor");var S=_(v),A=this.listeners[S];A||(A=this.listeners[S]=[]);for(var E=0;E<A.length;E++)if(A[E].listener===T)throw new Error("The provided listener is already registered");return A.push({listener:T,fn:C}),this},t.prototype.removeListener=function(v,T){if(!T||"function"!=typeof T)throw new Error("Invalid EventConstructor");var C=_(T),S=this.listeners[C];if(!S)return!1;for(var A=0;A<S.length;A++)if(S[A].listener===v)return S.splice(A,1),!0;return!1},t.prototype.fireEvent=function(v){var T=_(v.constructor),C=this.listeners[T];if(C)for(var S=0;S<C.length;S++)try{var A=C[S];A.fn.call(A.listener,v)}catch(v){y(v)}return this},t}();function x(){var v=f("EV");if(-1!==S.indexOf(v))throw new Error("The event name "+v+" is already taken");return S.push(v),function(T){return T.__event_name__=v,T}}var E,R=r([x(),s("design:paramtypes",[Object,String,Object])],(function(v,T,C){this.entity=v,this.componentName=T,this.component=C})),z=r([x(),s("design:paramtypes",[Object,String,Object])],(function(v,T,C){this.entity=v,this.componentName=T,this.classId=C})),O=r([x(),s("design:paramtypes",[Object,Object])],(function(v,T){this.entity=v,this.parent=T}));v.UIValueType=void 0,(E=v.UIValueType||(v.UIValueType={}))[E.PERCENT=0]="PERCENT",E[E.PIXELS=1]="PIXELS";var M=function(){function e(T){if(this.type=v.UIValueType.PIXELS,"string"==typeof T){var C=T;C.indexOf("px")>-1?this.type=v.UIValueType.PIXELS:C.indexOf("%")>-1&&(this.type=v.UIValueType.PERCENT),this.value=parseFloat(C)}else this.value=T}return e.prototype.toString=function(){var T=this.value.toString();return this.type===v.UIValueType.PERCENT?T+="%":T+="px",T},e}(),B="__name__symbol_",V="__classId__symbol_",q="__component__id_",j=r([x(),s("design:paramtypes",[String,String,Number])],(function(v,T,C){this.componentId=v,this.componentName=T,this.classId=C})),H=r([x(),s("design:paramtypes",[String])],(function(v){this.componentId=v})),W=r([x(),s("design:paramtypes",[String,Object])],(function(v,T){this.componentId=v,this.component=T}));function P(v,T){return function(C){if(C.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+C.originalClassName+" with: "+v);var S=C,o=function(){var C=Array.prototype.slice.call(arguments),A=new(S.bind.apply(S,p([void 0],l(C))));return Object.defineProperty(A,B,{enumerable:!1,writable:!1,configurable:!1,value:v}),void 0!==T&&Object.defineProperty(A,V,{enumerable:!1,writable:!1,configurable:!1,value:T}),A};return void 0!==T&&(o.__classId__symbol_=T),o.__name__symbol_=v,o.isComponent=!0,o.originalClassName=v,(o.prototype=C.prototype).constructor=C,o}}function N(v,T){return function(C){if(C.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+C.originalClassName+" with: "+v);if("number"!=typeof T||isNaN(T))throw new Error("classId: "+T+" is an invalid integer");var S=C,o=function(){if(!N.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");var C=Array.prototype.slice.call(arguments),A=new(S.bind.apply(S,p([void 0],l(C)))),E=f("C");return Object.defineProperty(A,B,{enumerable:!1,writable:!1,configurable:!1,value:v}),Object.defineProperty(A,q,{enumerable:!1,writable:!1,configurable:!1,value:E}),void 0!==T&&Object.defineProperty(A,V,{enumerable:!1,writable:!1,configurable:!1,value:T}),N.engine&&N.engine.registerComponent(A),A};return void 0!==T&&(o.__classId__symbol_=T),o.__name__symbol_=v,o.isComponent=!0,o.isDisposableComponent=!0,o.originalClassName=v,(o.prototype=C.prototype).constructor=C,o}}function F(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__name__symbol_)return v.__name__symbol_;throw new TypeError(v+" is not a registered component.")}function L(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__classId__symbol_)return v.__classId__symbol_;if(!v.__name__symbol_)throw new TypeError(v+" is not a registered component.");return null}function D(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__component__id_)return v.__component__id_;throw new TypeError(v+" is not a registered disposable component.")}!function(v){v.engine=null}(N||(N={}));var X=function(){function t(){this.dirty=!1,this.data={},this.subscriptions=[]}return t.component=function(v,T){if(delete v[T]){var C=T+"_"+Math.random();v[C]=void 0,Object.defineProperty(v,C,o(o({},Object.getOwnPropertyDescriptor(v,C)),{enumerable:!1})),Object.defineProperty(v,T.toString(),{get:function(){return this[C]},set:function(v){var S=this[C];if(this.data[T]=v?D(v):null,this[C]=v,v!==S){this.dirty=!0;for(var A=0;A<this.subscriptions.length;A++)this.subscriptions[A](T,v,S)}},enumerable:!0})}},t.field=function(v,T){delete v[T]&&Object.defineProperty(v,T.toString(),{get:function(){return this.data[T]},set:function(v){var C=this.data[T];if(this.data[T]=v,v!==C){this.dirty=!0;for(var S=0;S<this.subscriptions.length;S++)this.subscriptions[S](T,v,C)}},enumerable:!0})},t.uiValue=function(v,T){delete v[T]&&Object.defineProperty(v,T.toString(),{get:function(){return this.data[T].toString()},set:function(v){var C=this.data[T],S=new M(v);if(this.data[T]=S,S!==C){this.dirty=!0;for(var A=0;A<this.subscriptions.length;A++)this.subscriptions[A](T,S,C)}},enumerable:!0})},t.readonly=function(v,T){delete v[T]&&Object.defineProperty(v,T.toString(),{get:function(){if(T in this.data==0)throw new Error("The field "+T+" is uninitialized");return this.data[T]},set:function(v){if(T in this.data)throw new Error("The field "+T+" is readonly");this.data[T]=v,this.dirty=!0},enumerable:!0,configurable:!1})},t.prototype.onChange=function(v){return this.subscriptions.push(v),this},t.prototype.toJSON=function(){return this.data},t}();function U(v){return q in v}var Q=function(){function t(){for(var v=[],T=0;T<arguments.length;T++)v[T]=arguments[T];if(this.entities=[],this.active=!1,this._requiresNames=[],!v)throw new Error("ComponentGroup: Could not load the requires list");if(!(v instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return v.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(var n=function(T){var S=v[T],A=null;if(!S)throw new Error("ComponentGroup: the required component at location "+T+" is invalid");try{A=F(S)}catch(v){throw new Error("ComponentGroup: the required component at location "+T+" is not registered as a @Component. Remember to provide the class of the component, not the name")}if(C._requiresNames.some((function(v){return v===A})))throw new Error("ComponentGroup: the required component list has a repeated name "+A);C._requiresNames.push(A)},C=this,S=0;S<v.length;S++)n(S)}return t.prototype.hasEntity=function(v){return!!v.isAddedToEngine()&&-1!==this.entities.indexOf(v)},t.prototype.addEntity=function(v){if(!v.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(v)&&this.entities.push(v)},t.prototype.removeEntity=function(v){var T=this.entities.indexOf(v);-1!==T&&this.entities.splice(T,1)},t.prototype.componentRemoved=function(v,T){-1!==this._requiresNames.indexOf(T)&&this.removeEntity(v)},t.prototype.meetsRequirements=function(v){for(var T=0;T<this._requiresNames.length;T++)if(!(this._requiresNames[T]in v.components))return!1;return!0},t}(),Z=function(){function t(v){this.name=v,this.children={},this.eventManager=null,this.alive=!1,this.uuid=f("E"),this.components={},this.engine=null,this._parent=null}return t.prototype.addComponentOrReplace=function(v){if("function"==typeof v)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof v)throw new Error("You passed a "+typeof v+", an instance of component is expected");var T=F(v);if(this.components[T]){if(this.components[T]===v)return v;this.removeComponent(this.components[T],!1)}return this.addComponent(v)},t.prototype.hasComponent=function(v){var T=typeof v;if("string"!==T&&"object"!==T&&"function"!==T)throw new Error("Entity#has(component): component is not a class, name or instance");if(null===v)return!1;var C="string"===T?v:F(v),S=this.components[C];return!!S&&("object"===T?S===v:"function"!==T||S instanceof v)},t.prototype.getComponent=function(v){var T=typeof v;if("string"!==T&&"function"!==T)throw new Error("Entity#get(component): component is not a class or name");var C="string"===T?v:F(v),S=this.components[C];if(!S)throw new Error('Can not get component "'+C+'" from entity "'+this.identifier+'"');if("function"===T){if(S instanceof v)return S;throw new Error('Can not get component "'+C+'" from entity "'+this.identifier+'" (by instance)')}return S},t.prototype.getComponentOrNull=function(v){var T=typeof v;if("string"!==T&&"function"!==T)throw new Error("Entity#getOrNull(component): component is not a class or name");var C="string"===T?v:F(v),S=this.components[C];return S?"function"===T?S instanceof v?S:null:S:null},t.prototype.getComponentOrCreate=function(v){if("function"!=typeof v)throw new Error("Entity#getOrCreate(component): component is not a class");var T=this.getComponentOrNull(v);return T||(F(T=new v),this.addComponentOrReplace(T)),T},t.prototype.addComponent=function(v){if("object"!=typeof v)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");var T=F(v),C=L(v);if(this.components[T])throw new Error('A component of type "'+T+'" is already present in entity "'+this.identifier+'"');this.components[T]=v,this.eventManager&&this.eventManager.fireEvent(new z(this,T,C));var S=v;return"function"==typeof S.addedToEntity&&S.addedToEntity(this),v},t.prototype.removeComponent=function(v,T){void 0===T&&(T=!0);var C=typeof v;if("string"!==C&&"function"!==C&&"object"!==C)throw new Error("Entity#remove(component): component is not a class, class or name");var S="string"===C?v:F(v),A=this.components[S];if(A){if("function"===C)return A instanceof v?(delete this.components[S],void(A&&(T&&this.eventManager&&this.eventManager.fireEvent(new R(this,S,A)),"function"==typeof A.removedFromEntity&&A.removedFromEntity(this)))):void c('Entity Warning: Trying to remove wrong (by constructor) component "'+S+'" from entity "'+this.identifier+'"');delete this.components[S],A&&(T&&this.eventManager&&this.eventManager.fireEvent(new R(this,S,A)),"function"==typeof A.removedFromEntity&&A.removedFromEntity(this))}else c('Entity Warning: Trying to remove inexisting component "'+S+'" from entity "'+this.identifier+'"')},t.prototype.isAddedToEngine=function(){return!(!this.engine||!(this.uuid in this.engine.entities)&&this.engine.rootEntity!==this)},t.prototype.setParent=function(v){var T;if(v&&"getEntityRepresentation"in v){if(!this.engine)throw new Error("In order to set an attachable as parent, you first need to add the entity to the engine.");T=v.getEntityRepresentation(this.engine)}else T=!v&&this.engine?this.engine.rootEntity:v;var C=this.getParent();if(T===this)throw new Error('Failed to set parent for entity "'+this.identifier+"\": An entity can't set itself as a its own parent");if(T===C)return this;var S=this.getCircularAncestor(T);if(S)throw new Error('Failed to set parent for entity "'+this.identifier+'": Circular parent references are not allowed (See entity "'+S+'")');return C&&delete C.children[this.uuid],null!==T&&"0"!==T.uuid&&(!T.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),T.isAddedToEngine()&&!this.isAddedToEngine()&&T.engine.addEntity(this)),this._parent=T||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new O(this,T)),this},t.prototype.getParent=function(){return this._parent},Object.defineProperty(t.prototype,"identifier",{get:function(){return this.name||this.uuid},enumerable:!1,configurable:!0}),t.prototype.getCircularAncestor=function(v){for(var T=this.engine?this.engine.rootEntity:null,C=v;C&&C!==T;){var S=C.getParent();if(S===this)return C.uuid;C=S}return null},t.prototype.registerAsChild=function(){var v=this.getParent();this.uuid&&v&&(v.children[this.uuid]=this)},t}(),J=function(){function t(v){this.eventManager=new A,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(z,this,this.componentAddedHandler),this.eventManager.addListener(R,this,this.componentRemovedHandler),this.rootEntity=v,this.firstPersonCameraEntity=new Z,this.firstPersonCameraEntity.uuid="FirstPersonCameraEntityReference",this.addEntity(this.firstPersonCameraEntity),this.avatarEntity=new Z,this.avatarEntity.uuid="AvatarEntityReference",this.addEntity(this.avatarEntity)}return Object.defineProperty(t.prototype,"entities",{get:function(){return this._entities},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disposableComponents",{get:function(){return this._disposableComponents},enumerable:!1,configurable:!0}),t.prototype.addEntity=function(v){var T=v.getParent();if(v.isAddedToEngine())return v;for(var C in v.eventManager=this.eventManager,v.engine=this,this._entities[v.uuid]=v,this.checkRequirementsAndAdd(v),T?T.isAddedToEngine()||T===this.rootEntity||c("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+T.uuid):v.setParent(this.rootEntity),v.alive=!0,v.children){var S=v.children[C];S&&(S.isAddedToEngine()||this.addEntity(S))}return v},t.prototype.removeEntity=function(v){var T=v.uuid;if(v.isAddedToEngine()){for(var C in v.components){var S=this._componentGroups[C];if(S)for(var A in S)S[A].removeEntity(v);delete this.entityLists[C][T]}for(var E=0;E<this.simpleSystems.length;E++){var R=this.simpleSystems[E];R.onRemoveEntity&&R.onRemoveEntity(v)}for(var E in v.children){var z=v.children[E];z&&this.removeEntity(z)}return v.alive=!1,v.eventManager=null,delete this._entities[T],!0}for(var C in c("Engine: Trying to remove non existent entity from engine."),v.isAddedToEngine()?c("Engine: Entity id: "+T):c('Engine: Entity "'+v.uuid+'" has not been added to any engine yet.'),c("Engine: Entity's components:"),v.components)c(C);return!1},t.prototype.addSystem=function(v,T){if(void 0===T&&(T=0),-1!==this.addedSystems.indexOf(v))return c("Engine: Trying to add a system that is already added. Aborting"),v;if(this.systems.length>0)for(var C=0;C<this.systems.length;C++){var S=this.systems[C],A=C===this.systems.length-1;if(S.priority>T){this.addedSystems.push(v),this.systems.splice(C,0,{system:v,priority:T});break}if(A){this.addedSystems.push(v),this.systems.splice(C+1,0,{system:v,priority:T});break}}else this.addedSystems.push(v),this.systems.splice(1,0,{system:v,priority:T});return this.registerSystem(v),v},t.prototype.removeSystem=function(v){var T=this.addedSystems.indexOf(v);if(-1!==T){v.active=!1,v.deactivate&&v.deactivate(),this.addedSystems.splice(T,1);for(var C=0;C<this.systems.length;C++)this.systems[C].system===v&&this.systems.splice(C,1);return!0}return!1},t.prototype.update=function(v){for(var T in this.systems){var C=this.systems[T].system;if(C.active&&C.update)try{C.update(v)}catch(v){y(v)}}return this},t.prototype.getEntitiesWithComponent=function(v){var T="string"==typeof v?v:F(v);return T in this.entityLists?this.entityLists[T]:this.entityLists[T]={}},t.prototype.registerComponent=function(v){var T=D(v),C=F(v),S=L(v);this._disposableComponents[T]=v,null!==S&&(this.eventManager.fireEvent(new j(T,C,S)),this.eventManager.fireEvent(new W(T,v)))},t.prototype.disposeComponent=function(v){var T=D(v);return delete this._disposableComponents[T]&&(this.eventManager.fireEvent(new H(T)),v.onDispose&&v.onDispose(),!0)},t.prototype.updateComponent=function(v){this.eventManager.fireEvent(new W(D(v),v))},t.prototype.getComponentGroup=function(){for(var v=[],T=0;T<arguments.length;T++)v[T]=arguments[T];var C=void 0;if(v.length>0&&(O=this._componentGroups[F(v[0])]))for(var S=v.slice(),A=0;A<O.length;A++){var E=O[A];if(S.length===E.requires.length){for(var R=0;R<S.length&&-1!==E.requires.indexOf(S[R]);R++)R===S.length-1&&(C=E);if(C)break}}if(C)return C;(C=new(Q.bind.apply(Q,p([void 0],l(v))))).active=!0;var z=C.requiresNames;for(A=0;A<z.length;A++){var O,M=z[A];(O=this._componentGroups[M])||(this._componentGroups[M]=O=[]),-1===O.indexOf(C)&&O.push(C)}for(var B in this._entities)this.checkRequirements(this._entities[B],C);return C},t.prototype.removeComponentGroup=function(v){if(v.active){v.active=!1;for(var T=v.requiresNames,C=0;C<T.length;C++){var S=T[C],A=this._componentGroups[S];if(A){var E=A.indexOf(v);-1!==E&&A.splice(E,1)}}return!0}return!1},t.prototype.registerSystem=function(v){v.active=!0,v.activate&&v.activate(this),this.simpleSystems.push(v)},t.prototype.checkRequirementsAndAdd=function(v){if(v.isAddedToEngine()){for(var T in v.components){T in this.entityLists||(this.entityLists[T]={}),this.entityLists[T][v.uuid]=v;var C=this._componentGroups[T];if(C)for(var S in C)this.checkRequirements(v,C[S])}for(var A=0;A<this.simpleSystems.length;A++){var E=this.simpleSystems[A];E.onAddEntity&&E.onAddEntity(v)}}},t.prototype.checkRequirements=function(v,T){T.meetsRequirements(v)?T.hasEntity(v)||T.addEntity(v):T.hasEntity(v)&&T.removeEntity(v)},t.prototype.componentAddedHandler=function(v){var T,C=v.entity,S=v.componentName;if(C.isAddedToEngine()){this.entityLists[S]?this.entityLists[S][C.uuid]=C:this.entityLists[S]=((T={})[C.uuid]=C,T);var A=this._componentGroups[S];if(A)for(var E in A)this.checkRequirements(C,A[E])}},t.prototype.componentRemovedHandler=function(v){var T=v.entity,C=v.componentName;if(T.isAddedToEngine()){delete this.entityLists[C][T.uuid];var S=this._componentGroups[C];if(S)for(var A in S)this.checkRequirements(T,S[A])}},t}(),K=Promise.resolve().then.bind(Promise.resolve());function G(v){var T=K(v);return T.isComplete=!1,T.then((function(v){T.isComplete=!0,T.result=v,T.didFail=!1})).catch((function(v){T.isComplete=!0,T.error=v,T.didFail=!0,y("executeTask: FAILED "+v.toString(),v)})),T}var $,et,nt=function(){function t(v,T,C,S){void 0===T&&(T=!1),this.initalize(v,T,C,S)}return t.prototype.initalize=function(v,T,C,S){return void 0===T&&(T=!1),this.mask=v,this.skipNextObservers=T,this.target=C,this.currentTarget=S,this},t}(),Y=function(v,T,C){void 0===C&&(C=null),this.callback=v,this.mask=T,this.scope=C,this.unregisterOnNextCall=!1,this._willBeUnregistered=!1},it=function(){function t(){this._observers=null,this._observables=null}return t.Watch=function(v,T,C,S){var A,E;void 0===C&&(C=-1),void 0===S&&(S=null);var R=new t;R._observers=new Array,R._observables=v;try{for(var z=h(v),O=z.next();!O.done;O=z.next()){var M=O.value.add(T,C,!1,S);M&&R._observers.push(M)}}catch(v){A={error:v}}finally{try{O&&!O.done&&(E=z.return)&&E.call(z)}finally{if(A)throw A.error}}return R},t.prototype.dispose=function(){if(this._observers&&this._observables)for(var v=0;v<this._observers.length;v++)this._observables[v].remove(this._observers[v]);this._observers=null,this._observables=null},t}(),ot=function(){function t(v){this._observers=new Array,this._onObserverAdded=null,this._eventState=new nt(0),v&&(this._onObserverAdded=v)}return t.prototype.add=function(v,T,C,S,A){if(void 0===T&&(T=-1),void 0===C&&(C=!1),void 0===S&&(S=null),void 0===A&&(A=!1),!v)return null;var E=new Y(v,T,S);return E.unregisterOnNextCall=A,C?this._observers.unshift(E):this._observers.push(E),this._onObserverAdded&&this._onObserverAdded(E),E},t.prototype.addOnce=function(v){return this.add(v,void 0,void 0,void 0,!0)},t.prototype.remove=function(v){return!!v&&-1!==this._observers.indexOf(v)&&(this._deferUnregister(v),!0)},t.prototype.removeCallback=function(v,T){for(var C=0;C<this._observers.length;C++)if(this._observers[C].callback===v&&(!T||T===this._observers[C].scope))return this._deferUnregister(this._observers[C]),!0;return!1},t.prototype.notifyObservers=function(v,T,C,S){var A,E;if(void 0===T&&(T=-1),!this._observers.length)return!0;var R=this._eventState;R.mask=T,R.target=C,R.currentTarget=S,R.skipNextObservers=!1,R.lastReturnValue=v;try{for(var z=h(this._observers),O=z.next();!O.done;O=z.next()){var M=O.value;if(!M._willBeUnregistered&&(M.mask&T&&(M.scope?R.lastReturnValue=M.callback.apply(M.scope,[v,R]):R.lastReturnValue=M.callback(v,R),M.unregisterOnNextCall&&this._deferUnregister(M)),R.skipNextObservers))return!1}}catch(v){A={error:v}}finally{try{O&&!O.done&&(E=z.return)&&E.call(z)}finally{if(A)throw A.error}}return!0},t.prototype.notifyObserversWithPromise=function(v,T,C,S){var A=this;void 0===T&&(T=-1);var E=Promise.resolve(v);if(!this._observers.length)return E;var R=this._eventState;return R.mask=T,R.target=C,R.currentTarget=S,R.skipNextObservers=!1,this._observers.forEach((function(C){R.skipNextObservers||C._willBeUnregistered||C.mask&T&&(E=C.scope?E.then((function(T){return R.lastReturnValue=T,C.callback.apply(C.scope,[v,R])})):E.then((function(T){return R.lastReturnValue=T,C.callback(v,R)})),C.unregisterOnNextCall&&A._deferUnregister(C))})),E.then((function(){return v}))},t.prototype.notifyObserver=function(v,T,C){void 0===C&&(C=-1);var S=this._eventState;S.mask=C,S.skipNextObservers=!1,v.callback(T,S)},t.prototype.hasObservers=function(){return this._observers.length>0},t.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},t.prototype.clone=function(){var v=new t;return v._observers=this._observers.slice(0),v},t.prototype.hasSpecificMask=function(v){var T,C;void 0===v&&(v=-1);try{for(var S=h(this._observers),A=S.next();!A.done;A=S.next()){var E=A.value;if(E.mask&v||E.mask===v)return!0}}catch(v){T={error:v}}finally{try{A&&!A.done&&(C=S.return)&&C.call(S)}finally{if(T)throw T.error}}return!1},t.prototype._deferUnregister=function(v){var T=this;v.unregisterOnNextCall=!1,v._willBeUnregistered=!0,G((function(){return function(v,T,C,S){return new(C||(C=Promise))((function(T,A){function s(v){try{d(S.next(v))}catch(v){A(v)}}function a(v){try{d(S.throw(v))}catch(v){A(v)}}function d(v){var S;v.done?T(v.value):(S=v.value,S instanceof C?S:new C((function(v){v(S)}))).then(s,a)}d((S=S.apply(v,[])).next())}))}(T,0,void 0,(function(){return function(v,T){var C,S,A,E,R={label:0,sent:function(){if(1&A[0])throw A[1];return A[1]},trys:[],ops:[]};return E={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(E[Symbol.iterator]=function(){return this}),E;function a(E){return function(z){return function(E){if(C)throw new TypeError("Generator is already executing.");for(;R;)try{if(C=1,S&&(A=2&E[0]?S.return:E[0]?S.throw||((A=S.return)&&A.call(S),0):S.next)&&!(A=A.call(S,E[1])).done)return A;switch(S=0,A&&(E=[2&E[0],A.value]),E[0]){case 0:case 1:A=E;break;case 4:return R.label++,{value:E[1],done:!1};case 5:R.label++,S=E[1],E=[0];continue;case 7:E=R.ops.pop(),R.trys.pop();continue;default:if(!((A=(A=R.trys).length>0&&A[A.length-1])||6!==E[0]&&2!==E[0])){R=0;continue}if(3===E[0]&&(!A||E[1]>A[0]&&E[1]<A[3])){R.label=E[1];break}if(6===E[0]&&R.label<A[1]){R.label=A[1],A=E;break}if(A&&R.label<A[2]){R.label=A[2],R.ops.push(E);break}A[2]&&R.ops.pop(),R.trys.pop();continue}E=T.call(v,R)}catch(v){E=[6,v],S=0}finally{C=A=0}if(5&E[0])throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}([E,z])}}}(this,(function(T){return[2,this._remove(v)]}))}))}))},t.prototype._remove=function(v){if(!v)return!1;var T=this._observers.indexOf(v);return-1!==T&&(this._observers.splice(T,1),!0)},t}(),rt=r([x(),s("design:paramtypes",[String,Object])],(function(v,T){this.uuid=v,this.payload=T})),st=r([x(),s("design:paramtypes",[Object])],(function(v){this.payload=v})),at=r([x(),s("design:paramtypes",[Object])],(function(v){this.payload=v}));function tt(v){return function(){et&&et.subscribe(v)}}var ht=new ot(tt("cameraModeChanged")),lt=new ot(tt("idleStateChanged")),ct=new ot(tt("onEnterScene")),ut=ct,dt=new ot(tt("onLeaveScene")),pt=dt,ft=new ot(tt("sceneStart")),yt=new ot(tt("playerExpression")),gt=new ot(tt("onPointerLock")),vt=new ot(tt("videoEvent")),wt=new ot(tt("profileChanged")),bt=new ot(tt("playerConnected")),Tt=new ot(tt("playerDisconnected")),Ct=new ot(tt("onRealmChanged")),St=new ot(tt("playerClicked"));function mt(v){(et=v)&&et.onEvent((function(v){switch(v.type){case"onEnterScene":return void ct.notifyObservers(v.data);case"onLeaveScene":return void dt.notifyObservers(v.data);case"cameraModeChanged":return void ht.notifyObservers(v.data);case"idleStateChanged":return void lt.notifyObservers(v.data);case"sceneStart":return void ft.notifyObservers(v.data);case"playerExpression":return void yt.notifyObservers(v.data);case"videoEvent":var T=v.data,C=N.engine.disposableComponents[T.componentId];return C&&C.update(T),void vt.notifyObservers(T);case"profileChanged":return void wt.notifyObservers(v.data);case"onPointerLock":return void gt.notifyObservers(v.data);case"playerConnected":return void bt.notifyObservers(v.data);case"playerDisconnected":return void Tt.notifyObservers(v.data);case"onRealmChanged":return void Ct.notifyObservers(v.data);case"playerClicked":return void St.notifyObservers(v.data)}}))}var xt=function(){function t(v){this.dcl=v,this.cachedComponents={}}return t.prototype.activate=function(v){var T=this;this.engine=v,v.eventManager.addListener(z,this,this.componentAdded),v.eventManager.addListener(R,this,this.componentRemoved),v.eventManager.addListener(j,this,this.disposableComponentCreated),v.eventManager.addListener(H,this,this.disposableComponentRemoved),v.eventManager.addListener(W,this,this.disposableComponentUpdated),v.eventManager.addListener(O,this,this.parentChanged);var C=v.rootEntity.uuid;this.dcl.addEntity(C),this.dcl.onUpdate((function(C){v.update(C),T.presentEntities()})),this.dcl.onEvent((function(T){var C=T.data;switch(T.type){case"uuidEvent":v.eventManager.fireEvent(new rt(C.uuid,C.payload));break;case"raycastResponse":("HitFirst"===C.queryType||"HitAll"===C.queryType)&&v.eventManager.fireEvent(new st(C));break;case"actionButtonEvent":v.eventManager.fireEvent(new at(C.payload))}}))},t.prototype.onAddEntity=function(v){if(v&&v.isAddedToEngine()){var T=v.uuid,C=v.getParent();for(var S in this.dcl.addEntity(T),C&&this.dcl.setParent(T,C.uuid),this.cachedComponents[T]={},v.components){var A=v.components[S],E=L(A);if(null!==E)if(U(A))this.dcl.attachEntityComponent(v.uuid,S,D(A));else{var R=JSON.stringify(A);this.dcl.updateEntityComponent(T,S,E,R),this.cachedComponents[T][S]=R}}}},t.prototype.onRemoveEntity=function(v){if(v.isAddedToEngine()){var T=v.uuid;this.dcl.removeEntity(T),delete this.cachedComponents[T]}},t.prototype.presentEntities=function(){for(var v in this.engine.entities){var T=this.engine.entities[v];for(var C in T.components){var S=L(R=T.components[C]);if(null!==S&&!U(R)){var A=this.getJsonIfDirty(T.uuid,C,R);A&&(this.dcl.updateEntityComponent(T.uuid,C,S,A),this.clearDirty(T.uuid,C,R,A))}}}for(var E in this.engine.disposableComponents){var R;(R=this.engine.disposableComponents[E])instanceof X&&R.dirty&&(this.dcl.componentUpdated(E,JSON.stringify(R)),R.dirty=!1)}},t.prototype.componentAdded=function(v){if(v.entity.isAddedToEngine()){var T=v.entity.components[v.componentName];if(U(T))this.dcl.attachEntityComponent(v.entity.uuid,v.componentName,D(T));else if(null!==v.classId){var C=JSON.stringify(T);this.dcl.updateEntityComponent(v.entity.uuid,v.componentName,v.classId,C),this.cachedComponents[v.entity.uuid][v.componentName]=C}}},t.prototype.componentRemoved=function(v){v.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(v.entity.uuid,v.componentName),delete this.cachedComponents[v.entity.uuid][v.componentName])},t.prototype.disposableComponentCreated=function(v){this.dcl.componentCreated(v.componentId,v.componentName,v.classId)},t.prototype.disposableComponentRemoved=function(v){this.dcl.componentDisposed(v.componentId)},t.prototype.disposableComponentUpdated=function(v){this.dcl.componentUpdated(v.componentId,JSON.stringify(v.component))},t.prototype.parentChanged=function(v){this.dcl.setParent(v.entity.uuid,v.parent?v.parent.uuid:"0")},t.prototype.getJsonIfDirty=function(v,T,C){var S=JSON.stringify(C);return S!==this.cachedComponents[v][T]&&S},t.prototype.clearDirty=function(v,T,C,S){this.cachedComponents[v][T]=S},t}(),_t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},At={},Rt={};!function(v){var T,C;Object.defineProperty(v,"__esModule",{value:!0}),v.RAD2DEG=v.DEG2RAD=v.Epsilon=v.ToLinearSpace=v.ToGammaSpace=v.Space=v.Orientation=void 0,(T=v.Orientation||(v.Orientation={}))[T.CW=0]="CW",T[T.CCW=1]="CCW",(C=v.Space||(v.Space={}))[C.LOCAL=0]="LOCAL",C[C.WORLD=1]="WORLD",C[C.BONE=2]="BONE",v.ToGammaSpace=1/2.2,v.ToLinearSpace=2.2,v.Epsilon=1e-6,v.DEG2RAD=Math.PI/180,v.RAD2DEG=360/(2*Math.PI)}(Rt);var It={},Pt={};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.buildArray=void 0,Pt.buildArray=function(v,T){const C=[];for(let S=0;S<v;++S)C.push(T());return C};var zt={},Ot={},Nt={},Bt={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.Scalar=void 0;class Et{static WithinEpsilon(v,T,C=1401298e-51){const S=v-T;return-C<=S&&S<=C}static ToHex(v){const T=v.toString(16);return v<=15?("0"+T).toUpperCase():T.toUpperCase()}static Sign(v){const T=+v;return 0===T||isNaN(T)?T:T>0?1:-1}static Clamp(v,T=0,C=1){return Math.min(C,Math.max(T,v))}static Log2(v){return Math.log(v)*Math.LOG2E}static Repeat(v,T){return v-Math.floor(v/T)*T}static Normalize(v,T,C){return(v-T)/(C-T)}static Denormalize(v,T,C){return v*(C-T)+T}static DeltaAngle(v,T){let C=Et.Repeat(T-v,360);return C>180&&(C-=360),C}static PingPong(v,T){const C=Et.Repeat(v,2*T);return T-Math.abs(C-T)}static SmoothStep(v,T,C){let S=Et.Clamp(C);return S=-2*S*S*S+3*S*S,T*S+v*(1-S)}static MoveTowards(v,T,C){let S=0;return S=Math.abs(T-v)<=C?T:v+Et.Sign(T-v)*C,S}static MoveTowardsAngle(v,T,C){const S=Et.DeltaAngle(v,T);let A=0;return A=-C<S&&S<C?T:Et.MoveTowards(v,v+S,C),A}static Lerp(v,T,C){return v+(T-v)*C}static LerpAngle(v,T,C){let S=Et.Repeat(T-v,360);return S>180&&(S-=360),v+S*Et.Clamp(C)}static InverseLerp(v,T,C){let S=0;return S=v!==T?Et.Clamp((C-v)/(T-v)):0,S}static Hermite(v,T,C,S,A){const E=A*A,R=A*E;return v*(2*R-3*E+1)+C*(-2*R+3*E)+T*(R-2*E+A)+S*(R-E)}static RandomRange(v,T){return v===T?v:Math.random()*(T-v)+v}static RangeToPercent(v,T,C){return(v-T)/(C-T)}static PercentToRange(v,T,C){return(C-T)*v+T}static NormalizeRadians(v){return v-Et.TwoPi*Math.floor((v+Math.PI)/Et.TwoPi)}}Lt.Scalar=Et,Et.TwoPi=2*Math.PI,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.Vector4=void 0;const Ft=Rt,kt=Lt,Ut=zt;class Mt{constructor(v,T,C,S){this.x=v,this.y=T,this.z=C,this.w=S}static Add(v,T){return new Mt(v.x,v.y,v.z,v.w).addInPlace(T)}static FromArray(v,T=0){return new Mt(v[T],v[T+1],v[T+2],v[T+3])}static FromArrayToRef(v,T,C){C.x=v[T],C.y=v[T+1],C.z=v[T+2],C.w=v[T+3]}static FromFloatArrayToRef(v,T,C){Mt.FromArrayToRef(v,T,C)}static FromFloatsToRef(v,T,C,S,A){A.x=v,A.y=T,A.z=C,A.w=S}static Zero(){return new Mt(0,0,0,0)}static One(){return new Mt(1,1,1,1)}static Normalize(v){const T=Mt.Zero();return Mt.NormalizeToRef(v,T),T}static NormalizeToRef(v,T){T.copyFrom(v),T.normalize()}static Minimize(v,T){const C=new Mt(v.x,v.y,v.z,v.w);return C.minimizeInPlace(T),C}static Maximize(v,T){const C=new Mt(v.x,v.y,v.z,v.w);return C.maximizeInPlace(T),C}static Distance(v,T){return Math.sqrt(Mt.DistanceSquared(v,T))}static DistanceSquared(v,T){const C=v.x-T.x,S=v.y-T.y,A=v.z-T.z,E=v.w-T.w;return C*C+S*S+A*A+E*E}static Center(v,T){const C=Mt.Add(v,T);return C.scaleInPlace(.5),C}static TransformNormal(v,T){const C=Mt.Zero();return Mt.TransformNormalToRef(v,T,C),C}static TransformNormalToRef(v,T,C){const S=T.m,A=v.x*S[0]+v.y*S[4]+v.z*S[8],E=v.x*S[1]+v.y*S[5]+v.z*S[9],R=v.x*S[2]+v.y*S[6]+v.z*S[10];C.x=A,C.y=E,C.z=R,C.w=v.w}static TransformNormalFromFloatsToRef(v,T,C,S,A,E){const R=A.m;E.x=v*R[0]+T*R[4]+C*R[8],E.y=v*R[1]+T*R[5]+C*R[9],E.z=v*R[2]+T*R[6]+C*R[10],E.w=S}toString(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"}getClassName(){return"Vector4"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v=397*v^(this.w||0),v}asArray(){const v=new Array;return this.toArray(v,0),v}toArray(v,T=0){return v[T]=this.x,v[T+1]=this.y,v[T+2]=this.z,v[T+3]=this.w,this}addInPlace(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this.w+=v.w,this}add(v){return new Mt(this.x+v.x,this.y+v.y,this.z+v.z,this.w+v.w)}addToRef(v,T){return T.x=this.x+v.x,T.y=this.y+v.y,T.z=this.z+v.z,T.w=this.w+v.w,this}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this.w-=v.w,this}subtract(v){return new Mt(this.x-v.x,this.y-v.y,this.z-v.z,this.w-v.w)}subtractToRef(v,T){return T.x=this.x-v.x,T.y=this.y-v.y,T.z=this.z-v.z,T.w=this.w-v.w,this}subtractFromFloats(v,T,C,S){return new Mt(this.x-v,this.y-T,this.z-C,this.w-S)}subtractFromFloatsToRef(v,T,C,S,A){return A.x=this.x-v,A.y=this.y-T,A.z=this.z-C,A.w=this.w-S,this}negate(){return new Mt(-this.x,-this.y,-this.z,-this.w)}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}scale(v){return new Mt(this.x*v,this.y*v,this.z*v,this.w*v)}scaleToRef(v,T){return T.x=this.x*v,T.y=this.y*v,T.z=this.z*v,T.w=this.w*v,this}scaleAndAddToRef(v,T){return T.x+=this.x*v,T.y+=this.y*v,T.z+=this.z*v,T.w+=this.w*v,this}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z&&this.w===v.w}equalsWithEpsilon(v,T=Ft.Epsilon){return v&&kt.Scalar.WithinEpsilon(this.x,v.x,T)&&kt.Scalar.WithinEpsilon(this.y,v.y,T)&&kt.Scalar.WithinEpsilon(this.z,v.z,T)&&kt.Scalar.WithinEpsilon(this.w,v.w,T)}equalsToFloats(v,T,C,S){return this.x===v&&this.y===T&&this.z===C&&this.w===S}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z,this.w*=v.w,this}multiply(v){return new Mt(this.x*v.x,this.y*v.y,this.z*v.z,this.w*v.w)}multiplyToRef(v,T){return T.x=this.x*v.x,T.y=this.y*v.y,T.z=this.z*v.z,T.w=this.w*v.w,this}multiplyByFloats(v,T,C,S){return new Mt(this.x*v,this.y*T,this.z*C,this.w*S)}divide(v){return new Mt(this.x/v.x,this.y/v.y,this.z/v.z,this.w/v.w)}divideToRef(v,T){return T.x=this.x/v.x,T.y=this.y/v.y,T.z=this.z/v.z,T.w=this.w/v.w,this}divideInPlace(v){return this.divideToRef(v,this)}minimizeInPlace(v){return v.x<this.x&&(this.x=v.x),v.y<this.y&&(this.y=v.y),v.z<this.z&&(this.z=v.z),v.w<this.w&&(this.w=v.w),this}maximizeInPlace(v){return v.x>this.x&&(this.x=v.x),v.y>this.y&&(this.y=v.y),v.z>this.z&&(this.z=v.z),v.w>this.w&&(this.w=v.w),this}floor(){return new Mt(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new Mt(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){const v=this.length();return 0===v?this:this.scaleInPlace(1/v)}toVector3(){return new Ut.Vector3(this.x,this.y,this.z)}clone(){return new Mt(this.x,this.y,this.z,this.w)}copyFrom(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=v.w,this}copyFromFloats(v,T,C,S){return this.x=v,this.y=T,this.z=C,this.w=S,this}set(v,T,C,S){return this.copyFromFloats(v,T,C,S)}setAll(v){return this.x=this.y=this.z=this.w=v,this}}Bt.Vector4=Mt,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.Matrix=void 0;const Vt=zt,qt=Ot,Ht=It,Wt=Bt;class Dt{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}get m(){return this._m}static get IdentityReadOnly(){return Dt._identityReadOnly}static FromArray(v,T=0){const C=new Dt;return Dt.FromArrayToRef(v,T,C),C}static FromArrayToRef(v,T,C){for(let S=0;S<16;S++)C._m[S]=v[S+T];C._markAsUpdated()}static FromFloatArrayToRefScaled(v,T,C,S){for(let A=0;A<16;A++)S._m[A]=v[A+T]*C;S._markAsUpdated()}static FromValuesToRef(v,T,C,S,A,E,R,z,O,M,B,V,q,j,H,W,X){const Q=X._m;Q[0]=v,Q[1]=T,Q[2]=C,Q[3]=S,Q[4]=A,Q[5]=E,Q[6]=R,Q[7]=z,Q[8]=O,Q[9]=M,Q[10]=B,Q[11]=V,Q[12]=q,Q[13]=j,Q[14]=H,Q[15]=W,X._markAsUpdated()}static FromValues(v,T,C,S,A,E,R,z,O,M,B,V,q,j,H,W){const X=new Dt,Q=X._m;return Q[0]=v,Q[1]=T,Q[2]=C,Q[3]=S,Q[4]=A,Q[5]=E,Q[6]=R,Q[7]=z,Q[8]=O,Q[9]=M,Q[10]=B,Q[11]=V,Q[12]=q,Q[13]=j,Q[14]=H,Q[15]=W,X._markAsUpdated(),X}static Compose(v,T,C){const S=new Dt;return Dt.ComposeToRef(v,T,C,S),S}static ComposeToRef(v,T,C,S){Dt.ScalingToRef(v.x,v.y,v.z,Ht.MathTmp.Matrix[1]),T.toRotationMatrix(Ht.MathTmp.Matrix[0]),Ht.MathTmp.Matrix[1].multiplyToRef(Ht.MathTmp.Matrix[0],S),S.setTranslation(C)}static Identity(){const v=Dt.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return v._updateIdentityStatus(!0),v}static IdentityToRef(v){Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,v),v._updateIdentityStatus(!0)}static Zero(){const v=Dt.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return v._updateIdentityStatus(!1),v}static RotationX(v){const T=new Dt;return Dt.RotationXToRef(v,T),T}static Invert(v){const T=new Dt;return v.invertToRef(T),T}static RotationXToRef(v,T){const C=Math.sin(v),S=Math.cos(v);Dt.FromValuesToRef(1,0,0,0,0,S,C,0,0,-C,S,0,0,0,0,1,T),T._updateIdentityStatus(1===S&&0===C)}static RotationY(v){const T=new Dt;return Dt.RotationYToRef(v,T),T}static RotationYToRef(v,T){const C=Math.sin(v),S=Math.cos(v);Dt.FromValuesToRef(S,0,-C,0,0,1,0,0,C,0,S,0,0,0,0,1,T),T._updateIdentityStatus(1===S&&0===C)}static RotationZ(v){const T=new Dt;return Dt.RotationZToRef(v,T),T}static RotationZToRef(v,T){const C=Math.sin(v),S=Math.cos(v);Dt.FromValuesToRef(S,C,0,0,-C,S,0,0,0,0,1,0,0,0,0,1,T),T._updateIdentityStatus(1===S&&0===C)}static RotationAxis(v,T){const C=new Dt;return Dt.RotationAxisToRef(v,T,C),C}static RotationAxisToRef(v,T,C){const S=Math.sin(-T),A=Math.cos(-T),E=1-A;v.normalize();const R=C._m;R[0]=v.x*v.x*E+A,R[1]=v.x*v.y*E-v.z*S,R[2]=v.x*v.z*E+v.y*S,R[3]=0,R[4]=v.y*v.x*E+v.z*S,R[5]=v.y*v.y*E+A,R[6]=v.y*v.z*E-v.x*S,R[7]=0,R[8]=v.z*v.x*E-v.y*S,R[9]=v.z*v.y*E+v.x*S,R[10]=v.z*v.z*E+A,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,C._markAsUpdated()}static RotationYawPitchRoll(v,T,C){const S=new Dt;return Dt.RotationYawPitchRollToRef(v,T,C,S),S}static RotationYawPitchRollToRef(v,T,C,S){qt.Quaternion.RotationYawPitchRollToRef(v,T,C,Ht.MathTmp.Quaternion[0]),Ht.MathTmp.Quaternion[0].toRotationMatrix(S)}static Scaling(v,T,C){const S=new Dt;return Dt.ScalingToRef(v,T,C,S),S}static ScalingToRef(v,T,C,S){Dt.FromValuesToRef(v,0,0,0,0,T,0,0,0,0,C,0,0,0,0,1,S),S._updateIdentityStatus(1===v&&1===T&&1===C)}static Translation(v,T,C){const S=new Dt;return Dt.TranslationToRef(v,T,C,S),S}static TranslationToRef(v,T,C,S){Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,v,T,C,1,S),S._updateIdentityStatus(0===v&&0===T&&0===C)}static Lerp(v,T,C){const S=new Dt;return Dt.LerpToRef(v,T,C,S),S}static LerpToRef(v,T,C,S){for(let A=0;A<16;A++)S._m[A]=v._m[A]*(1-C)+T._m[A]*C;S._markAsUpdated()}static DecomposeLerp(v,T,C){const S=new Dt;return Dt.DecomposeLerpToRef(v,T,C,S),S}static DecomposeLerpToRef(v,T,C,S){const A=Ht.MathTmp.Vector3[0],E=Ht.MathTmp.Quaternion[0],R=Ht.MathTmp.Vector3[1];v.decompose(A,E,R);const z=Ht.MathTmp.Vector3[2],O=Ht.MathTmp.Quaternion[1],M=Ht.MathTmp.Vector3[3];T.decompose(z,O,M);const B=Ht.MathTmp.Vector3[4];Vt.Vector3.LerpToRef(A,z,C,B);const V=Ht.MathTmp.Quaternion[2];qt.Quaternion.SlerpToRef(E,O,C,V);const q=Ht.MathTmp.Vector3[5];Vt.Vector3.LerpToRef(R,M,C,q),Dt.ComposeToRef(B,V,q,S)}static LookAtLH(v,T,C){const S=new Dt;return Dt.LookAtLHToRef(v,T,C,S),S}static LookAtLHToRef(v,T,C,S){const A=Ht.MathTmp.Vector3[0],E=Ht.MathTmp.Vector3[1],R=Ht.MathTmp.Vector3[2];T.subtractToRef(v,R),R.normalize(),Vt.Vector3.CrossToRef(C,R,A);const z=A.lengthSquared();0===z?A.x=1:A.normalizeFromLength(Math.sqrt(z)),Vt.Vector3.CrossToRef(R,A,E),E.normalize();const O=-Vt.Vector3.Dot(A,v),M=-Vt.Vector3.Dot(E,v),B=-Vt.Vector3.Dot(R,v);Dt.FromValuesToRef(A.x,E.x,R.x,0,A.y,E.y,R.y,0,A.z,E.z,R.z,0,O,M,B,1,S)}static LookAtRH(v,T,C){const S=new Dt;return Dt.LookAtRHToRef(v,T,C,S),S}static LookAtRHToRef(v,T,C,S){const A=Ht.MathTmp.Vector3[0],E=Ht.MathTmp.Vector3[1],R=Ht.MathTmp.Vector3[2];v.subtractToRef(T,R),R.normalize(),Vt.Vector3.CrossToRef(C,R,A);const z=A.lengthSquared();0===z?A.x=1:A.normalizeFromLength(Math.sqrt(z)),Vt.Vector3.CrossToRef(R,A,E),E.normalize();const O=-Vt.Vector3.Dot(A,v),M=-Vt.Vector3.Dot(E,v),B=-Vt.Vector3.Dot(R,v);Dt.FromValuesToRef(A.x,E.x,R.x,0,A.y,E.y,R.y,0,A.z,E.z,R.z,0,O,M,B,1,S)}static OrthoLH(v,T,C,S){const A=new Dt;return Dt.OrthoLHToRef(v,T,C,S,A),A}static OrthoLHToRef(v,T,C,S,A){const E=2/v,R=2/T,z=2/(S-C),O=-(S+C)/(S-C);Dt.FromValuesToRef(E,0,0,0,0,R,0,0,0,0,z,0,0,0,O,1,A),A._updateIdentityStatus(1===E&&1===R&&1===z&&0===O)}static OrthoOffCenterLH(v,T,C,S,A,E){const R=new Dt;return Dt.OrthoOffCenterLHToRef(v,T,C,S,A,E,R),R}static OrthoOffCenterLHToRef(v,T,C,S,A,E,R){const z=2/(T-v),O=2/(S-C),M=2/(E-A),B=-(E+A)/(E-A),V=(v+T)/(v-T),q=(S+C)/(C-S);Dt.FromValuesToRef(z,0,0,0,0,O,0,0,0,0,M,0,V,q,B,1,R),R._markAsUpdated()}static OrthoOffCenterRH(v,T,C,S,A,E){const R=new Dt;return Dt.OrthoOffCenterRHToRef(v,T,C,S,A,E,R),R}static OrthoOffCenterRHToRef(v,T,C,S,A,E,R){Dt.OrthoOffCenterLHToRef(v,T,C,S,A,E,R),R._m[10]*=-1}static PerspectiveLH(v,T,C,S){const A=new Dt,E=2*C/v,R=2*C/T,z=(S+C)/(S-C),O=-2*S*C/(S-C);return Dt.FromValuesToRef(E,0,0,0,0,R,0,0,0,0,z,1,0,0,O,0,A),A._updateIdentityStatus(!1),A}static PerspectiveFovLH(v,T,C,S){const A=new Dt;return Dt.PerspectiveFovLHToRef(v,T,C,S,A),A}static PerspectiveFovLHToRef(v,T,C,S,A,E=!0){const R=C,z=S,O=1/Math.tan(.5*v),M=E?O/T:O,B=E?O:O*T,V=(z+R)/(z-R),q=-2*z*R/(z-R);Dt.FromValuesToRef(M,0,0,0,0,B,0,0,0,0,V,1,0,0,q,0,A),A._updateIdentityStatus(!1)}static PerspectiveFovRH(v,T,C,S){const A=new Dt;return Dt.PerspectiveFovRHToRef(v,T,C,S,A),A}static PerspectiveFovRHToRef(v,T,C,S,A,E=!0){const R=C,z=S,O=1/Math.tan(.5*v),M=E?O/T:O,B=E?O:O*T,V=-(z+R)/(z-R),q=-2*z*R/(z-R);Dt.FromValuesToRef(M,0,0,0,0,B,0,0,0,0,V,-1,0,0,q,0,A),A._updateIdentityStatus(!1)}static PerspectiveFovWebVRToRef(v,T,C,S,A=!1){const E=A?-1:1,R=Math.tan(v.upDegrees*Math.PI/180),z=Math.tan(v.downDegrees*Math.PI/180),O=Math.tan(v.leftDegrees*Math.PI/180),M=Math.tan(v.rightDegrees*Math.PI/180),B=2/(O+M),V=2/(R+z),q=S._m;q[0]=B,q[1]=q[2]=q[3]=q[4]=0,q[5]=V,q[6]=q[7]=0,q[8]=(O-M)*B*.5,q[9]=-(R-z)*V*.5,q[10]=-C/(T-C),q[11]=1*E,q[12]=q[13]=q[15]=0,q[14]=-2*C*T/(C-T),S._markAsUpdated()}static GetAsMatrix2x2(v){return[v._m[0],v._m[1],v._m[4],v._m[5]]}static GetAsMatrix3x3(v){return[v._m[0],v._m[1],v._m[2],v._m[4],v._m[5],v._m[6],v._m[8],v._m[9],v._m[10]]}static Transpose(v){const T=new Dt;return Dt.TransposeToRef(v,T),T}static TransposeToRef(v,T){const C=T._m,S=v._m;C[0]=S[0],C[1]=S[4],C[2]=S[8],C[3]=S[12],C[4]=S[1],C[5]=S[5],C[6]=S[9],C[7]=S[13],C[8]=S[2],C[9]=S[6],C[10]=S[10],C[11]=S[14],C[12]=S[3],C[13]=S[7],C[14]=S[11],C[15]=S[15],T._updateIdentityStatus(v._isIdentity,v._isIdentityDirty)}static Reflection(v){const T=new Dt;return Dt.ReflectionToRef(v,T),T}static ReflectionToRef(v,T){v.normalize();const C=v.normal.x,S=v.normal.y,A=v.normal.z,E=-2*C,R=-2*S,z=-2*A;Dt.FromValuesToRef(E*C+1,R*C,z*C,0,E*S,R*S+1,z*S,0,E*A,R*A,z*A+1,0,E*v.d,R*v.d,z*v.d,1,T)}static FromXYZAxesToRef(v,T,C,S){Dt.FromValuesToRef(v.x,v.y,v.z,0,T.x,T.y,T.z,0,C.x,C.y,C.z,0,0,0,0,1,S)}static FromQuaternionToRef(v,T){const C=v.x*v.x,S=v.y*v.y,A=v.z*v.z,E=v.x*v.y,R=v.z*v.w,z=v.z*v.x,O=v.y*v.w,M=v.y*v.z,B=v.x*v.w;T._m[0]=1-2*(S+A),T._m[1]=2*(E+R),T._m[2]=2*(z-O),T._m[3]=0,T._m[4]=2*(E-R),T._m[5]=1-2*(A+C),T._m[6]=2*(M+B),T._m[7]=0,T._m[8]=2*(z+O),T._m[9]=2*(M-B),T._m[10]=1-2*(S+C),T._m[11]=0,T._m[12]=0,T._m[13]=0,T._m[14]=0,T._m[15]=1,T._markAsUpdated()}_markAsUpdated(){this.updateFlag=Dt._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const v=this._m;this._isIdentity=1===v[0]&&0===v[1]&&0===v[2]&&0===v[3]&&0===v[4]&&1===v[5]&&0===v[6]&&0===v[7]&&0===v[8]&&0===v[9]&&1===v[10]&&0===v[11]&&0===v[12]&&0===v[13]&&0===v[14]&&1===v[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const v=this._m,T=v[0],C=v[1],S=v[2],A=v[3],E=v[4],R=v[5],z=v[6],O=v[7],M=v[8],B=v[9],V=v[10],q=v[11],j=v[12],H=v[13],W=v[14],X=v[15],Q=V*X-W*q,Z=B*X-H*q,J=B*W-H*V,K=M*X-j*q,$=M*W-V*j,et=M*H-j*B;return T*+(R*Q-z*Z+O*J)+C*-(E*Q-z*K+O*$)+S*+(E*Z-R*K+O*et)+A*-(E*J-R*$+z*et)}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return Dt.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(v){const T=new Dt;return this.addToRef(v,T),T}addToRef(v,T){for(let C=0;C<16;C++)T._m[C]=this._m[C]+v._m[C];return T._markAsUpdated(),this}addToSelf(v){for(let T=0;T<16;T++)this._m[T]+=v._m[T];return this._markAsUpdated(),this}invertToRef(v){if(!0===this._isIdentity)return Dt.IdentityToRef(v),this;const T=this._m,C=T[0],S=T[1],A=T[2],E=T[3],R=T[4],z=T[5],O=T[6],M=T[7],B=T[8],V=T[9],q=T[10],j=T[11],H=T[12],W=T[13],X=T[14],Q=T[15],Z=q*Q-X*j,J=V*Q-W*j,K=V*X-W*q,$=B*Q-H*j,et=B*X-q*H,nt=B*W-H*V,it=+(z*Z-O*J+M*K),ot=-(R*Z-O*$+M*et),rt=+(R*J-z*$+M*nt),st=-(R*K-z*et+O*nt),at=C*it+S*ot+A*rt+E*st;if(0===at)return v.copyFrom(this),this;const ht=1/at,lt=O*Q-X*M,ct=z*Q-W*M,ut=z*X-W*O,dt=R*Q-H*M,pt=R*X-H*O,ft=R*W-H*z,yt=O*j-q*M,gt=z*j-V*M,vt=z*q-V*O,wt=R*j-B*M,bt=R*q-B*O,Tt=R*V-B*z,Ct=-(S*Z-A*J+E*K),St=+(C*Z-A*$+E*et),xt=-(C*J-S*$+E*nt),_t=+(C*K-S*et+A*nt),At=+(S*lt-A*ct+E*ut),Rt=-(C*lt-A*dt+E*pt),It=+(C*ct-S*dt+E*ft),Pt=-(C*ut-S*pt+A*ft),zt=-(S*yt-A*gt+E*vt),Ot=+(C*yt-A*wt+E*bt),Nt=-(C*gt-S*wt+E*Tt),Bt=+(C*vt-S*bt+A*Tt);return Dt.FromValuesToRef(it*ht,Ct*ht,At*ht,zt*ht,ot*ht,St*ht,Rt*ht,Ot*ht,rt*ht,xt*ht,It*ht,Nt*ht,st*ht,_t*ht,Pt*ht,Bt*ht,v),this}addAtIndex(v,T){return this._m[v]+=T,this._markAsUpdated(),this}multiplyAtIndex(v,T){return this._m[v]*=T,this._markAsUpdated(),this}setTranslationFromFloats(v,T,C){return this._m[12]=v,this._m[13]=T,this._m[14]=C,this._markAsUpdated(),this}setTranslation(v){return this.setTranslationFromFloats(v.x,v.y,v.z)}getTranslation(){return new Vt.Vector3(this._m[12],this._m[13],this._m[14])}getTranslationToRef(v){return v.x=this._m[12],v.y=this._m[13],v.z=this._m[14],this}removeRotationAndScaling(){const v=this.m;return Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,v[12],v[13],v[14],v[15],this),this._updateIdentityStatus(0===v[12]&&0===v[13]&&0===v[14]&&1===v[15]),this}multiply(v){const T=new Dt;return this.multiplyToRef(v,T),T}copyFrom(v){v.copyToArray(this._m);const T=v;return this._updateIdentityStatus(T._isIdentity,T._isIdentityDirty,T._isIdentity3x2,T._isIdentity3x2Dirty),this}copyToArray(v,T=0){for(let C=0;C<16;C++)v[T+C]=this._m[C];return this}multiplyToRef(v,T){return this._isIdentity?(T.copyFrom(v),this):v._isIdentity?(T.copyFrom(this),this):(this.multiplyToArray(v,T._m,0),T._markAsUpdated(),this)}multiplyToArray(v,T,C){const S=this._m,A=v.m,E=S[0],R=S[1],z=S[2],O=S[3],M=S[4],B=S[5],V=S[6],q=S[7],j=S[8],H=S[9],W=S[10],X=S[11],Q=S[12],Z=S[13],J=S[14],K=S[15],$=A[0],et=A[1],nt=A[2],it=A[3],ot=A[4],rt=A[5],st=A[6],at=A[7],ht=A[8],lt=A[9],ct=A[10],ut=A[11],dt=A[12],pt=A[13],ft=A[14],yt=A[15];return T[C]=E*$+R*ot+z*ht+O*dt,T[C+1]=E*et+R*rt+z*lt+O*pt,T[C+2]=E*nt+R*st+z*ct+O*ft,T[C+3]=E*it+R*at+z*ut+O*yt,T[C+4]=M*$+B*ot+V*ht+q*dt,T[C+5]=M*et+B*rt+V*lt+q*pt,T[C+6]=M*nt+B*st+V*ct+q*ft,T[C+7]=M*it+B*at+V*ut+q*yt,T[C+8]=j*$+H*ot+W*ht+X*dt,T[C+9]=j*et+H*rt+W*lt+X*pt,T[C+10]=j*nt+H*st+W*ct+X*ft,T[C+11]=j*it+H*at+W*ut+X*yt,T[C+12]=Q*$+Z*ot+J*ht+K*dt,T[C+13]=Q*et+Z*rt+J*lt+K*pt,T[C+14]=Q*nt+Z*st+J*ct+K*ft,T[C+15]=Q*it+Z*at+J*ut+K*yt,this}equals(v){const T=v;if(!T)return!1;if((this._isIdentity||T._isIdentity)&&!this._isIdentityDirty&&!T._isIdentityDirty)return this._isIdentity&&T._isIdentity;const C=this.m,S=T.m;return C[0]===S[0]&&C[1]===S[1]&&C[2]===S[2]&&C[3]===S[3]&&C[4]===S[4]&&C[5]===S[5]&&C[6]===S[6]&&C[7]===S[7]&&C[8]===S[8]&&C[9]===S[9]&&C[10]===S[10]&&C[11]===S[11]&&C[12]===S[12]&&C[13]===S[13]&&C[14]===S[14]&&C[15]===S[15]}clone(){const v=new Dt;return v.copyFrom(this),v}getClassName(){return"Matrix"}getHashCode(){let v=this._m[0]||0;for(let T=1;T<16;T++)v=397*v^(this._m[T]||0);return v}decompose(v,T,C){if(this._isIdentity)return C&&C.setAll(0),v&&v.setAll(1),T&&T.copyFromFloats(0,0,0,1),!0;const S=this._m;C&&C.copyFromFloats(S[12],S[13],S[14]);const A=v||Ht.MathTmp.Vector3[0];if(A.x=Math.sqrt(S[0]*S[0]+S[1]*S[1]+S[2]*S[2]),A.y=Math.sqrt(S[4]*S[4]+S[5]*S[5]+S[6]*S[6]),A.z=Math.sqrt(S[8]*S[8]+S[9]*S[9]+S[10]*S[10]),this.determinant()<=0&&(A.y*=-1),0===A.x||0===A.y||0===A.z)return T&&T.copyFromFloats(0,0,0,1),!1;if(T){const v=1/A.x,C=1/A.y,E=1/A.z;Dt.FromValuesToRef(S[0]*v,S[1]*v,S[2]*v,0,S[4]*C,S[5]*C,S[6]*C,0,S[8]*E,S[9]*E,S[10]*E,0,0,0,0,1,Ht.MathTmp.Matrix[0]),qt.Quaternion.FromRotationMatrixToRef(Ht.MathTmp.Matrix[0],T)}return!0}getRow(v){if(v<0||v>3)return null;const T=4*v;return new Wt.Vector4(this._m[T+0],this._m[T+1],this._m[T+2],this._m[T+3])}setRow(v,T){return this.setRowFromFloats(v,T.x,T.y,T.z,T.w)}transpose(){return Dt.Transpose(this)}transposeToRef(v){return Dt.TransposeToRef(this,v),this}setRowFromFloats(v,T,C,S,A){if(v<0||v>3)return this;const E=4*v;return this._m[E+0]=T,this._m[E+1]=C,this._m[E+2]=S,this._m[E+3]=A,this._markAsUpdated(),this}scale(v){const T=new Dt;return this.scaleToRef(v,T),T}scaleToRef(v,T){for(let C=0;C<16;C++)T._m[C]=this._m[C]*v;return T._markAsUpdated(),this}scaleAndAddToRef(v,T){for(let C=0;C<16;C++)T._m[C]+=this._m[C]*v;return T._markAsUpdated(),this}toNormalMatrix(v){const T=Ht.MathTmp.Matrix[0];this.invertToRef(T),T.transposeToRef(v);const C=v._m;Dt.FromValuesToRef(C[0],C[1],C[2],0,C[4],C[5],C[6],0,C[8],C[9],C[10],0,0,0,0,1,v)}getRotationMatrix(){const v=new Dt;return this.getRotationMatrixToRef(v),v}getRotationMatrixToRef(v){const T=Ht.MathTmp.Vector3[0];if(!this.decompose(T))return Dt.IdentityToRef(v),this;const C=this._m,S=1/T.x,A=1/T.y,E=1/T.z;return Dt.FromValuesToRef(C[0]*S,C[1]*S,C[2]*S,0,C[4]*A,C[5]*A,C[6]*A,0,C[8]*E,C[9]*E,C[10]*E,0,0,0,0,1,v),this}toggleModelMatrixHandInPlace(){const v=this._m;v[2]*=-1,v[6]*=-1,v[8]*=-1,v[9]*=-1,v[14]*=-1,this._markAsUpdated()}toggleProjectionMatrixHandInPlace(){const v=this._m;v[8]*=-1,v[9]*=-1,v[10]*=-1,v[11]*=-1,this._markAsUpdated()}_updateIdentityStatus(v,T=!1,C=!1,S=!0){this.updateFlag=Dt._updateFlagSeed++,this._isIdentity=v,this._isIdentity3x2=v||C,this._isIdentityDirty=!this._isIdentity&&T,this._isIdentity3x2Dirty=!this._isIdentity3x2&&S}}Nt.Matrix=Dt,Dt._updateFlagSeed=0,Dt._identityReadOnly=Dt.Identity(),Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Quaternion=void 0;const Gt=Nt,Yt=zt,Qt=It,Zt=Rt,Jt=Lt;class jt{constructor(v=0,T=0,C=0,S=1){this.x=v,this.y=T,this.z=C,this.w=S}static FromRotationMatrix(v){const T=new jt;return jt.FromRotationMatrixToRef(v,T),T}static FromRotationMatrixToRef(v,T){const C=v.m,S=C[0],A=C[4],E=C[8],R=C[1],z=C[5],O=C[9],M=C[2],B=C[6],V=C[10],q=S+z+V;let j;q>0?(j=.5/Math.sqrt(q+1),T.w=.25/j,T.x=(B-O)*j,T.y=(E-M)*j,T.z=(R-A)*j):S>z&&S>V?(j=2*Math.sqrt(1+S-z-V),T.w=(B-O)/j,T.x=.25*j,T.y=(A+R)/j,T.z=(E+M)/j):z>V?(j=2*Math.sqrt(1+z-S-V),T.w=(E-M)/j,T.x=(A+R)/j,T.y=.25*j,T.z=(O+B)/j):(j=2*Math.sqrt(1+V-S-z),T.w=(R-A)/j,T.x=(E+M)/j,T.y=(O+B)/j,T.z=.25*j)}static Dot(v,T){return v.x*T.x+v.y*T.y+v.z*T.z+v.w*T.w}static AreClose(v,T){return jt.Dot(v,T)>=0}static Zero(){return new jt(0,0,0,0)}static Inverse(v){return new jt(-v.x,-v.y,-v.z,v.w)}static IsIdentity(v){return v&&0===v.x&&0===v.y&&0===v.z&&1===v.w}static RotationAxis(v,T){const C=T*Zt.DEG2RAD;return jt.RotationAxisToRef(v,C,new jt)}static RotationAxisToRef(v,T,C){const S=T*Zt.DEG2RAD,A=Math.sin(S/2);return v.normalize(),C.w=Math.cos(S/2),C.x=v.x*A,C.y=v.y*A,C.z=v.z*A,C}static FromArray(v,T=0){return new jt(v[T],v[T+1],v[T+2],v[T+3])}static FromEulerAnglesRef(v,T,C,S){return jt.RotationYawPitchRollToRef(T*Zt.DEG2RAD,v*Zt.DEG2RAD,C*Zt.DEG2RAD,S)}static RotationYawPitchRoll(v,T,C){const S=new jt;return jt.RotationYawPitchRollToRef(v,T,C,S),S}static RotationYawPitchRollToRef(v,T,C,S){const A=.5*T,E=.5*v,R=.5*C,z=Math.cos(A),O=Math.cos(E),M=Math.cos(R),B=Math.sin(A),V=Math.sin(E),q=Math.sin(R);S.x=O*B*M+V*z*q,S.y=V*z*M-O*B*q,S.z=O*z*q-V*B*M,S.w=O*z*M+V*B*q}static RotationAlphaBetaGamma(v,T,C){const S=new jt;return jt.RotationAlphaBetaGammaToRef(v,T,C,S),S}static RotationAlphaBetaGammaToRef(v,T,C,S){const A=.5*(C+v),E=.5*(C-v),R=.5*T;S.x=Math.cos(E)*Math.sin(R),S.y=Math.sin(E)*Math.sin(R),S.z=Math.sin(A)*Math.cos(R),S.w=Math.cos(A)*Math.cos(R)}static RotationQuaternionFromAxis(v,T,C){const S=new jt(0,0,0,0);return jt.RotationQuaternionFromAxisToRef(v,T,C,S),S}static RotationQuaternionFromAxisToRef(v,T,C,S){const A=Qt.MathTmp.Matrix[0];Gt.Matrix.FromXYZAxesToRef(v.normalize(),T.normalize(),C.normalize(),A),jt.FromRotationMatrixToRef(A,S)}static Slerp(v,T,C){const S=jt.Identity;return jt.SlerpToRef(v,T,C,S),S}static SlerpToRef(v,T,C,S){let A,E,R=v.x*T.x+v.y*T.y+v.z*T.z+v.w*T.w,z=!1;if(R<0&&(z=!0,R=-R),R>.999999)E=1-C,A=z?-C:C;else{const v=Math.acos(R),T=1/Math.sin(v);E=Math.sin((1-C)*v)*T,A=z?-Math.sin(C*v)*T:Math.sin(C*v)*T}S.x=E*v.x+A*T.x,S.y=E*v.y+A*T.y,S.z=E*v.z+A*T.z,S.w=E*v.w+A*T.w}static Hermite(v,T,C,S,A){const E=A*A,R=A*E,z=2*R-3*E+1,O=-2*R+3*E,M=R-2*E+A,B=R-E,V=v.x*z+C.x*O+T.x*M+S.x*B,q=v.y*z+C.y*O+T.y*M+S.y*B,j=v.z*z+C.z*O+T.z*M+S.z*B,H=v.w*z+C.w*O+T.w*M+S.w*B;return new jt(V,q,j,H)}static get Identity(){return new jt(0,0,0,1)}static Angle(v,T){const C=jt.Dot(v,T);return 2*Math.acos(Math.min(Math.abs(C),1))*Zt.RAD2DEG}static Euler(v,T,C){return jt.RotationYawPitchRoll(T*Zt.DEG2RAD,v*Zt.DEG2RAD,C*Zt.DEG2RAD)}static LookRotation(v,T=Qt.MathTmp.staticUp){const C=Yt.Vector3.Normalize(v),S=Yt.Vector3.Normalize(Yt.Vector3.Cross(T,C)),A=Yt.Vector3.Cross(C,S),E=S.x,R=S.y,z=S.z,O=A.x,M=A.y,B=A.z,V=C.x,q=C.y,j=C.z,H=E+M+j,W=new jt;if(H>0){let v=Math.sqrt(H+1);return W.w=.5*v,v=.5/v,W.x=(B-q)*v,W.y=(V-z)*v,W.z=(R-O)*v,W}if(E>=M&&E>=j){const v=Math.sqrt(1+E-M-j),T=.5/v;return W.x=.5*v,W.y=(R+O)*T,W.z=(z+V)*T,W.w=(B-q)*T,W}if(M>j){const v=Math.sqrt(1+M-E-j),T=.5/v;return W.x=(O+R)*T,W.y=.5*v,W.z=(q+B)*T,W.w=(V-z)*T,W}const X=Math.sqrt(1+j-E-M),Q=.5/X;return W.x=(V+z)*Q,W.y=(q+B)*Q,W.z=.5*X,W.w=(R-O)*Q,W}static RotateTowards(v,T,C){const S=jt.Angle(v,T);if(0===S)return T;const A=Math.min(1,C/S);return jt.Slerp(v,T,A)}static FromToRotation(v,T,C=Qt.MathTmp.staticUp){const S=v.normalize(),A=T.normalize(),E=Yt.Vector3.Cross(S,A),R=Math.sqrt(S.lengthSquared()*A.lengthSquared())+Yt.Vector3.Dot(S,A);return E.lengthSquared()<1e-4?Math.abs(R)<1e-4?new jt(C.x,C.y,C.z,0).normalized:jt.Identity:new jt(E.x,E.y,E.z,R).normalized}get normalized(){return this.normalize()}setFromToRotation(v,T,C=Qt.MathTmp.staticUp){const S=jt.FromToRotation(v,T,C);this.x=S.x,this.y=S.y,this.z=S.z,this.w=S.w}set eulerAngles(v){this.setEuler(v.x,v.y,v.z)}get eulerAngles(){const v=new Yt.Vector3,T=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,C=this.x*this.w-this.y*this.z;return C>.4995*T?(v.x=Math.PI/2,v.y=2*Math.atan2(this.y,this.x),v.z=0):C<-.4995*T?(v.x=-Math.PI/2,v.y=-2*Math.atan2(this.y,this.x),v.z=0):(v.x=Math.asin(2*(this.w*this.x-this.y*this.z)),v.y=Math.atan2(2*this.w*this.y+2*this.z*this.x,1-2*(this.x*this.x+this.y*this.y)),v.z=Math.atan2(2*this.w*this.z+2*this.x*this.y,1-2*(this.z*this.z+this.x*this.x))),v.x*=Zt.RAD2DEG,v.y*=Zt.RAD2DEG,v.z*=Zt.RAD2DEG,v.x=Jt.Scalar.Repeat(v.x,360),v.y=Jt.Scalar.Repeat(v.y,360),v.z=Jt.Scalar.Repeat(v.z,360),v}toString(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}getClassName(){return"Quaternion"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v=397*v^(this.w||0),v}asArray(){return[this.x,this.y,this.z,this.w]}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z&&this.w===v.w}clone(){return new jt(this.x,this.y,this.z,this.w)}copyFrom(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=v.w,this}copyFromFloats(v,T,C,S){return this.x=v,this.y=T,this.z=C,this.w=S,this}set(v,T,C,S){return this.copyFromFloats(v,T,C,S)}setEuler(v,T,C){return jt.RotationYawPitchRollToRef(T*Zt.DEG2RAD,v*Zt.DEG2RAD,C*Zt.DEG2RAD,this),this}add(v){return new jt(this.x+v.x,this.y+v.y,this.z+v.z,this.w+v.w)}addInPlace(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this.w+=v.w,this}subtract(v){return new jt(this.x-v.x,this.y-v.y,this.z-v.z,this.w-v.w)}scale(v){return new jt(this.x*v,this.y*v,this.z*v,this.w*v)}scaleToRef(v,T){return T.x=this.x*v,T.y=this.y*v,T.z=this.z*v,T.w=this.w*v,this}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}scaleAndAddToRef(v,T){return T.x+=this.x*v,T.y+=this.y*v,T.z+=this.z*v,T.w+=this.w*v,this}multiply(v){const T=new jt(0,0,0,1);return this.multiplyToRef(v,T),T}multiplyToRef(v,T){const C=this.x*v.w+this.y*v.z-this.z*v.y+this.w*v.x,S=-this.x*v.z+this.y*v.w+this.z*v.x+this.w*v.y,A=this.x*v.y-this.y*v.x+this.z*v.w+this.w*v.z,E=-this.x*v.x-this.y*v.y-this.z*v.z+this.w*v.w;return T.copyFromFloats(C,S,A,E),this}multiplyInPlace(v){return this.multiplyToRef(v,this),this}conjugateToRef(v){return v.copyFromFloats(-this.x,-this.y,-this.z,this.w),this}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new jt(-this.x,-this.y,-this.z,this.w)}normalize(){const v=1/this.length;return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}angleAxis(v,T){if(0===T.lengthSquared())return jt.Identity;const C=jt.Identity;let S=v*Zt.DEG2RAD;S*=.5;let A=T.normalize();return A=T.scaleInPlace(Math.sin(S)),C.x=A.x,C.y=A.y,C.z=A.z,C.w=Math.cos(S),C.normalize()}toRotationMatrix(v){return Gt.Matrix.FromQuaternionToRef(this,v),this}fromRotationMatrix(v){return jt.FromRotationMatrixToRef(v,this),this}}Ot.Quaternion=jt,Object.defineProperty(zt,"__esModule",{value:!0}),zt.Vector3=void 0;const Kt=It,$t=Rt,ee=Ot,ne=Lt;class Xt{constructor(v=0,T=0,C=0){this.x=v,this.y=T,this.z=C}get isNonUniform(){const v=Math.abs(this.x),T=Math.abs(this.y);if(v!==T)return!0;const C=Math.abs(this.z);return v!==C||T!==C}static Add(v,T){return new Xt(v.x,v.y,v.z).addInPlace(T)}static GetClipFactor(v,T,C,S){const A=Xt.Dot(v,C)-S;return A/(A-(Xt.Dot(T,C)-S))}static GetAngleBetweenVectors(v,T,C){const S=v.normalizeToRef(Kt.MathTmp.Vector3[1]),A=T.normalizeToRef(Kt.MathTmp.Vector3[2]),E=Xt.Dot(S,A),R=Kt.MathTmp.Vector3[3];return Xt.CrossToRef(S,A,R),Xt.Dot(R,C)>0?Math.acos(E):-Math.acos(E)}static FromArray(v,T=0){return new Xt(v[T],v[T+1],v[T+2])}static FromFloatArray(v,T){return Xt.FromArray(v,T)}static FromArrayToRef(v,T,C){C.x=v[T],C.y=v[T+1],C.z=v[T+2]}static FromFloatArrayToRef(v,T,C){return Xt.FromArrayToRef(v,T,C)}static FromFloatsToRef(v,T,C,S){S.copyFromFloats(v,T,C)}static Zero(){return new Xt(0,0,0)}static One(){return new Xt(1,1,1)}static Up(){return new Xt(0,1,0)}static Down(){return new Xt(0,-1,0)}static Forward(){return new Xt(0,0,1)}static Backward(){return new Xt(0,0,-1)}static Right(){return new Xt(1,0,0)}static Left(){return new Xt(-1,0,0)}static TransformCoordinates(v,T){const C=Xt.Zero();return Xt.TransformCoordinatesToRef(v,T,C),C}static TransformCoordinatesToRef(v,T,C){return Xt.TransformCoordinatesFromFloatsToRef(v.x,v.y,v.z,T,C)}static TransformCoordinatesFromFloatsToRef(v,T,C,S,A){const E=S.m,R=v*E[0]+T*E[4]+C*E[8]+E[12],z=v*E[1]+T*E[5]+C*E[9]+E[13],O=v*E[2]+T*E[6]+C*E[10]+E[14],M=1/(v*E[3]+T*E[7]+C*E[11]+E[15]);A.x=R*M,A.y=z*M,A.z=O*M}static TransformNormal(v,T){const C=Xt.Zero();return Xt.TransformNormalToRef(v,T,C),C}static TransformNormalToRef(v,T,C){this.TransformNormalFromFloatsToRef(v.x,v.y,v.z,T,C)}static TransformNormalFromFloatsToRef(v,T,C,S,A){const E=S.m;A.x=v*E[0]+T*E[4]+C*E[8],A.y=v*E[1]+T*E[5]+C*E[9],A.z=v*E[2]+T*E[6]+C*E[10]}static CatmullRom(v,T,C,S,A){const E=A*A,R=A*E,z=.5*(2*T.x+(-v.x+C.x)*A+(2*v.x-5*T.x+4*C.x-S.x)*E+(-v.x+3*T.x-3*C.x+S.x)*R),O=.5*(2*T.y+(-v.y+C.y)*A+(2*v.y-5*T.y+4*C.y-S.y)*E+(-v.y+3*T.y-3*C.y+S.y)*R),M=.5*(2*T.z+(-v.z+C.z)*A+(2*v.z-5*T.z+4*C.z-S.z)*E+(-v.z+3*T.z-3*C.z+S.z)*R);return new Xt(z,O,M)}static Clamp(v,T,C){const S=new Xt;return Xt.ClampToRef(v,T,C,S),S}static ClampToRef(v,T,C,S){let A=v.x;A=A>C.x?C.x:A,A=A<T.x?T.x:A;let E=v.y;E=E>C.y?C.y:E,E=E<T.y?T.y:E;let R=v.z;R=R>C.z?C.z:R,R=R<T.z?T.z:R,S.copyFromFloats(A,E,R)}static Hermite(v,T,C,S,A){const E=A*A,R=A*E,z=2*R-3*E+1,O=-2*R+3*E,M=R-2*E+A,B=R-E,V=v.x*z+C.x*O+T.x*M+S.x*B,q=v.y*z+C.y*O+T.y*M+S.y*B,j=v.z*z+C.z*O+T.z*M+S.z*B;return new Xt(V,q,j)}static Lerp(v,T,C){const S=new Xt(0,0,0);return Xt.LerpToRef(v,T,C,S),S}static LerpToRef(v,T,C,S){S.x=v.x+(T.x-v.x)*C,S.y=v.y+(T.y-v.y)*C,S.z=v.z+(T.z-v.z)*C}static Dot(v,T){return v.x*T.x+v.y*T.y+v.z*T.z}static Cross(v,T){const C=Xt.Zero();return Xt.CrossToRef(v,T,C),C}static CrossToRef(v,T,C){const S=v.y*T.z-v.z*T.y,A=v.z*T.x-v.x*T.z,E=v.x*T.y-v.y*T.x;C.copyFromFloats(S,A,E)}static Normalize(v){const T=Xt.Zero();return Xt.NormalizeToRef(v,T),T}static NormalizeToRef(v,T){v.normalizeToRef(T)}static Minimize(v,T){const C=new Xt(v.x,v.y,v.z);return C.minimizeInPlace(T),C}static Maximize(v,T){const C=new Xt(v.x,v.y,v.z);return C.maximizeInPlace(T),C}static Distance(v,T){return Math.sqrt(Xt.DistanceSquared(v,T))}static DistanceSquared(v,T){const C=v.x-T.x,S=v.y-T.y,A=v.z-T.z;return C*C+S*S+A*A}static Center(v,T){const C=Xt.Add(v,T);return C.scaleInPlace(.5),C}static RotationFromAxis(v,T,C){const S=Xt.Zero();return Xt.RotationFromAxisToRef(v,T,C,S),S}static RotationFromAxisToRef(v,T,C,S){const A=Kt.MathTmp.Quaternion[0];ee.Quaternion.RotationQuaternionFromAxisToRef(v,T,C,A),S.copyFrom(A.eulerAngles)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}getClassName(){return"Vector3"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v}asArray(){const v=[];return this.toArray(v,0),v}toArray(v,T=0){return v[T]=this.x,v[T+1]=this.y,v[T+2]=this.z,this}toQuaternion(){return ee.Quaternion.Identity.setEuler(this.y,this.x,this.z)}addInPlace(v){return this.addInPlaceFromFloats(v.x,v.y,v.z)}addInPlaceFromFloats(v,T,C){return this.x+=v,this.y+=T,this.z+=C,this}add(v){return new Xt(this.x+v.x,this.y+v.y,this.z+v.z)}addToRef(v,T){return T.copyFromFloats(this.x+v.x,this.y+v.y,this.z+v.z)}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this}subtract(v){return new Xt(this.x-v.x,this.y-v.y,this.z-v.z)}subtractToRef(v,T){return this.subtractFromFloatsToRef(v.x,v.y,v.z,T)}subtractFromFloats(v,T,C){return new Xt(this.x-v,this.y-T,this.z-C)}subtractFromFloatsToRef(v,T,C,S){return S.copyFromFloats(this.x-v,this.y-T,this.z-C)}applyMatrix4(v){this.applyMatrix4ToRef(v,this)}applyMatrix4ToRef(v,T){const{x:C,y:S,z:A}=this,{m:E}=v,R=1/(E[3]*C+E[7]*S+E[11]*A+E[15]);return T.x=(E[0]*C+E[4]*S+E[8]*A+E[12])*R,T.y=(E[1]*C+E[5]*S+E[9]*A+E[13])*R,T.z=(E[2]*C+E[6]*S+E[10]*A+E[14])*R,T}rotate(v){return this.rotateToRef(v,this)}rotateToRef(v,T){const{x:C,y:S,z:A}=this,{x:E,y:R,z:z,w:O}=v,M=O*C+R*A-z*S,B=O*S+z*C-E*A,V=O*A+E*S-R*C,q=-E*C-R*S-z*A;return T.x=M*O+q*-E+B*-z-V*-R,T.y=B*O+q*-R+V*-E-M*-z,T.z=V*O+q*-z+M*-R-B*-E,T}negate(){return new Xt(-this.x,-this.y,-this.z)}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this}scale(v){return new Xt(this.x*v,this.y*v,this.z*v)}scaleToRef(v,T){return T.copyFromFloats(this.x*v,this.y*v,this.z*v)}scaleAndAddToRef(v,T){return T.addInPlaceFromFloats(this.x*v,this.y*v,this.z*v)}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z}equalsWithEpsilon(v,T=$t.Epsilon){return v&&ne.Scalar.WithinEpsilon(this.x,v.x,T)&&ne.Scalar.WithinEpsilon(this.y,v.y,T)&&ne.Scalar.WithinEpsilon(this.z,v.z,T)}equalsToFloats(v,T,C){return this.x===v&&this.y===T&&this.z===C}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z,this}multiply(v){return this.multiplyByFloats(v.x,v.y,v.z)}multiplyToRef(v,T){return T.copyFromFloats(this.x*v.x,this.y*v.y,this.z*v.z)}multiplyByFloats(v,T,C){return new Xt(this.x*v,this.y*T,this.z*C)}divide(v){return new Xt(this.x/v.x,this.y/v.y,this.z/v.z)}divideToRef(v,T){return T.copyFromFloats(this.x/v.x,this.y/v.y,this.z/v.z)}divideInPlace(v){return this.divideToRef(v,this)}minimizeInPlace(v){return this.minimizeInPlaceFromFloats(v.x,v.y,v.z)}maximizeInPlace(v){return this.maximizeInPlaceFromFloats(v.x,v.y,v.z)}minimizeInPlaceFromFloats(v,T,C){return v<this.x&&(this.x=v),T<this.y&&(this.y=T),C<this.z&&(this.z=C),this}maximizeInPlaceFromFloats(v,T,C){return v>this.x&&(this.x=v),T>this.y&&(this.y=T),C>this.z&&(this.z=C),this}floor(){return new Xt(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fract(){return new Xt(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(v){return 0===v||1===v?this:this.scaleInPlace(1/v)}normalizeToNew(){const v=new Xt(0,0,0);return this.normalizeToRef(v),v}normalizeToRef(v){const T=this.length();return 0===T||1===T?v.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/T,v)}clone(){return new Xt(this.x,this.y,this.z)}copyFrom(v){return this.copyFromFloats(v.x,v.y,v.z)}copyFromFloats(v,T,C){return this.x=v,this.y=T,this.z=C,this}set(v,T,C){return this.copyFromFloats(v,T,C)}setAll(v){return this.x=this.y=this.z=v,this}}zt.Vector3=Xt,Object.defineProperty(It,"__esModule",{value:!0}),It.MathTmp=void 0;const ie=Pt,oe=zt,se=Ot,ae=Nt;It.MathTmp={Vector3:(0,ie.buildArray)(6,oe.Vector3.Zero),Matrix:(0,ie.buildArray)(2,ae.Matrix.Identity),Quaternion:(0,ie.buildArray)(3,se.Quaternion.Zero),staticUp:oe.Vector3.Up(),tmpMatrix:ae.Matrix.Zero()};var he={};Object.defineProperty(he,"__esModule",{value:!0}),he.Angle=void 0;class te{constructor(v){this._radians=v,this._radians<0&&(this._radians+=2*Math.PI)}static BetweenTwoPoints(v,T){const C=T.subtract(v),S=Math.atan2(C.y,C.x);return new te(S)}static FromRadians(v){return new te(v)}static FromDegrees(v){return new te(v*Math.PI/180)}degrees(){return 180*this._radians/Math.PI}radians(){return this._radians}}he.Angle=te;var le={},ce={};Object.defineProperty(ce,"__esModule",{value:!0}),ce.Vector2=void 0;const ue=Rt,de=Lt;class re{constructor(v=0,T=0){this.x=v,this.y=T}static Zero(){return new re(0,0)}static One(){return new re(1,1)}static Add(v,T){return new re(v.x,v.y).addInPlace(T)}static FromArray(v,T=0){return new re(v[T],v[T+1])}static FromArrayToRef(v,T,C){C.x=v[T],C.y=v[T+1]}static CatmullRom(v,T,C,S,A){const E=A*A,R=A*E,z=.5*(2*T.x+(-v.x+C.x)*A+(2*v.x-5*T.x+4*C.x-S.x)*E+(-v.x+3*T.x-3*C.x+S.x)*R),O=.5*(2*T.y+(-v.y+C.y)*A+(2*v.y-5*T.y+4*C.y-S.y)*E+(-v.y+3*T.y-3*C.y+S.y)*R);return new re(z,O)}static Clamp(v,T,C){let S=v.x;S=S>C.x?C.x:S,S=S<T.x?T.x:S;let A=v.y;return A=A>C.y?C.y:A,A=A<T.y?T.y:A,new re(S,A)}static Hermite(v,T,C,S,A){const E=A*A,R=A*E,z=2*R-3*E+1,O=-2*R+3*E,M=R-2*E+A,B=R-E,V=v.x*z+C.x*O+T.x*M+S.x*B,q=v.y*z+C.y*O+T.y*M+S.y*B;return new re(V,q)}static Lerp(v,T,C){const S=v.x+(T.x-v.x)*C,A=v.y+(T.y-v.y)*C;return new re(S,A)}static Dot(v,T){return v.x*T.x+v.y*T.y}static Normalize(v){const T=new re(v.x,v.y);return T.normalize(),T}static Minimize(v,T){const C=v.x<T.x?v.x:T.x,S=v.y<T.y?v.y:T.y;return new re(C,S)}static Maximize(v,T){const C=v.x>T.x?v.x:T.x,S=v.y>T.y?v.y:T.y;return new re(C,S)}static Transform(v,T){const C=re.Zero();return re.TransformToRef(v,T,C),C}static TransformToRef(v,T,C){const S=T.m,A=v.x*S[0]+v.y*S[4]+S[12],E=v.x*S[1]+v.y*S[5]+S[13];C.x=A,C.y=E}static PointInTriangle(v,T,C,S){const A=.5*(-C.y*S.x+T.y*(-C.x+S.x)+T.x*(C.y-S.y)+C.x*S.y),E=A<0?-1:1,R=(T.y*S.x-T.x*S.y+(S.y-T.y)*v.x+(T.x-S.x)*v.y)*E,z=(T.x*C.y-T.y*C.x+(T.y-C.y)*v.x+(C.x-T.x)*v.y)*E;return R>0&&z>0&&R+z<2*A*E}static Distance(v,T){return Math.sqrt(re.DistanceSquared(v,T))}static DistanceSquared(v,T){const C=v.x-T.x,S=v.y-T.y;return C*C+S*S}static Center(v,T){const C=re.Add(v,T);return C.scaleInPlace(.5),C}static DistanceOfPointFromSegment(v,T,C){const S=re.DistanceSquared(T,C);if(0===S)return re.Distance(v,T);const A=C.subtract(T),E=Math.max(0,Math.min(1,re.Dot(v.subtract(T),A)/S)),R=T.add(A.multiplyByFloats(E,E));return re.Distance(v,R)}toString(){return"{X: "+this.x+" Y:"+this.y+"}"}getClassName(){return"Vector2"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v}toArray(v,T=0){return v[T]=this.x,v[T+1]=this.y,this}asArray(){const v=new Array;return this.toArray(v,0),v}copyFrom(v){return this.x=v.x,this.y=v.y,this}copyFromFloats(v,T){return this.x=v,this.y=T,this}set(v,T){return this.copyFromFloats(v,T)}add(v){return new re(this.x+v.x,this.y+v.y)}addToRef(v,T){return T.x=this.x+v.x,T.y=this.y+v.y,this}addInPlace(v){return this.x+=v.x,this.y+=v.y,this}addVector3(v){return new re(this.x+v.x,this.y+v.y)}subtract(v){return new re(this.x-v.x,this.y-v.y)}subtractToRef(v,T){return T.x=this.x-v.x,T.y=this.y-v.y,this}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this}multiply(v){return new re(this.x*v.x,this.y*v.y)}multiplyToRef(v,T){return T.x=this.x*v.x,T.y=this.y*v.y,this}multiplyByFloats(v,T){return new re(this.x*v,this.y*T)}divide(v){return new re(this.x/v.x,this.y/v.y)}divideToRef(v,T){return T.x=this.x/v.x,T.y=this.y/v.y,this}divideInPlace(v){return this.divideToRef(v,this)}negate(){return new re(-this.x,-this.y)}scaleInPlace(v){return this.x*=v,this.y*=v,this}scale(v){const T=new re(0,0);return this.scaleToRef(v,T),T}scaleToRef(v,T){return T.x=this.x*v,T.y=this.y*v,this}scaleAndAddToRef(v,T){return T.x+=this.x*v,T.y+=this.y*v,this}equals(v){return v&&this.x===v.x&&this.y===v.y}equalsWithEpsilon(v,T=ue.Epsilon){return v&&de.Scalar.WithinEpsilon(this.x,v.x,T)&&de.Scalar.WithinEpsilon(this.y,v.y,T)}floor(){return new re(Math.floor(this.x),Math.floor(this.y))}fract(){return new re(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){const v=this.length();if(0===v)return this;const T=1/v;return this.x*=T,this.y*=T,this}clone(){return new re(this.x,this.y)}}ce.Vector2=re,Object.defineProperty(le,"__esModule",{value:!0}),le.Arc2=void 0;const fe=he,ye=ce,me=Rt;le.Arc2=class{constructor(v,T,C){this.startPoint=v,this.midPoint=T,this.endPoint=C;const S=Math.pow(T.x,2)+Math.pow(T.y,2),A=(Math.pow(v.x,2)+Math.pow(v.y,2)-S)/2,E=(S-Math.pow(C.x,2)-Math.pow(C.y,2))/2,R=(v.x-T.x)*(T.y-C.y)-(T.x-C.x)*(v.y-T.y);this.centerPoint=new ye.Vector2((A*(T.y-C.y)-E*(v.y-T.y))/R,((v.x-T.x)*E-(T.x-C.x)*A)/R),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=fe.Angle.BetweenTwoPoints(this.centerPoint,this.startPoint);const z=this.startAngle.degrees();let O=fe.Angle.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),M=fe.Angle.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();O-z>180&&(O-=360),O-z<-180&&(O+=360),M-O>180&&(M-=360),M-O<-180&&(M+=360),this.orientation=O-z<0?me.Orientation.CW:me.Orientation.CCW,this.angle=fe.Angle.FromDegrees(this.orientation===me.Orientation.CW?z-M:M-z)}};var ve={};Object.defineProperty(ve,"__esModule",{value:!0}),ve.Axis=void 0;const we=zt;class pe{}ve.Axis=pe,pe.X=new we.Vector3(1,0,0),pe.Y=new we.Vector3(0,1,0),pe.Z=new we.Vector3(0,0,1);var be={};Object.defineProperty(be,"__esModule",{value:!0}),be.BezierCurve=void 0,be.BezierCurve=class{static Interpolate(v,T,C,S,A){const E=1-3*S+3*T,R=3*S-6*T,z=3*T;let O=v;for(let T=0;T<5;T++){const T=O*O;O-=1/(3*E*T+2*R*O+z)*(E*(T*O)+R*T+z*O-v),O=Math.min(1,Math.max(0,O))}return 3*Math.pow(1-O,2)*O*C+3*(1-O)*Math.pow(O,2)*A+Math.pow(O,3)}};var Te={},Ce={};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.Color4=void 0;const Se=Lt,_e=Rt;class ge{constructor(v=0,T=0,C=0,S=1){this.r=v,this.g=T,this.b=C,this.a=S}static FromHexString(v){if("#"!==v.substring(0,1)||9!==v.length)return new ge(0,0,0,0);const T=parseInt(v.substring(1,3),16),C=parseInt(v.substring(3,5),16),S=parseInt(v.substring(5,7),16),A=parseInt(v.substring(7,9),16);return ge.FromInts(T,C,S,A)}static Lerp(v,T,C){const S=new ge(0,0,0,0);return ge.LerpToRef(v,T,C,S),S}static LerpToRef(v,T,C,S){S.r=v.r+(T.r-v.r)*C,S.g=v.g+(T.g-v.g)*C,S.b=v.b+(T.b-v.b)*C,S.a=v.a+(T.a-v.a)*C}static Red(){return new ge(1,0,0,1)}static Green(){return new ge(0,1,0,1)}static Blue(){return new ge(0,0,1,1)}static Black(){return new ge(0,0,0,1)}static White(){return new ge(1,1,1,1)}static Purple(){return new ge(.5,0,.5,1)}static Magenta(){return new ge(1,0,1,1)}static Yellow(){return new ge(1,1,0,1)}static Gray(){return new ge(.5,.5,.5,1)}static Teal(){return new ge(0,1,1,1)}static Clear(){return new ge(0,0,0,0)}static FromColor3(v,T=1){return new ge(v.r,v.g,v.b,T)}static FromArray(v,T=0){return new ge(v[T],v[T+1],v[T+2],v[T+3])}static FromInts(v,T,C,S){return new ge(v/255,T/255,C/255,S/255)}static CheckColors4(v,T){if(v.length===3*T){const T=[];for(let C=0;C<v.length;C+=3){const S=C/3*4;T[S]=v[C],T[S+1]=v[C+1],T[S+2]=v[C+2],T[S+3]=1}return T}return v}addInPlace(v){return this.r+=v.r,this.g+=v.g,this.b+=v.b,this.a+=v.a,this}asArray(){const v=new Array;return this.toArray(v,0),v}toArray(v,T=0){return v[T]=this.r,v[T+1]=this.g,v[T+2]=this.b,v[T+3]=this.a,this}add(v){return new ge(this.r+v.r,this.g+v.g,this.b+v.b,this.a+v.a)}subtract(v){return new ge(this.r-v.r,this.g-v.g,this.b-v.b,this.a-v.a)}subtractToRef(v,T){return T.r=this.r-v.r,T.g=this.g-v.g,T.b=this.b-v.b,T.a=this.a-v.a,this}scale(v){return new ge(this.r*v,this.g*v,this.b*v,this.a*v)}scaleToRef(v,T){return T.r=this.r*v,T.g=this.g*v,T.b=this.b*v,T.a=this.a*v,this}scaleAndAddToRef(v,T){return T.r+=this.r*v,T.g+=this.g*v,T.b+=this.b*v,T.a+=this.a*v,this}clampToRef(v=0,T=1,C){return C.r=Se.Scalar.Clamp(this.r,v,T),C.g=Se.Scalar.Clamp(this.g,v,T),C.b=Se.Scalar.Clamp(this.b,v,T),C.a=Se.Scalar.Clamp(this.a,v,T),this}multiply(v){return new ge(this.r*v.r,this.g*v.g,this.b*v.b,this.a*v.a)}multiplyToRef(v,T){return T.r=this.r*v.r,T.g=this.g*v.g,T.b=this.b*v.b,T.a=this.a*v.a,T}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let v=this.r||0;return v=397*v^(this.g||0),v=397*v^(this.b||0),v=397*v^(this.a||0),v}clone(){return new ge(this.r,this.g,this.b,this.a)}copyFrom(v){return this.r=v.r,this.g=v.g,this.b=v.b,this.a=v.a,this}copyFromFloats(v,T,C,S){return this.r=v,this.g=T,this.b=C,this.a=S,this}set(v,T,C,S){return this.copyFromFloats(v,T,C,S)}toHexString(){const v=255*this.r|0,T=255*this.g|0,C=255*this.b|0,S=255*this.a|0;return"#"+Se.Scalar.ToHex(v)+Se.Scalar.ToHex(T)+Se.Scalar.ToHex(C)+Se.Scalar.ToHex(S)}toLinearSpace(){const v=new ge;return this.toLinearSpaceToRef(v),v}toLinearSpaceToRef(v){return v.r=Math.pow(this.r,_e.ToLinearSpace),v.g=Math.pow(this.g,_e.ToLinearSpace),v.b=Math.pow(this.b,_e.ToLinearSpace),v.a=this.a,this}toGammaSpace(){const v=new ge;return this.toGammaSpaceToRef(v),v}toGammaSpaceToRef(v){return v.r=Math.pow(this.r,_e.ToGammaSpace),v.g=Math.pow(this.g,_e.ToGammaSpace),v.b=Math.pow(this.b,_e.ToGammaSpace),v.a=this.a,this}}Ce.Color4=ge,Object.defineProperty(Te,"__esModule",{value:!0}),Te.Color3=void 0;const Ee=Rt,Re=Ce,Ie=Lt;class xe{constructor(v=0,T=0,C=0){this.r=v,this.g=T,this.b=C}static FromHexString(v){if("#"!==v.substring(0,1)||7!==v.length)return new xe(0,0,0);const T=parseInt(v.substring(1,3),16),C=parseInt(v.substring(3,5),16),S=parseInt(v.substring(5,7),16);return xe.FromInts(T,C,S)}static FromArray(v,T=0){return new xe(v[T],v[T+1],v[T+2])}static FromInts(v,T,C){return new xe(v/255,T/255,C/255)}static Lerp(v,T,C){const S=new xe(0,0,0);return xe.LerpToRef(v,T,C,S),S}static LerpToRef(v,T,C,S){S.r=v.r+(T.r-v.r)*C,S.g=v.g+(T.g-v.g)*C,S.b=v.b+(T.b-v.b)*C}static Red(){return new xe(1,0,0)}static Green(){return new xe(0,1,0)}static Blue(){return new xe(0,0,1)}static Black(){return new xe(0,0,0)}static White(){return new xe(1,1,1)}static Purple(){return new xe(.5,0,.5)}static Magenta(){return new xe(1,0,1)}static Yellow(){return new xe(1,1,0)}static Gray(){return new xe(.5,.5,.5)}static Teal(){return new xe(0,1,1)}static Random(){return new xe(Math.random(),Math.random(),Math.random())}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let v=this.r||0;return v=397*v^(this.g||0),v=397*v^(this.b||0),v}toArray(v,T=0){return v[T]=this.r,v[T+1]=this.g,v[T+2]=this.b,this}toColor4(v=1){return new Re.Color4(this.r,this.g,this.b,v)}asArray(){const v=new Array;return this.toArray(v,0),v}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(v){return new xe(this.r*v.r,this.g*v.g,this.b*v.b)}multiplyToRef(v,T){return T.r=this.r*v.r,T.g=this.g*v.g,T.b=this.b*v.b,this}equals(v){return v&&this.r===v.r&&this.g===v.g&&this.b===v.b}equalsFloats(v,T,C){return this.r===v&&this.g===T&&this.b===C}scale(v){return new xe(this.r*v,this.g*v,this.b*v)}scaleToRef(v,T){return T.r=this.r*v,T.g=this.g*v,T.b=this.b*v,this}scaleAndAddToRef(v,T){return T.r+=this.r*v,T.g+=this.g*v,T.b+=this.b*v,this}clampToRef(v=0,T=1,C){return C.r=Ie.Scalar.Clamp(this.r,v,T),C.g=Ie.Scalar.Clamp(this.g,v,T),C.b=Ie.Scalar.Clamp(this.b,v,T),this}add(v){return new xe(this.r+v.r,this.g+v.g,this.b+v.b)}addToRef(v,T){return T.r=this.r+v.r,T.g=this.g+v.g,T.b=this.b+v.b,this}subtract(v){return new xe(this.r-v.r,this.g-v.g,this.b-v.b)}subtractToRef(v,T){return T.r=this.r-v.r,T.g=this.g-v.g,T.b=this.b-v.b,this}clone(){return new xe(this.r,this.g,this.b)}copyFrom(v){return this.r=v.r,this.g=v.g,this.b=v.b,this}copyFromFloats(v,T,C){return this.r=v,this.g=T,this.b=C,this}set(v,T,C){return this.copyFromFloats(v,T,C)}toHexString(){const v=255*this.r|0,T=255*this.g|0,C=255*this.b|0;return"#"+Ie.Scalar.ToHex(v)+Ie.Scalar.ToHex(T)+Ie.Scalar.ToHex(C)}toLinearSpace(){const v=new xe;return this.toLinearSpaceToRef(v),v}toLinearSpaceToRef(v){return v.r=Math.pow(this.r,Ee.ToLinearSpace),v.g=Math.pow(this.g,Ee.ToLinearSpace),v.b=Math.pow(this.b,Ee.ToLinearSpace),this}toGammaSpace(){const v=new xe;return this.toGammaSpaceToRef(v),v}toGammaSpaceToRef(v){return v.r=Math.pow(this.r,Ee.ToGammaSpace),v.g=Math.pow(this.g,Ee.ToGammaSpace),v.b=Math.pow(this.b,Ee.ToGammaSpace),this}toJSON(){return{r:this.r,g:this.g,b:this.b}}}Te.Color3=xe;var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.Curve3=void 0;const Oe=zt;class Ae{constructor(v){this._length=0,this._points=v,this._length=this._computeLength(v)}static CreateQuadraticBezier(v,T,C,S){S=S>2?S:3;const A=new Array,r=(v,T,C,S)=>(1-v)*(1-v)*T+2*v*(1-v)*C+v*v*S;for(let E=0;E<=S;E++)A.push(new Oe.Vector3(r(E/S,v.x,T.x,C.x),r(E/S,v.y,T.y,C.y),r(E/S,v.z,T.z,C.z)));return new Ae(A)}static CreateCubicBezier(v,T,C,S,A){A=A>3?A:4;const E=new Array,s=(v,T,C,S,A)=>(1-v)*(1-v)*(1-v)*T+3*v*(1-v)*(1-v)*C+3*v*v*(1-v)*S+v*v*v*A;for(let R=0;R<=A;R++)E.push(new Oe.Vector3(s(R/A,v.x,T.x,C.x,S.x),s(R/A,v.y,T.y,C.y,S.y),s(R/A,v.z,T.z,C.z,S.z)));return new Ae(E)}static CreateHermiteSpline(v,T,C,S,A){const E=new Array,R=1/A;for(let z=0;z<=A;z++)E.push(Oe.Vector3.Hermite(v,T,C,S,z*R));return new Ae(E)}static CreateCatmullRomSpline(v,T,C){const S=new Array,A=1/T;let E=0;if(C){const C=v.length;for(let R=0;R<C;R++){E=0;for(let z=0;z<T;z++)S.push(Oe.Vector3.CatmullRom(v[R%C],v[(R+1)%C],v[(R+2)%C],v[(R+3)%C],E)),E+=A}S.push(S[0])}else{const C=new Array;C.push(v[0].clone()),Array.prototype.push.apply(C,v),C.push(v[v.length-1].clone());let R=0;for(R=0;R<C.length-3;R++){E=0;for(let v=0;v<T;v++)S.push(Oe.Vector3.CatmullRom(C[R],C[R+1],C[R+2],C[R+3],E)),E+=A}R--,S.push(Oe.Vector3.CatmullRom(C[R],C[R+1],C[R+2],C[R+3],E))}return new Ae(S)}getPoints(){return this._points}length(){return this._length}continue(v){const T=this._points[this._points.length-1],C=this._points.slice(),S=v.getPoints();for(let v=1;v<S.length;v++)C.push(S[v].subtract(S[0]).add(T));return new Ae(C)}_computeLength(v){let T=0;for(let C=1;C<v.length;C++)T+=v[C].subtract(v[C-1]).length();return T}}Pe.Curve3=Ae;var Ne={},Be={};Object.defineProperty(Be,"__esModule",{value:!0}),Be.Plane=void 0;const Le=zt,Fe=Nt,ke=It;class ze{constructor(v,T,C,S){this.normal=new Le.Vector3(v,T,C),this.d=S}static FromArray(v){return new ze(v[0],v[1],v[2],v[3])}static FromPoints(v,T,C){const S=new ze(0,0,0,0);return S.copyFromPoints(v,T,C),S}static FromPositionAndNormal(v,T){const C=new ze(0,0,0,0);return T.normalize(),C.normal=T,C.d=-(T.x*v.x+T.y*v.y+T.z*v.z),C}static SignedDistanceToPlaneFromPositionAndNormal(v,T,C){const S=-(T.x*v.x+T.y*v.y+T.z*v.z);return Le.Vector3.Dot(C,T)+S}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new ze(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let v=this.normal.getHashCode();return v=397*v^(this.d||0),v}normalize(){const v=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let T=0;return 0!==v&&(T=1/v),this.normal.x*=T,this.normal.y*=T,this.normal.z*=T,this.d*=T,this}transform(v){const T=ke.MathTmp.Matrix[0];Fe.Matrix.TransposeToRef(v,T);const C=T.m,S=this.normal.x,A=this.normal.y,E=this.normal.z,R=this.d,z=S*C[0]+A*C[1]+E*C[2]+R*C[3],O=S*C[4]+A*C[5]+E*C[6]+R*C[7],M=S*C[8]+A*C[9]+E*C[10]+R*C[11],B=S*C[12]+A*C[13]+E*C[14]+R*C[15];return new ze(z,O,M,B)}dotCoordinate(v){return this.normal.x*v.x+this.normal.y*v.y+this.normal.z*v.z+this.d}copyFromPoints(v,T,C){const S=T.x-v.x,A=T.y-v.y,E=T.z-v.z,R=C.x-v.x,z=C.y-v.y,O=C.z-v.z,M=A*O-E*z,B=E*R-S*O,V=S*z-A*R,q=Math.sqrt(M*M+B*B+V*V);let j;return j=0!==q?1/q:0,this.normal.x=M*j,this.normal.y=B*j,this.normal.z=V*j,this.d=-(this.normal.x*v.x+this.normal.y*v.y+this.normal.z*v.z),this}isFrontFacingTo(v,T){return Le.Vector3.Dot(this.normal,v)<=T}signedDistanceTo(v){return Le.Vector3.Dot(v,this.normal)+this.d}}Be.Plane=ze,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.Frustum=void 0;const Ue=Be;class Me{static GetPlanes(v){const T=[];for(let v=0;v<6;v++)T.push(new Ue.Plane(0,0,0,0));return Me.GetPlanesToRef(v,T),T}static GetNearPlaneToRef(v,T){const C=v.m;T.normal.x=C[3]+C[2],T.normal.y=C[7]+C[6],T.normal.z=C[11]+C[10],T.d=C[15]+C[14],T.normalize()}static GetFarPlaneToRef(v,T){const C=v.m;T.normal.x=C[3]-C[2],T.normal.y=C[7]-C[6],T.normal.z=C[11]-C[10],T.d=C[15]-C[14],T.normalize()}static GetLeftPlaneToRef(v,T){const C=v.m;T.normal.x=C[3]+C[0],T.normal.y=C[7]+C[4],T.normal.z=C[11]+C[8],T.d=C[15]+C[12],T.normalize()}static GetRightPlaneToRef(v,T){const C=v.m;T.normal.x=C[3]-C[0],T.normal.y=C[7]-C[4],T.normal.z=C[11]-C[8],T.d=C[15]-C[12],T.normalize()}static GetTopPlaneToRef(v,T){const C=v.m;T.normal.x=C[3]-C[1],T.normal.y=C[7]-C[5],T.normal.z=C[11]-C[9],T.d=C[15]-C[13],T.normalize()}static GetBottomPlaneToRef(v,T){const C=v.m;T.normal.x=C[3]+C[1],T.normal.y=C[7]+C[5],T.normal.z=C[11]+C[9],T.d=C[15]+C[13],T.normalize()}static GetPlanesToRef(v,T){Me.GetNearPlaneToRef(v,T[0]),Me.GetFarPlaneToRef(v,T[1]),Me.GetLeftPlaneToRef(v,T[2]),Me.GetRightPlaneToRef(v,T[3]),Me.GetTopPlaneToRef(v,T[4]),Me.GetBottomPlaneToRef(v,T[5])}}Ne.Frustum=Me;var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.Path2=void 0;const qe=ce,He=le,We=Rt;class De{constructor(v,T){this.closed=!1,this._points=new Array,this._length=0,this._points.push(new qe.Vector2(v,T))}static StartingAt(v,T){return new De(v,T)}addLineTo(v,T){if(this.closed)return this;const C=new qe.Vector2(v,T),S=this._points[this._points.length-1];return this._points.push(C),this._length+=C.subtract(S).length(),this}addArcTo(v,T,C,S,A=36){if(this.closed)return this;const E=this._points[this._points.length-1],R=new qe.Vector2(v,T),z=new qe.Vector2(C,S),O=new He.Arc2(E,R,z);let M=O.angle.radians()/A;O.orientation===We.Orientation.CW&&(M*=-1);let B=O.startAngle.radians()+M;for(let v=0;v<A;v++){const v=Math.cos(B)*O.radius+O.centerPoint.x,T=Math.sin(B)*O.radius+O.centerPoint.y;this.addLineTo(v,T),B+=M}return this}close(){return this.closed=!0,this}length(){let v=this._length;if(!this.closed){const T=this._points[this._points.length-1];v+=this._points[0].subtract(T).length()}return v}getPoints(){return this._points}getPointAtLengthPosition(v){if(v<0||v>1)return qe.Vector2.Zero();const T=v*this.length();let C=0;for(let v=0;v<this._points.length;v++){const S=(v+1)%this._points.length,A=this._points[v],E=this._points[S].subtract(A),R=E.length()+C;if(T>=C&&T<=R){const v=E.normalize(),S=T-C;return new qe.Vector2(A.x+v.x*S,A.y+v.y*S)}C=R}return qe.Vector2.Zero()}}Ve.Path2=De;var Ge={};Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.Path3D=void 0;const Xe=zt,Ye=Rt,Qe=Lt;Ge.Path3D=class{constructor(v,T=null,C){this.path=v,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(let T=0;T<v.length;T++)this._curve[T]=v[T].clone();this._raw=C||!1,this._compute(T)}getCurve(){return this._curve}getTangents(){return this._tangents}getNormals(){return this._normals}getBinormals(){return this._binormals}getDistances(){return this._distances}update(v,T=null){for(let T=0;T<v.length;T++)this._curve[T].x=v[T].x,this._curve[T].y=v[T].y,this._curve[T].z=v[T].z;return this._compute(T),this}_compute(v){const T=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[T-1]=this._curve[T-1].subtract(this._curve[T-2]),this._raw||this._tangents[T-1].normalize();const C=this._tangents[0],S=this._normalVector(this._curve[0],C,v);let A,E,R,z;this._normals[0]=S,this._raw||this._normals[0].normalize(),this._binormals[0]=Xe.Vector3.Cross(C,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(let v=1;v<T;v++)A=this._getLastNonNullVector(v),v<T-1&&(E=this._getFirstNonNullVector(v),this._tangents[v]=A.add(E),this._tangents[v].normalize()),this._distances[v]=this._distances[v-1]+A.length(),R=this._tangents[v],z=this._binormals[v-1],this._normals[v]=Xe.Vector3.Cross(z,R),this._raw||this._normals[v].normalize(),this._binormals[v]=Xe.Vector3.Cross(R,this._normals[v]),this._raw||this._binormals[v].normalize()}_getFirstNonNullVector(v){let T=1,C=this._curve[v+T].subtract(this._curve[v]);for(;0===C.length()&&v+T+1<this._curve.length;)T++,C=this._curve[v+T].subtract(this._curve[v]);return C}_getLastNonNullVector(v){let T=1,C=this._curve[v].subtract(this._curve[v-T]);for(;0===C.length()&&v>T+1;)T++,C=this._curve[v].subtract(this._curve[v-T]);return C}_normalVector(v,T,C){let S,A=T.length();if(0===A&&(A=1),null==C){let v;v=Qe.Scalar.WithinEpsilon(Math.abs(T.y)/A,1,Ye.Epsilon)?Qe.Scalar.WithinEpsilon(Math.abs(T.x)/A,1,Ye.Epsilon)?Qe.Scalar.WithinEpsilon(Math.abs(T.z)/A,1,Ye.Epsilon)?Xe.Vector3.Zero():new Xe.Vector3(0,0,1):new Xe.Vector3(1,0,0):new Xe.Vector3(0,-1,0),S=Xe.Vector3.Cross(T,v)}else S=Xe.Vector3.Cross(T,C),Xe.Vector3.CrossToRef(S,T,S);return S.normalize(),S}};var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.Size=void 0;class je{constructor(v,T){this.width=v,this.height=T}get surface(){return this.width*this.height}static Zero(){return new je(0,0)}static Lerp(v,T,C){const S=v.width+(T.width-v.width)*C,A=v.height+(T.height-v.height)*C;return new je(S,A)}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let v=this.width||0;return v=397*v^(this.height||0),v}copyFrom(v){this.width=v.width,this.height=v.height}copyFromFloats(v,T){return this.width=v,this.height=T,this}set(v,T){return this.copyFromFloats(v,T)}multiplyByFloats(v,T){return new je(this.width*v,this.height*T)}clone(){return new je(this.width,this.height)}equals(v){return!!v&&this.width===v.width&&this.height===v.height}add(v){return new je(this.width+v.width,this.height+v.height)}subtract(v){return new je(this.width-v.width,this.height-v.height)}}Ze.Size=je,function(v){var T=_t&&_t.__createBinding||(Object.create?function(v,T,C,S){void 0===S&&(S=C),Object.defineProperty(v,S,{enumerable:!0,get:function(){return T[C]}})}:function(v,T,C,S){void 0===S&&(S=C),v[S]=T[C]}),C=_t&&_t.__exportStar||function(v,C){for(var S in v)"default"===S||Object.prototype.hasOwnProperty.call(C,S)||T(C,v,S)};Object.defineProperty(v,"__esModule",{value:!0}),C(Rt,v),C(It,v),C(he,v),C(le,v),C(ve,v),C(be,v),C(Te,v),C(Ce,v),C(Pe,v),C(Ne,v),C(Nt,v),C(Ve,v),C(Ge,v),C(Be,v),C(Ot,v),C(Lt,v),C(Ze,v),C(ce,v),C(zt,v),C(Bt,v),C(At,v)}(At);var Je,$e,tn,nn,on={looping:!0,speed:1,weight:1,layer:0},rn=function(v){function e(T,C){void 0===C&&(C=on);var S=v.call(this)||this;return S.isAnimationClip=!0,S.looping=on.looping,S.weight=on.weight,S.playing=!1,S.shouldReset=!1,S.speed=on.speed,S.name=f("AnimClip"),S.layer=on.layer,S.clip=T,S.setParams(o({},C)),S}return i(e,v),e.prototype.setParams=function(v){return this.looping=void 0!==v.looping?v.looping:this.looping,this.speed=v.speed||this.speed,this.weight=v.weight||this.weight,this.layer=v.layer||this.layer,this},e.prototype.toJSON=function(){var T=JSON.parse(JSON.stringify(v.prototype.toJSON.call(this)));return this.shouldReset&&(this.shouldReset=!1),T},e.prototype.play=function(v){var T;void 0===v&&(v=!1),null===(T=this.owner)||void 0===T||T.play(this,v)},e.prototype.pause=function(){var v;null===(v=this.owner)||void 0===v||v.pause(this)},e.prototype.reset=function(){this.shouldReset=!0},e.prototype.stop=function(){var v;null===(v=this.owner)||void 0===v||v.stop(this)},r([X.readonly,s("design:type",String)],e.prototype,"clip",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"looping",void 0),r([X.field,s("design:type",Number)],e.prototype,"weight",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"playing",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"shouldReset",void 0),r([X.field,s("design:type",Number)],e.prototype,"speed",void 0),r([X.readonly,s("design:type",String)],e.prototype,"name",void 0),e}(X);v.InputEventType=void 0,(Je=v.InputEventType||(v.InputEventType={}))[Je.DOWN=0]="DOWN",Je[Je.UP=1]="UP",v.CameraMode=void 0,($e=v.CameraMode||(v.CameraMode={}))[$e.FirstPerson=0]="FirstPerson",$e[$e.ThirdPerson=1]="ThirdPerson",$e[$e.BuildingToolGodMode=2]="BuildingToolGodMode",v.LandRole=void 0,(tn=v.LandRole||(v.LandRole={})).OWNER="owner",tn.OPERATOR="operator",v.ActionButton=void 0,(nn=v.ActionButton||(v.ActionButton={})).POINTER="POINTER",nn.PRIMARY="PRIMARY",nn.SECONDARY="SECONDARY",nn.ANY="ANY",nn.FORWARD="FORWARD",nn.BACKWARD="BACKWARD",nn.RIGHT="RIGHT",nn.LEFT="LEFT",nn.JUMP="JUMP",nn.WALK="WALK",nn.ACTION_3="ACTION_3",nn.ACTION_4="ACTION_4",nn.ACTION_5="ACTION_5",nn.ACTION_6="ACTION_6";var sn,an,Ke=function(v){if(this.callback=v,!v||!("apply"in v)||!("call"in v))throw new Error("Callback is not a function");cn.ensureInstance()},hn=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return i(e,v),r([P("pointerDown")],e)}(Ke),ln=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return i(e,v),r([P("pointerUp")],e)}(Ke),en=function(v,T){this.fn=v,this.useRaycast=T},cn=function(){function e(){this.buttonIdMapping=[v.ActionButton.POINTER,v.ActionButton.PRIMARY,v.ActionButton.SECONDARY,v.ActionButton.ANY,v.ActionButton.FORWARD,v.ActionButton.BACKWARD,v.ActionButton.RIGHT,v.ActionButton.LEFT,v.ActionButton.JUMP,v.ActionButton.WALK,v.ActionButton.ACTION_3,v.ActionButton.ACTION_4,v.ActionButton.ACTION_5,v.ActionButton.ACTION_6],this.subscriptions=this.buttonIdMapping.reduce((function(v,T){var C;return o(o({},v),((C={})[T]={BUTTON_DOWN:[],BUTTON_UP:[]},C))}),{}),this.internalState=this.buttonIdMapping.reduce((function(v,T){var C;return o(o({},v),((C={})[T]={BUTTON_DOWN:!1},C))}),{})}return Object.defineProperty(e,"instance",{get:function(){return e.ensureInstance(),e._instance},enumerable:!1,configurable:!0}),e.ensureInstance=function(){e._instance||(e._instance=new e)},e.prototype.isButtonPressed=function(v){return this.internalState[v]},e.prototype.subscribe=function(v,T,C,S){var A=this;return this.subscriptions[T][v].push(new en(S,C)),function(){A.unsubscribe(v,T,S)}},e.prototype.unsubscribe=function(v,T,C){var S=this.getSubscriptionId(v,T,C);return S>-1&&this.subscriptions[T][v].splice(S,1)},e.prototype.handlePointerEvent=function(T){var C=this.getPointerById(T.buttonId);if(C){var S=o(o({},T),{button:C,direction:(new At.Vector3).copyFrom(T.direction),origin:(new At.Vector3).copyFrom(T.origin),hit:void 0}),A=T.hit?o(o({},T.hit),{hitPoint:(new At.Vector3).copyFrom(T.hit.hitPoint),normal:(new At.Vector3).copyFrom(T.hit.normal),worldNormal:(new At.Vector3).copyFrom(T.hit.worldNormal)}):void 0;if(T.type===v.InputEventType.DOWN){this.internalState[C].BUTTON_DOWN=!0;for(var E=0;E<this.subscriptions[C].BUTTON_DOWN.length;E++)(R=this.subscriptions[C].BUTTON_DOWN[E]).useRaycast?S.hit=A:S.hit=void 0,R.fn(S);A&&A.entityId&&N.engine&&(O=(z=N.engine.entities[A.entityId])&&z.getComponentOrNull(hn))&&(S.hit=A,O.callback(S))}else{for(this.internalState[C].BUTTON_DOWN=!1,E=0;E<this.subscriptions[C].BUTTON_UP.length;E++){var R;(R=this.subscriptions[C].BUTTON_UP[E]).useRaycast?S.hit=A:S.hit=void 0,R.fn(S)}var z,O;A&&A.entityId&&N.engine&&(O=(z=N.engine.entities[A.entityId])&&z.getComponentOrNull(ln))&&(S.hit=A,O.callback(S))}}},e.prototype.getSubscriptionId=function(v,T,C){for(var S=0;S<this.subscriptions[T][v].length;S++)if(this.subscriptions[T][v][S].fn===C)return S;return-1},e.prototype.getPointerById=function(T){if(T<0||T>=this.buttonIdMapping.length)return null;var C=this.buttonIdMapping[T];return C===v.ActionButton.ANY?null:C},e}();v.CLASS_ID=void 0,(sn=v.CLASS_ID||(v.CLASS_ID={}))[sn.TRANSFORM=1]="TRANSFORM",sn[sn.UUID_CALLBACK=8]="UUID_CALLBACK",sn[sn.BOX_SHAPE=16]="BOX_SHAPE",sn[sn.SPHERE_SHAPE=17]="SPHERE_SHAPE",sn[sn.PLANE_SHAPE=18]="PLANE_SHAPE",sn[sn.CONE_SHAPE=19]="CONE_SHAPE",sn[sn.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",sn[sn.TEXT_SHAPE=21]="TEXT_SHAPE",sn[sn.NFT_SHAPE=22]="NFT_SHAPE",sn[sn.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",sn[sn.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",sn[sn.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",sn[sn.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",sn[sn.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",sn[sn.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",sn[sn.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",sn[sn.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",sn[sn.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",sn[sn.BILLBOARD=32]="BILLBOARD",sn[sn.ANIMATION=33]="ANIMATION",sn[sn.FONT=34]="FONT",sn[sn.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",sn[sn.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",sn[sn.GLTF_SHAPE=54]="GLTF_SHAPE",sn[sn.OBJ_SHAPE=55]="OBJ_SHAPE",sn[sn.AVATAR_SHAPE=56]="AVATAR_SHAPE",sn[sn.BASIC_MATERIAL=64]="BASIC_MATERIAL",sn[sn.PBR_MATERIAL=65]="PBR_MATERIAL",sn[sn.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",sn[sn.SOUND=67]="SOUND",sn[sn.TEXTURE=68]="TEXTURE",sn[sn.VIDEO_CLIP=70]="VIDEO_CLIP",sn[sn.VIDEO_TEXTURE=71]="VIDEO_TEXTURE",sn[sn.AVATAR_TEXTURE=72]="AVATAR_TEXTURE",sn[sn.AUDIO_CLIP=200]="AUDIO_CLIP",sn[sn.AUDIO_SOURCE=201]="AUDIO_SOURCE",sn[sn.AUDIO_STREAM=202]="AUDIO_STREAM",sn[sn.GIZMOS=203]="GIZMOS",sn[sn.SMART_ITEM=204]="SMART_ITEM",sn[sn.AVATAR_MODIFIER_AREA=205]="AVATAR_MODIFIER_AREA",sn[sn.AVATAR_ATTACH=206]="AVATAR_ATTACH",sn[sn.CAMERA_MODE_AREA=207]="CAMERA_MODE_AREA",sn[sn.NAME=300]="NAME",sn[sn.LOCKED_ON_EDIT=301]="LOCKED_ON_EDIT",sn[sn.VISIBLE_ON_EDIT=302]="VISIBLE_ON_EDIT",v.AvatarModifiers=void 0,(an=v.AvatarModifiers||(v.AvatarModifiers={})).HIDE_AVATARS="HIDE_AVATARS",an.DISABLE_PASSPORTS="DISABLE_PASSPORTS";var un,dn=function(T){function n(v){var C=T.call(this)||this;return C.area=v.area,C.modifiers=v.modifiers,C.excludeIds=v.excludeIds,C}return i(n,T),r([X.field,s("design:type",Object)],n.prototype,"area",void 0),r([X.field,s("design:type",Array)],n.prototype,"modifiers",void 0),r([X.field,s("design:type",Array)],n.prototype,"excludeIds",void 0),r([P("engine.avatarModifierArea",v.CLASS_ID.AVATAR_MODIFIER_AREA),s("design:paramtypes",[Object])],n)}(X),pn=function(T){function n(v){void 0===v&&(v={});var C=T.call(this)||this;return C.position=v.position||At.Vector3.Zero(),C.rotation=v.rotation||At.Quaternion.Identity,C.scale=v.scale||new At.Vector3(1,1,1),C}return i(n,T),Object.defineProperty(n.prototype,"eulerAngles",{get:function(){return this.rotation.eulerAngles},enumerable:!1,configurable:!0}),n.prototype.lookAt=function(v,T){void 0===T&&(T=At.MathTmp.staticUp);var C=new At.Matrix;return At.Matrix.LookAtLHToRef(this.position,v,T,C),C.invert(),At.Quaternion.FromRotationMatrixToRef(C,this.rotation),this},n.prototype.rotate=function(v,T){return this.rotation.multiplyInPlace(this.rotation.angleAxis(T,v)),this},n.prototype.translate=function(v){return this.position.addInPlace(v),this},r([X.field,s("design:type",At.Vector3)],n.prototype,"position",void 0),r([X.field,s("design:type",At.Quaternion)],n.prototype,"rotation",void 0),r([X.field,s("design:type",At.Vector3)],n.prototype,"scale",void 0),r([P("engine.transform",v.CLASS_ID.TRANSFORM),s("design:paramtypes",[Object])],n)}(X);v.AttachToAvatarAnchorPointId=void 0,(un=v.AttachToAvatarAnchorPointId||(v.AttachToAvatarAnchorPointId={}))[un.Position=0]="Position",un[un.NameTag=1]="NameTag",un[un.LeftHand=2]="LeftHand",un[un.RightHand=3]="RightHand";var fn,yn=function(T){function n(C){void 0===C&&(C={});var S=T.call(this)||this;return S.avatarId=C.avatarId||"",S.anchorPointId=C.anchorPointId||v.AttachToAvatarAnchorPointId.Position,S}return i(n,T),r([X.field,s("design:type",String)],n.prototype,"avatarId",void 0),r([X.field,s("design:type",Number)],n.prototype,"anchorPointId",void 0),r([X.field,s("design:type",String)],n.prototype,"avatarSceneId",void 0),r([P("engine.transform",v.CLASS_ID.AVATAR_ATTACH),s("design:paramtypes",[Object])],n)}(X),mn=function(T){function n(v,C,S){void 0===v&&(v=!0),void 0===C&&(C=!0),void 0===S&&(S=!0);var A=T.call(this)||this;return A.x=!0,A.y=!0,A.z=!0,A.x=v,A.y=C,A.z=S,A}return i(n,T),r([X.field,s("design:type",Boolean)],n.prototype,"x",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"y",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"z",void 0),r([P("engine.billboard",v.CLASS_ID.BILLBOARD),s("design:paramtypes",[Boolean,Boolean,Boolean])],n)}(X),gn=function(v){function e(){var T=null!==v&&v.apply(this,arguments)||this;return T.withCollisions=!0,T.isPointerBlocker=!0,T.visible=!0,T}return i(e,v),r([X.field,s("design:type",Boolean)],e.prototype,"withCollisions",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"visible",void 0),e}(X),vn=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return i(n,T),r([X.field,s("design:type",Array)],n.prototype,"uvs",void 0),r([N("engine.shape",v.CLASS_ID.BOX_SHAPE)],n)}(gn),wn=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return i(n,T),r([N("engine.shape",v.CLASS_ID.SPHERE_SHAPE)],n)}(gn),bn=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"segments",void 0),r([X.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CIRCLE_SHAPE)],n)}(gn),Tn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.width=1,v.height=1,v}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"width",void 0),r([X.field,s("design:type",Number)],n.prototype,"height",void 0),r([X.field,s("design:type",Array)],n.prototype,"uvs",void 0),r([N("engine.shape",v.CLASS_ID.PLANE_SHAPE)],n)}(gn),Cn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.radiusTop=0,v.radiusBottom=1,v.segmentsHeight=1,v.segmentsRadial=36,v.openEnded=!1,v.radius=null,v.arc=360,v}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"radiusTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"radiusBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"segmentsHeight",void 0),r([X.field,s("design:type",Number)],n.prototype,"segmentsRadial",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"openEnded",void 0),r([X.field,s("design:type",Object)],n.prototype,"radius",void 0),r([X.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CONE_SHAPE)],n)}(gn),Sn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.radiusTop=1,v.radiusBottom=1,v.segmentsHeight=1,v.segmentsRadial=36,v.openEnded=!1,v.radius=null,v.arc=360,v}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"radiusTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"radiusBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"segmentsHeight",void 0),r([X.field,s("design:type",Number)],n.prototype,"segmentsRadial",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"openEnded",void 0),r([X.field,s("design:type",Object)],n.prototype,"radius",void 0),r([X.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CYLINDER_SHAPE)],n)}(gn),xn=function(T){function n(v){var C=T.call(this)||this;return C.src=v,C}return i(n,T),r([gn.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.shape",v.CLASS_ID.GLTF_SHAPE),s("design:paramtypes",[String])],n)}(gn);v.PictureFrameStyle=void 0,(fn=v.PictureFrameStyle||(v.PictureFrameStyle={}))[fn.Classic=0]="Classic",fn[fn.Baroque_Ornament=1]="Baroque_Ornament",fn[fn.Diamond_Ornament=2]="Diamond_Ornament",fn[fn.Minimal_Wide=3]="Minimal_Wide",fn[fn.Minimal_Grey=4]="Minimal_Grey",fn[fn.Blocky=5]="Blocky",fn[fn.Gold_Edges=6]="Gold_Edges",fn[fn.Gold_Carved=7]="Gold_Carved",fn[fn.Gold_Wide=8]="Gold_Wide",fn[fn.Gold_Rounded=9]="Gold_Rounded",fn[fn.Metal_Medium=10]="Metal_Medium",fn[fn.Metal_Wide=11]="Metal_Wide",fn[fn.Metal_Slim=12]="Metal_Slim",fn[fn.Metal_Rounded=13]="Metal_Rounded",fn[fn.Pins=14]="Pins",fn[fn.Minimal_Black=15]="Minimal_Black",fn[fn.Minimal_White=16]="Minimal_White",fn[fn.Tape=17]="Tape",fn[fn.Wood_Slim=18]="Wood_Slim",fn[fn.Wood_Wide=19]="Wood_Wide",fn[fn.Wood_Twigs=20]="Wood_Twigs",fn[fn.Canvas=21]="Canvas",fn[fn.None=22]="None";var _n,An=function(T){function n(C,S){void 0===S&&(S={});var A=T.call(this)||this;A.src=C;var E=new At.Color3(.6404918,.611472,.8584906),R=v.PictureFrameStyle.Classic;return"r"in S?E=S:null!==S&&(S.color&&(E=S.color),S.style&&(R=S.style)),A.color=E,A.style=R,A}return i(n,T),r([gn.readonly,s("design:type",String)],n.prototype,"src",void 0),r([gn.readonly,s("design:type",Number)],n.prototype,"style",void 0),r([X.field,s("design:type",At.Color3)],n.prototype,"color",void 0),r([N("engine.shape",v.CLASS_ID.NFT_SHAPE),s("design:paramtypes",[String,Object])],n)}(gn),En=function(T){function n(v,C){var S=T.call(this)||this,A=new RegExp("data:[a-z-]+/[a-z-]+;base64");if((v.length>2048||A.test(v))&&c("⚠️🚨 Base64 textures will be deprecated in version 7 of decentraland-ecs"),S.src=v,C)for(var E in C)S[E]=C[E];return S}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"src",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([X.readonly,s("design:type",Boolean)],n.prototype,"hasAlpha",void 0),r([N("engine.texture",v.CLASS_ID.TEXTURE),s("design:paramtypes",[String,Object])],n)}(X),Rn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.states=[],v}return i(n,T),n.prototype.addClip=function(v){var T=this;return this.states.push(v),v.onChange((function(){T.dirty=!0})),v.owner=this,this},n.prototype.getClip=function(v){for(var T=0;T<this.states.length;T++){var C=this.states[T];if(C.clip===v)return C}var S=new rn(v);return this.addClip(S),S},n.prototype.stop=function(v){if(v)v.playing=!1,v.shouldReset=!0;else for(var T=0;T<this.states.length;T++){var C=this.states[T];this.stop(C)}},n.prototype.play=function(v,T){void 0===T&&(T=!1);for(var C=0;C<this.states.length;C++){var S=this.states[C];S.layer===v.layer&&v!==S&&this.pause(S)}T&&(v.shouldReset=!0),v.playing=!0,v.dirty=!0,v.data.nonce=Math.random()},n.prototype.pause=function(v){if(v)v.playing=!1;else for(var T=0;T<this.states.length;T++){var C=this.states[T];this.pause(C)}},r([X.readonly,s("design:type",Array)],n.prototype,"states",void 0),r([P("engine.animator",v.CLASS_ID.ANIMATION)],n)}(gn),In=function(T){function n(v){var C=T.call(this)||this;return C.src=v,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.shape",v.CLASS_ID.OBJ_SHAPE),s("design:paramtypes",[String])],n)}(gn),Pn=function(T){function n(v){void 0===v&&(v="");var C=T.call(this)||this;return C.src=v,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.font",v.CLASS_ID.FONT),s("design:paramtypes",[String])],n)}(X);v.Fonts=void 0,(_n=v.Fonts||(v.Fonts={})).SanFrancisco="builtin:SF-UI-Text-Regular SDF",_n.SanFrancisco_Heavy="builtin:SF-UI-Text-Heavy SDF",_n.SanFrancisco_Semibold="builtin:SF-UI-Text-Semibold SDF",_n.LiberationSans="builtin:LiberationSans SDF",_n.SansSerif="SansSerif",_n.SansSerif_Heavy="SansSerif_Heavy",_n.SansSerif_Bold="SansSerif_Bold",_n.SansSerif_SemiBold="SansSerif_SemiBold";var zn,On=function(T){function n(v){var C=T.call(this)||this;return C.outlineWidth=0,C.outlineColor=new At.Color3(1,1,1),C.color=new At.Color3(1,1,1),C.fontSize=10,C.opacity=1,C.value="",C.lineSpacing="0px",C.lineCount=0,C.textWrapping=!1,C.shadowBlur=0,C.shadowOffsetX=0,C.shadowOffsetY=0,C.shadowColor=new At.Color3(1,1,1),C.hTextAlign="center",C.vTextAlign="center",C.width=1,C.height=1,C.paddingTop=0,C.paddingRight=0,C.paddingBottom=0,C.paddingLeft=0,C.billboard=!1,C.visible=!0,v&&(C.value=v),C}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([X.field,s("design:type",At.Color3)],n.prototype,"outlineColor",void 0),r([X.field,s("design:type",At.Color3)],n.prototype,"color",void 0),r([X.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([X.component,s("design:type",Pn)],n.prototype,"font",void 0),r([X.field,s("design:type",Number)],n.prototype,"opacity",void 0),r([X.field,s("design:type",String)],n.prototype,"value",void 0),r([X.field,s("design:type",String)],n.prototype,"lineSpacing",void 0),r([X.field,s("design:type",Number)],n.prototype,"lineCount",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([X.field,s("design:type",At.Color3)],n.prototype,"shadowColor",void 0),r([X.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([X.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([X.field,s("design:type",Number)],n.prototype,"width",void 0),r([X.field,s("design:type",Number)],n.prototype,"height",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"billboard",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"visible",void 0),r([P("engine.text",v.CLASS_ID.TEXT_SHAPE),s("design:paramtypes",[String])],n)}(X);v.TransparencyMode=void 0,(zn=v.TransparencyMode||(v.TransparencyMode={}))[zn.OPAQUE=0]="OPAQUE",zn[zn.ALPHA_TEST=1]="ALPHA_TEST",zn[zn.ALPHA_BLEND=2]="ALPHA_BLEND",zn[zn.ALPHA_TEST_AND_BLEND=3]="ALPHA_TEST_AND_BLEND",zn[zn.AUTO=4]="AUTO";var Mn,Nn=function(T){function n(){var C=null!==T&&T.apply(this,arguments)||this;return C.alphaTest=.5,C.castShadows=!0,C.transparencyMode=v.TransparencyMode.AUTO,C}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"alphaTest",void 0),r([X.field,s("design:type",Object)],n.prototype,"albedoColor",void 0),r([X.field,s("design:type",At.Color3)],n.prototype,"emissiveColor",void 0),r([X.field,s("design:type",Number)],n.prototype,"metallic",void 0),r([X.field,s("design:type",Number)],n.prototype,"roughness",void 0),r([X.field,s("design:type",At.Color3)],n.prototype,"reflectivityColor",void 0),r([X.field,s("design:type",Number)],n.prototype,"directIntensity",void 0),r([X.field,s("design:type",Number)],n.prototype,"microSurface",void 0),r([X.field,s("design:type",Number)],n.prototype,"emissiveIntensity",void 0),r([X.field,s("design:type",Number)],n.prototype,"specularIntensity",void 0),r([X.component,s("design:type",Object)],n.prototype,"albedoTexture",void 0),r([X.component,s("design:type",Object)],n.prototype,"alphaTexture",void 0),r([X.component,s("design:type",Object)],n.prototype,"emissiveTexture",void 0),r([X.component,s("design:type",Object)],n.prototype,"bumpTexture",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"castShadows",void 0),r([X.field,s("design:type",Number)],n.prototype,"transparencyMode",void 0),r([N("engine.material",v.CLASS_ID.PBR_MATERIAL)],n)}(X),Bn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.alphaTest=.5,v.castShadows=!0,v}return i(n,T),r([X.component,s("design:type",Object)],n.prototype,"texture",void 0),r([X.field,s("design:type",Number)],n.prototype,"alphaTest",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"castShadows",void 0),r([N("engine.material",v.CLASS_ID.BASIC_MATERIAL)],n)}(X),Dn=function(v){function e(T){var C=v.call(this)||this;if(C.uuid=f("UUID"),!T||!("apply"in T)||!("call"in T))throw new Error("Callback is not a function");return C.callback=T,C}return i(e,v),e.uuidEvent=function(v,T){if(delete v[T]){var C=T+"_"+Math.random();v[C]=void 0,Object.defineProperty(v,C,o(o({},Object.getOwnPropertyDescriptor(v,C)),{enumerable:!1})),Object.defineProperty(v,T.toString(),{get:function(){return this[C]},set:function(v){var S=this[C];if(v){if(!(v instanceof e))throw new Error("value is not an OnUUIDEvent");this.data[T]=v.uuid}else this.data[T]=null;if(this[C]=v,v!==S){this.dirty=!0;for(var A=0;A<this.subscriptions.length;A++)this.subscriptions[A](T,v,S)}},enumerable:!0})}},e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type}},r([X.field,s("design:type",Function)],e.prototype,"callback",void 0),e}(X),Ln=function(T){function n(){var C=null!==T&&T.apply(this,arguments)||this;return C.button=v.ActionButton.ANY,C.hoverText="Interact",C.distance=10,C.showFeedback=!0,C}return i(n,T),n.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type,button:this.button,hoverText:this.hoverText,distance:this.distance,showFeedback:this.showFeedback}},r([X.field,s("design:type",String)],n.prototype,"button",void 0),r([X.field,s("design:type",String)],n.prototype,"hoverText",void 0),r([X.field,s("design:type",Number)],n.prototype,"distance",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"showFeedback",void 0),n}(Dn),Fn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.type="onPointerLock",v}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onPointerLock",v.CLASS_ID.UUID_CALLBACK)],n)}(Dn),kn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.type="onAnimationEnd",v}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onAnimationEnd",v.CLASS_ID.UUID_CALLBACK)],n)}(Dn),Un=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return i(n,T),r([P("engine.smartItem",v.CLASS_ID.SMART_ITEM)],n)}(X),Vn=function(T){function n(v){var C=T.call(this)||this;return C.url=v,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"url",void 0),r([N("engine.VideoClip",v.CLASS_ID.VIDEO_CLIP),s("design:paramtypes",[String])],n)}(X);v.VideoStatus=void 0,(Mn=v.VideoStatus||(v.VideoStatus={}))[Mn.NONE=0]="NONE",Mn[Mn.ERROR=1]="ERROR",Mn[Mn.LOADING=2]="LOADING",Mn[Mn.READY=3]="READY",Mn[Mn.PLAYING=4]="PLAYING",Mn[Mn.BUFFERING=5]="BUFFERING";var qn,jn=function(T){function n(C,S){var A=T.call(this)||this;if(A.volume=1,A.playbackRate=1,A.loop=!1,A.seek=-1,A._position=-1,A._videoLength=-1,A._status=v.VideoStatus.NONE,A.playing=!1,!(C instanceof Vn))throw new Error("Trying to create VideoTexture(VideoClip) with an invalid VideoClip");if(A.videoClipId=D(C),S)for(var E in S)A[E]=S[E];return A}return i(n,T),n.prototype.play=function(){this.playing=!0},n.prototype.pause=function(){this.playing=!1},n.prototype.reset=function(){this.seekTime(0),this.pause()},n.prototype.seekTime=function(v){this.seek=v,this.dirty=!0,this.data.nonce=Math.random()},n.prototype.toJSON=function(){if(this.seek>=0){var v=JSON.parse(JSON.stringify(T.prototype.toJSON.call(this)));return this.seek=-1,v}return T.prototype.toJSON.call(this)},n.prototype.update=function(T){T.videoClipId===this.videoClipId&&(this._status=T.videoStatus||v.VideoStatus.NONE,this._videoLength=T.totalVideoLength,this._position=T.currentOffset)},Object.defineProperty(n.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"videoLength",{get:function(){return this._videoLength},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),r([X.readonly,s("design:type",String)],n.prototype,"videoClipId",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([X.field,s("design:type",Number)],n.prototype,"volume",void 0),r([X.field,s("design:type",Number)],n.prototype,"playbackRate",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([X.field,s("design:type",Number)],n.prototype,"seek",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([N("engine.VideoTexture",v.CLASS_ID.VIDEO_TEXTURE),s("design:paramtypes",[Vn,Object])],n)}(X),Hn=function(T){function n(v){var C=T.call(this)||this;return C.area=v.area,C.cameraMode=v.cameraMode,C}return i(n,T),r([X.field,s("design:type",Object)],n.prototype,"area",void 0),r([X.field,s("design:type",Number)],n.prototype,"cameraMode",void 0),r([P("engine.cameraModeArea",v.CLASS_ID.CAMERA_MODE_AREA),s("design:paramtypes",[Object])],n)}(X),Wn=function(T){function n(v,C){var S=T.call(this)||this;if(S.userId=v,C)for(var A in C)S[A]=C[A];return S}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"userId",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([X.readonly,s("design:type",Boolean)],n.prototype,"hasAlpha",void 0),r([N("engine.texture",v.CLASS_ID.AVATAR_TEXTURE),s("design:paramtypes",[String,Object])],n)}(X),Gn=function(){function e(){var T=this;this.position=new At.Vector3,this.rotation=new At.Quaternion,this.feetPosition=new At.Vector3,this.worldPosition=new At.Vector3,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,this._cameraMode=v.CameraMode.ThirdPerson,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.subscribe("cameraModeChanged"),dcl.onEvent((function(v){switch(v.type){case"positionChanged":T.positionChanged(v.data);break;case"rotationChanged":T.rotationChanged(v.data);break;case"cameraModeChanged":T.cameraModeChanged(v.data)}}))),Object.defineProperty(this.position,"x",{get:function(){return T.lastEventPosition.x}}),Object.defineProperty(this.position,"y",{get:function(){return T.lastEventPosition.y}}),Object.defineProperty(this.position,"z",{get:function(){return T.lastEventPosition.z}}),Object.defineProperty(this.worldPosition,"x",{get:function(){return T.lastEventWorldPosition.x}}),Object.defineProperty(this.worldPosition,"y",{get:function(){return T.lastEventWorldPosition.y}}),Object.defineProperty(this.worldPosition,"z",{get:function(){return T.lastEventWorldPosition.z}}),Object.defineProperty(this.feetPosition,"x",{get:function(){return T.lastEventPosition.x}}),Object.defineProperty(this.feetPosition,"y",{get:function(){return T.lastEventPosition.y-T.playerHeight}}),Object.defineProperty(this.feetPosition,"z",{get:function(){return T.lastEventPosition.z}}),Object.defineProperty(this.rotation,"x",{get:function(){return T.lastEventRotation.x}}),Object.defineProperty(this.rotation,"y",{get:function(){return T.lastEventRotation.y}}),Object.defineProperty(this.rotation,"z",{get:function(){return T.lastEventRotation.z}}),Object.defineProperty(this.rotation,"w",{get:function(){return T.lastEventRotation.w}})}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerHeight",{get:function(){return this._playerHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cameraMode",{get:function(){return this._cameraMode},enumerable:!1,configurable:!0}),e.prototype.positionChanged=function(v){this.lastEventPosition=v.position,this.lastEventWorldPosition=v.cameraPosition,this._playerHeight=v.playerHeight},e.prototype.rotationChanged=function(v){this.lastEventRotation=v.quaternion},e.prototype.cameraModeChanged=function(v){this._cameraMode=v.cameraMode},e}();!function(v){v.HitFirst="rqhf",v.HitAll="rqha"}(qn||(qn={}));var Xn,Yn=function(){function t(){this.queries={}}return Object.defineProperty(t,"instance",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.getRayFromCamera=function(v){var T=Gn.instance.rotation,C=At.Matrix.Identity();T.toRotationMatrix(C);var S=At.Vector3.TransformCoordinates(At.Vector3.Forward(),C);return{origin:Gn.instance.position,direction:S,distance:v}},t.prototype.getRayFromPositions=function(v,T){var C=T.subtract(v),S=C.length();return{origin:v,direction:C.normalize(),distance:S}},t.prototype.hitFirst=function(v,T,C){var S="number"==typeof C?qn.HitFirst+C:m();this.queries[S]=T,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:S,queryType:"HitFirst",ray:v})},t.prototype.hitAll=function(v,T,C){var S="number"==typeof C?qn.HitAll+C:m();this.queries[S]=T,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:S,queryType:"HitAll",ray:v})},t.prototype.hitFirstAvatar=function(v,T){c("not implemented yet")},t.prototype.hitAllAvatars=function(v,T){c("not implemented yet")},t.prototype.handleRaycastHitFirstResponse=function(v){this.queries[v.payload.queryId](v.payload.payload),delete this.queries[v.payload.queryId]},t.prototype.handleRaycastHitAllResponse=function(v){this.queries[v.payload.queryId](v.payload.payload),delete this.queries[v.payload.queryId]},t}(),Qn=function(){function t(){}return t.prototype.activate=function(v){v.eventManager.addListener(st,this,(function(v){"HitFirst"===v.payload.queryType?Yn.instance.handleRaycastHitFirstResponse(v):"HitAll"===v.payload.queryType&&Yn.instance.handleRaycastHitAllResponse(v)})),"undefined"!=typeof dcl&&dcl.subscribe("raycastResponse")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("raycastResponse")},t}(),Zn=function(){function t(){}return t.prototype.activate=function(v){v.eventManager.addListener(at,this,(function(v){cn.instance.handlePointerEvent(v.payload)})),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("actionButtonEvent"))},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("actionButtonEvent"))},t}(),Jn=function(){function t(){this.handlerMap={}}return t.prototype.activate=function(v){v.eventManager.addListener(rt,this,this.handleEvent),v.eventManager.addListener(z,this,this.componentAdded),v.eventManager.addListener(R,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")},t.prototype.onAddEntity=function(v){for(var T in v.components){var C=v.components[T];C instanceof Dn&&(this.handlerMap[C.uuid]=C)}},t.prototype.onRemoveEntity=function(v){for(var T in v.components){var C=v.components[T];C instanceof Dn&&delete this.handlerMap[C.uuid]}},t.prototype.componentAdded=function(v){if(v.entity.isAddedToEngine()){var T=v.entity.components[v.componentName];T instanceof Dn&&(this.handlerMap[T.uuid]=T)}},t.prototype.componentRemoved=function(v){v.entity.isAddedToEngine()&&v.component instanceof Dn&&delete this.handlerMap[v.component.uuid]},t.prototype.handleEvent=function(v){if(v.uuid in this.handlerMap){var T=this.handlerMap[v.uuid];T&&T.callback&&"call"in T.callback&&T.callback(v.payload)}},t}(),Kn=new Qn,$n=new Zn,ti=new Jn,ei=function(T){function n(v){var C=T.call(this)||this;return C.loop=!1,C.volume=1,C.url=v,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"url",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([X.field,s("design:type",String)],n.prototype,"loadingCompleteEventId",void 0),r([X.field,s("design:type",Number)],n.prototype,"volume",void 0),r([N("engine.AudioClip",v.CLASS_ID.AUDIO_CLIP),s("design:paramtypes",[String])],n)}(X),ni=function(T){function n(v){var C=T.call(this)||this;if(C.audioClip=v,C.loop=!1,C.volume=1,C.playing=!1,C.pitch=1,C.playedAtTimestamp=Date.now(),!(v instanceof ei))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");return C.audioClipId=D(v),C}return i(n,T),n.prototype.playOnce=function(){return this.playing=!0,this.dirty=!0,this.playedAtTimestamp=Date.now(),this.data.nonce=Math.random(),this},r([X.readonly,s("design:type",String)],n.prototype,"audioClipId",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([X.field,s("design:type",Number)],n.prototype,"volume",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([X.field,s("design:type",Number)],n.prototype,"pitch",void 0),r([X.field,s("design:type",Number)],n.prototype,"playedAtTimestamp",void 0),r([P("engine.AudioSource",v.CLASS_ID.AUDIO_SOURCE),s("design:paramtypes",[ei])],n)}(X),ii=function(T){function n(v){var C=T.call(this)||this;return C.playing=!1,C.volume=1,C.url=v,C.playing=!0,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"url",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([X.field,s("design:type",Number)],n.prototype,"volume",void 0),r([P("engine.AudioStream",v.CLASS_ID.AUDIO_STREAM),s("design:paramtypes",[String])],n)}(X);v.Gizmo=void 0,(Xn=v.Gizmo||(v.Gizmo={})).MOVE="MOVE",Xn.ROTATE="ROTATE",Xn.SCALE="SCALE",Xn.NONE="NONE";var oi,ri=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.type="gizmoEvent",v}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.gizmoEvent",v.CLASS_ID.UUID_CALLBACK)],n)}(Dn),si=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.position=!0,v.rotation=!0,v.scale=!0,v.cycle=!0,v.localReference=!1,v}return i(n,T),r([X.field,s("design:type",Boolean)],n.prototype,"position",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"rotation",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"scale",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"cycle",void 0),r([X.field,s("design:type",String)],n.prototype,"selectedGizmo",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"localReference",void 0),r([P("engine.gizmos",v.CLASS_ID.GIZMOS)],n)}(X),ai=function(T){function n(v){var C=T.call(this,v)||this;return C.type="onFocus",ti.handlerMap[C.uuid]=C,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onFocus",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),hi=function(T){function n(v){var C=T.call(this,v)||this;return C.type="onTextSubmit",ti.handlerMap[C.uuid]=C,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onTextSubmit",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),li=function(T){function n(v){var C=T.call(this,v)||this;return C.type="onBlur",ti.handlerMap[C.uuid]=C,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onBlur",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),ci=function(T){function n(v){var C=T.call(this,v)||this;return C.type="onEnter",ti.handlerMap[C.uuid]=C,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onEnter",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),ui=function(T){function n(v){var C=T.call(this,v)||this;return C.type="onChange",ti.handlerMap[C.uuid]=C,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onChange",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),di=function(T){function n(v,C){var S=T.call(this,v)||this;return S.type="onClick",ti.handlerMap[S.uuid]=S,C&&(S.showFeedback=!(!1===C.showFeedback),C.button&&(S.button=C.button),C.hoverText&&(S.hoverText=C.hoverText),C.distance&&(S.distance=C.distance)),S}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onClick",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Ln),pi=function(T){function n(v,C){var S=T.call(this,v)||this;return S.type="pointerDown",ti.handlerMap[S.uuid]=S,C&&(S.showFeedback=!(!1===C.showFeedback),C.button&&(S.button=C.button),C.hoverText&&(S.hoverText=C.hoverText),C.distance&&(S.distance=C.distance)),S}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerDown",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Ln),fi=function(T){function n(v,C){var S=T.call(this,v)||this;return S.type="pointerUp",ti.handlerMap[S.uuid]=S,C&&(S.showFeedback=!(!1===C.showFeedback),C.button&&(S.button=C.button),C.hoverText&&(S.hoverText=C.hoverText),C.distance&&(S.distance=C.distance)),S}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerUp",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Ln),yi=function(T){function n(v,C){var S=T.call(this,v)||this;return S.type="pointerHoverEnter",ti.handlerMap[S.uuid]=S,C&&C.distance&&(S.distance=C.distance),S}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerHoverEnter",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Ln),mi=function(T){function n(v){var C=T.call(this,v)||this;return C.type="pointerHoverExit",ti.handlerMap[C.uuid]=C,C.distance=160,C}return i(n,T),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerHoverExit",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Ln),gi=function(v){function e(T){var C=v.call(this)||this;return C.name=null,C.visible=!0,C.opacity=1,C.hAlign="center",C.vAlign="center",C.width="100px",C.height="50px",C.positionX="0px",C.positionY="0px",C.isPointerBlocker=!0,T&&(C._parent=T,C.data.parentComponent=D(T)),C}return i(e,v),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentComponent",{get:function(){return this.data.parentComponent},enumerable:!1,configurable:!0}),r([X.field,s("design:type",Object)],e.prototype,"name",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"visible",void 0),r([X.field,s("design:type",Number)],e.prototype,"opacity",void 0),r([X.field,s("design:type",String)],e.prototype,"hAlign",void 0),r([X.field,s("design:type",String)],e.prototype,"vAlign",void 0),r([X.uiValue,s("design:type",Object)],e.prototype,"width",void 0),r([X.uiValue,s("design:type",Object)],e.prototype,"height",void 0),r([X.uiValue,s("design:type",Object)],e.prototype,"positionX",void 0),r([X.uiValue,s("design:type",Object)],e.prototype,"positionY",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),e}(X),vi=function(T){function n(){return T.call(this,null)||this}return i(n,T),r([N("engine.shape",v.CLASS_ID.UI_FULLSCREEN_SHAPE),s("design:paramtypes",[])],n)}(gi),wi=function(T){function n(){return T.call(this,null)||this}return i(n,T),r([N("engine.shape",v.CLASS_ID.UI_WORLD_SPACE_SHAPE),s("design:paramtypes",[])],n)}(gi),bi=function(T){function n(){return T.call(this,null)||this}return i(n,T),r([N("engine.shape",v.CLASS_ID.UI_SCREEN_SPACE_SHAPE),s("design:paramtypes",[])],n)}(gi),Ti=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.thickness=0,v.color=At.Color4.Clear(),v.alignmentUsesSize=!0,v}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"thickness",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"alignmentUsesSize",void 0),r([N("engine.shape",v.CLASS_ID.UI_CONTAINER_RECT)],n)}(gi);v.UIStackOrientation=void 0,(oi=v.UIStackOrientation||(v.UIStackOrientation={}))[oi.VERTICAL=0]="VERTICAL",oi[oi.HORIZONTAL=1]="HORIZONTAL";var Ci=function(T){function n(){var C=null!==T&&T.apply(this,arguments)||this;return C.adaptWidth=!0,C.adaptHeight=!0,C.color=At.Color4.Clear(),C.stackOrientation=v.UIStackOrientation.VERTICAL,C.spacing=0,C}return i(n,T),r([X.field,s("design:type",Boolean)],n.prototype,"adaptWidth",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"adaptHeight",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",Number)],n.prototype,"stackOrientation",void 0),r([X.field,s("design:type",Number)],n.prototype,"spacing",void 0),r([N("engine.shape",v.CLASS_ID.UI_CONTAINER_STACK)],n)}(gi),Si=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.fontSize=10,v.fontWeight="normal",v.thickness=0,v.cornerRadius=0,v.color=At.Color4.White(),v.background=At.Color4.White(),v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v.shadowBlur=0,v.shadowOffsetX=0,v.shadowOffsetY=0,v.shadowColor=At.Color4.Black(),v.text="button",v}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([X.field,s("design:type",String)],n.prototype,"fontWeight",void 0),r([X.field,s("design:type",Number)],n.prototype,"thickness",void 0),r([X.field,s("design:type",Number)],n.prototype,"cornerRadius",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"background",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"shadowColor",void 0),r([X.field,s("design:type",String)],n.prototype,"text",void 0),r([N("engine.shape",v.CLASS_ID.UI_BUTTON_SHAPE)],n)}(gi),xi=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.outlineWidth=0,v.outlineColor=At.Color4.White(),v.color=At.Color4.White(),v.fontSize=10,v.fontAutoSize=!1,v.value="",v.lineSpacing=0,v.lineCount=0,v.adaptWidth=!1,v.adaptHeight=!1,v.textWrapping=!1,v.shadowBlur=0,v.shadowOffsetX=0,v.shadowOffsetY=0,v.shadowColor=At.Color4.Black(),v.hTextAlign="left",v.vTextAlign="bottom",v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"outlineColor",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"fontAutoSize",void 0),r([X.component,s("design:type",Pn)],n.prototype,"font",void 0),r([X.field,s("design:type",String)],n.prototype,"value",void 0),r([X.field,s("design:type",Number)],n.prototype,"lineSpacing",void 0),r([X.field,s("design:type",Number)],n.prototype,"lineCount",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"adaptWidth",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"adaptHeight",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"shadowColor",void 0),r([X.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([X.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([N("engine.shape",v.CLASS_ID.UI_TEXT_SHAPE)],n)}(gi),_i=function(T){function n(v){var C=T.call(this,v)||this;return C.outlineWidth=0,C.outlineColor=At.Color4.Black(),C.color=At.Color4.Clear(),C.fontSize=10,C.value="",C.placeholder="",C.margin=10,C.hTextAlign="left",C.vTextAlign="bottom",C.focusedBackground=At.Color4.Black(),C.textWrapping=!1,C.shadowBlur=0,C.shadowOffsetX=0,C.shadowOffsetY=0,C.shadowColor=At.Color4.White(),C.paddingTop=0,C.paddingRight=0,C.paddingBottom=0,C.paddingLeft=0,C.onTextSubmit=null,C.onChanged=null,C.onFocus=null,C.onBlur=null,C.onTextChanged=new ui((function(v){var T=v.value,S=T.value,A=T.isSubmit,E=C.dirty;if(C.value=S,C.dirty=E,A&&C.onTextSubmit){var R={text:S};C.onTextSubmit.callback(R)}else if(!A&&C.onChanged){var z={value:S,pointerId:v.pointerId};C.onChanged.callback(z)}})),C}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"outlineColor",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([X.component,s("design:type",Pn)],n.prototype,"font",void 0),r([X.field,s("design:type",String)],n.prototype,"value",void 0),r([X.field,s("design:type",String)],n.prototype,"placeholder",void 0),r([X.field,s("design:type",Number)],n.prototype,"margin",void 0),r([X.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([X.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"focusedBackground",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"shadowColor",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([Dn.uuidEvent,s("design:type",ui)],n.prototype,"onTextChanged",void 0),r([Dn.uuidEvent,s("design:type",Object)],n.prototype,"onFocus",void 0),r([Dn.uuidEvent,s("design:type",Object)],n.prototype,"onBlur",void 0),r([N("engine.shape",v.CLASS_ID.UI_INPUT_TEXT_SHAPE),s("design:paramtypes",[Object])],n)}(gi),Ai=function(T){function n(v,C){var S=T.call(this,v)||this;return S.sourceLeft=0,S.sourceTop=0,S.sourceWidth=1,S.sourceHeight=1,S.paddingTop=0,S.paddingRight=0,S.paddingBottom=0,S.paddingLeft=0,S.sizeInPixels=!0,S.onClick=null,S.source=C,S}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"sourceLeft",void 0),r([X.field,s("design:type",Number)],n.prototype,"sourceTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"sourceWidth",void 0),r([X.field,s("design:type",Number)],n.prototype,"sourceHeight",void 0),r([X.component,s("design:type",Object)],n.prototype,"source",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"sizeInPixels",void 0),r([Dn.uuidEvent,s("design:type",Object)],n.prototype,"onClick",void 0),r([N("engine.shape",v.CLASS_ID.UI_IMAGE_SHAPE),s("design:paramtypes",[gi,Object])],n)}(gi),Ei=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.valueX=0,v.valueY=0,v.backgroundColor=At.Color4.Clear(),v.isHorizontal=!1,v.isVertical=!1,v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v.onChanged=null,v}return i(n,T),r([X.field,s("design:type",Number)],n.prototype,"valueX",void 0),r([X.field,s("design:type",Number)],n.prototype,"valueY",void 0),r([X.field,s("design:type",At.Color4)],n.prototype,"backgroundColor",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"isHorizontal",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"isVertical",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([Dn.uuidEvent,s("design:type",Object)],n.prototype,"onChanged",void 0),r([N("engine.shape",v.CLASS_ID.UI_SLIDER_SHAPE)],n)}(gi),Ii=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.useDummyModel=!1,v.talking=!1,v}var C;return i(n,T),C=n,n.Dummy=function(){var v=new C;return v.useDummyModel=!0,v},r([X.field,s("design:type",String)],n.prototype,"id",void 0),r([X.field,s("design:type",String)],n.prototype,"name",void 0),r([X.field,s("design:type",String)],n.prototype,"expressionTriggerId",void 0),r([X.field,s("design:type",Number)],n.prototype,"expressionTriggerTimestamp",void 0),r([X.field,s("design:type",String)],n.prototype,"bodyShape",void 0),r([X.field,s("design:type",Array)],n.prototype,"wearables",void 0),r([X.field,s("design:type",Object)],n.prototype,"skinColor",void 0),r([X.field,s("design:type",Object)],n.prototype,"hairColor",void 0),r([X.field,s("design:type",Object)],n.prototype,"eyeColor",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"useDummyModel",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"talking",void 0),C=r([P("engine.avatarShape",v.CLASS_ID.AVATAR_SHAPE)],n)}(X),Pi=null,zi=null,Oi=null;function Ri(){return Oi||(Oi=new ot),Oi}var Mi=function(){function t(){var v=this;this.messageQueue=[],this.connected=!1,this.flushing=!1,function(){if(!zi){(zi=dcl.loadModule("@decentraland/CommunicationsController",{})).then((function(v){Pi=v}));var v=Ri();dcl.subscribe("comms"),dcl.onEvent((function(T){"comms"===T.type&&v.notifyObservers(T.data)}))}return zi}().then((function(){v.connected=!0,v.flush()}))}return t.prototype.on=function(v,T){return Ri().add((function(C){try{var S=JSON.parse(C.message);S.message===v&&T(S.payload,C.sender)}catch(C){dcl.error("Error parsing comms message "+(C.message||""),C)}}))},t.prototype.sendRaw=function(v){this.messageQueue.push(v),this.connected&&this.flush()},t.prototype.emit=function(v,T){var C=JSON.stringify({message:v,payload:T});this.sendRaw(C),Ri().notifyObservers({message:C,sender:"self"})},t.prototype.flush=function(){var v=this;if(0!==this.messageQueue.length&&this.connected&&Pi&&!this.flushing){var T=this.messageQueue.shift();this.flushing=!0,dcl.callRpc(Pi.rpcHandle,"send",[T]).then((function(T){v.flushing=!1,v.flush()}),(function(T){v.flushing=!1,y("Error flushing MessageBus",T)}))}},t}(),Ni=new Z("scene");Ni.uuid="0";var Bi=new J(Ni);N.engine=Bi,"undefined"!=typeof dcl&&(Bi.addSystem(new xt(dcl),1/0),mt(dcl)),Bi.addSystem(ti),Bi.addSystem($n),Bi.addSystem(Kn),v.AVATAR_OBSERVABLE="AVATAR_OBSERVABLE",v.Angle=At.Angle,v.AnimationState=rn,v.Animator=Rn,v.Arc2=At.Arc2,v.AttachToAvatar=yn,v.Attachable=T,v.AudioClip=ei,v.AudioSource=ni,v.AudioStream=ii,v.AvatarModifierArea=dn,v.AvatarShape=Ii,v.AvatarTexture=Wn,v.Axis=At.Axis,v.BasicMaterial=Bn,v.BezierCurve=At.BezierCurve,v.Billboard=mn,v.BoxShape=vn,v.Camera=Gn,v.CameraModeArea=Hn,v.CircleShape=bn,v.Color3=At.Color3,v.Color4=At.Color4,v.Component=P,v.ComponentAdded=z,v.ComponentGroup=Q,v.ComponentRemoved=R,v.ConeShape=Cn,v.Curve3=At.Curve3,v.CylinderShape=Sn,v.DEG2RAD=At.DEG2RAD,v.DisposableComponent=N,v.DisposableComponentCreated=j,v.DisposableComponentRemoved=H,v.DisposableComponentUpdated=W,v.Engine=J,v.Entity=Z,v.Epsilon=At.Epsilon,v.EventConstructor=x,v.EventManager=A,v.Font=Pn,v.Frustum=At.Frustum,v.GLTFShape=xn,v.Gizmos=si,v.GlobalPointerDown=hn,v.GlobalPointerUp=ln,v.Input=cn,v.Material=Nn,v.Matrix=At.Matrix,v.MessageBus=Mi,v.MultiObserver=it,v.NFTShape=An,v.OBJShape=In,v.Observable=ot,v.ObservableComponent=X,v.Observer=Y,v.ObserverEventState=nt,v.OnAnimationEnd=kn,v.OnBlur=li,v.OnChanged=ui,v.OnClick=di,v.OnEnter=ci,v.OnFocus=ai,v.OnGizmoEvent=ri,v.OnPointerDown=pi,v.OnPointerHoverEnter=yi,v.OnPointerHoverExit=mi,v.OnPointerLock=Fn,v.OnPointerUUIDEvent=Ln,v.OnPointerUp=fi,v.OnTextSubmit=hi,v.OnUUIDEvent=Dn,v.Orientation=At.Orientation,v.ParentChanged=O,v.Path2=At.Path2,v.Path3D=At.Path3D,v.PhysicsCast=Yn,v.Plane=At.Plane,v.PlaneShape=Tn,v.PointerEvent=at,v.PointerEventComponent=Ke,v.PointerEventSystem=Zn,v.Quaternion=At.Quaternion,v.RAD2DEG=At.RAD2DEG,v.RaycastEventSystem=Qn,v.RaycastResponse=st,v.Scalar=At.Scalar,v.Shape=gn,v.Size=At.Size,v.SmartItem=Un,v.Space=At.Space,v.SphereShape=wn,v.Subscription=en,v.TextShape=On,v.Texture=En,v.ToGammaSpace=At.ToGammaSpace,v.ToLinearSpace=At.ToLinearSpace,v.Transform=pn,v.UIButton=Si,v.UICanvas=bi,v.UIContainerRect=Ti,v.UIContainerStack=Ci,v.UIFullScreen=vi,v.UIImage=Ai,v.UIInputText=_i,v.UIScrollRect=Ei,v.UIShape=gi,v.UIText=xi,v.UIValue=M,v.UIWorldSpace=wi,v.UUIDEvent=rt,v.UUIDEventSystem=Jn,v.Vector2=At.Vector2,v.Vector3=At.Vector3,v.Vector4=At.Vector4,v.VideoClip=Vn,v.VideoTexture=jn,v._initEventObservables=mt,v.buildArray=function(v,T){for(var C=[],S=0;S<v;++S)C.push(T());return C},v.engine=Bi,v.error=y,v.executeTask=G,v.getComponentClassId=L,v.getComponentId=D,v.getComponentName=F,v.getMessageObserver=Ri,v.isDisposableComponent=U,v.log=c,v.newId=f,v.onCameraModeChangedObservable=ht,v.onEnterScene=ut,v.onEnterSceneObservable=ct,v.onIdleStateChangedObservable=lt,v.onLeaveScene=pt,v.onLeaveSceneObservable=dt,v.onPlayerClickedObservable=St,v.onPlayerConnectedObservable=bt,v.onPlayerDisconnectedObservable=Tt,v.onPlayerExpressionObservable=yt,v.onPointerLockedStateChange=gt,v.onProfileChanged=wt,v.onRealmChangedObservable=Ct,v.onSceneReadyObservable=ft,v.onVideoEvent=vt,v.openExternalURL=function(v){"undefined"!=typeof dcl?dcl.openExternalUrl(v):y("ERROR: openExternalURL dcl is undefined")},v.openNFTDialog=function(v,T){if(void 0===T&&(T=null),"undefined"!=typeof dcl){var C=v.match(/ethereum:\/\/(.+)\/(.+)/);if(!C||C.length<3)return;dcl.openNFTDialog(C[1],C[2],T)}else y("ERROR: openNFTDialog dcl is undefined")},v.pointerEventSystem=$n,v.raycastEventSystem=Kn,v.teleportTo=function(v){var T;T=[v],void 0===$&&"undefined"!=typeof dcl&&($=dcl.loadModule("@decentraland/UserActionModule",{})),void 0!==$&&"undefined"!=typeof dcl&&$.then((function(v){dcl.callRpc(v.rpcHandle,"requestTeleport",T)}))},v.uuid=m,v.uuidEventSystem=ti,Object.defineProperty(v,"__esModule",{value:!0})}(this.self=this.self||{}),define("@dcl/ecs-scene-utils",["exports","@decentraland/EnvironmentAPI"],(function(v,T){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var n=function(v,T){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,T){v.__proto__=T}||function(v,T){for(var C in T)Object.prototype.hasOwnProperty.call(T,C)&&(v[C]=T[C])})(v,T)};function i(v,T){function i(){this.constructor=v}n(v,T),v.prototype=null===T?Object.create(T):(i.prototype=T.prototype,new i)}function r(v,T,C,S){var A,E=arguments.length,R=E<3?T:null===S?S=Object.getOwnPropertyDescriptor(T,C):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)R=Reflect.decorate(v,T,C,S);else for(var z=v.length-1;z>=0;z--)(A=v[z])&&(R=(E<3?A(R):E>3?A(T,C,R):A(T,C))||R);return E>3&&R&&Object.defineProperty(T,C,R),R}function o(v,T,C,S){return new(C||(C=Promise))((function(A,E){function a(v){try{u(S.next(v))}catch(v){E(v)}}function s(v){try{u(S.throw(v))}catch(v){E(v)}}function u(v){var T;v.done?A(v.value):(T=v.value,T instanceof C?T:new C((function(v){v(T)}))).then(a,s)}u((S=S.apply(v,T||[])).next())}))}function a(v,T){var C,S,A,E,R={label:0,sent:function(){if(1&A[0])throw A[1];return A[1]},trys:[],ops:[]};return E={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(E[Symbol.iterator]=function(){return this}),E;function s(E){return function(z){return function(E){if(C)throw new TypeError("Generator is already executing.");for(;R;)try{if(C=1,S&&(A=2&E[0]?S.return:E[0]?S.throw||((A=S.return)&&A.call(S),0):S.next)&&!(A=A.call(S,E[1])).done)return A;switch(S=0,A&&(E=[2&E[0],A.value]),E[0]){case 0:case 1:A=E;break;case 4:return R.label++,{value:E[1],done:!1};case 5:R.label++,S=E[1],E=[0];continue;case 7:E=R.ops.pop(),R.trys.pop();continue;default:if(!((A=(A=R.trys).length>0&&A[A.length-1])||6!==E[0]&&2!==E[0])){R=0;continue}if(3===E[0]&&(!A||E[1]>A[0]&&E[1]<A[3])){R.label=E[1];break}if(6===E[0]&&R.label<A[1]){R.label=A[1],A=E;break}if(A&&R.label<A[2]){R.label=A[2],R.ops.push(E);break}A[2]&&R.ops.pop(),R.trys.pop();continue}E=T.call(v,R)}catch(v){E=[6,v],S=0}finally{C=A=0}if(5&E[0])throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}([E,z])}}}function s(v){var T="function"==typeof Symbol&&Symbol.iterator,C=T&&v[T],S=0;if(C)return C.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&S>=v.length&&(v=void 0),{value:v&&v[S++],done:!v}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")}var C,S=function(){function e(){this._components=[],this._componentGroups=[],e._instance=this}return e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.registerCustomComponent=function(v){this.createAndAddToEngine()._components.push(v)},e.prototype.addComponentType=function(v){var T,C;try{for(var S=s(this._components),A=S.next();!A.done;A=S.next())if(v==A.value)return}catch(v){T={error:v}}finally{try{A&&!A.done&&(C=S.return)&&C.call(S)}finally{if(T)throw T.error}}this._components.push(v),this._componentGroups.push(engine.getComponentGroup(v,Transform))},e.prototype.update=function(v){for(var T=0;T<this._components.length;T++)this.updateComponent(v,this._components[T],this._componentGroups[T])},e.prototype.updateComponent=function(v,T,C){C.entities.forEach((function(C){var S=C.getComponent(Transform),A=C.getComponent(T);A.update(v),A.assignValueToTransform(S),A.hasFinished()&&(C.removeComponent(A),null!=A.onFinishCallback&&A.onFinishCallback())}))},e._instance=null,e}();function h(T,C){switch(T){case v.InterpolationType.LINEAR:return C;case v.InterpolationType.EASEINQUAD:return function(v){return v*v}(C);case v.InterpolationType.EASEOUTQUAD:return function(v){return v*(2-v)}(C);case v.InterpolationType.EASEQUAD:return function(v){return v*v/(2*(v*v-v)+1)}(C);case v.InterpolationType.EASEINSINE:return function(v){return 1-Math.cos(v*Math.PI/2)}(C);case v.InterpolationType.EASEOUTSINE:return function(v){return Math.sin(v*Math.PI/2)}(C);case v.InterpolationType.EASESINE:return function(v){return-(Math.cos(Math.PI*v)-1)/2}(C);case v.InterpolationType.EASEINEXPO:return function(v){return 0===v?0:Math.pow(2,10*v-10)}(C);case v.InterpolationType.EASEOUTEXPO:return function(v){return 1===v?1:1-Math.pow(2,-10*v)}(C);case v.InterpolationType.EASEEXPO:return function(v){return 0===v?0:1===v?1:v<.5?Math.pow(2,20*v-10)/2:(2-Math.pow(2,-20*v+10))/2}(C);case v.InterpolationType.EASEINELASTIC:return function(v){var T=2*Math.PI/3;return 0===v?0:1===v?1:-Math.pow(2,10*v-10)*Math.sin((10*v-10.75)*T)}(C);case v.InterpolationType.EASEOUTELASTIC:return function(v){var T=2*Math.PI/3;return 0===v?0:1===v?1:Math.pow(2,-10*v)*Math.sin((10*v-.75)*T)+1}(C);case v.InterpolationType.EASEELASTIC:return function(v){var T=2*Math.PI/4.5;return 0===v?0:1===v?1:v<.5?-Math.pow(2,20*v-10)*Math.sin((20*v-11.125)*T)/2:Math.pow(2,-20*v+10)*Math.sin((20*v-11.125)*T)/2+1}(C);case v.InterpolationType.EASEINBOUNCE:return function(v){return 1-l(1-v)}(C);case v.InterpolationType.EASEOUTEBOUNCE:return function(v){return l(v)}(C);case v.InterpolationType.EASEBOUNCE:return function(v){return v<.5?(1-l(1-2*v))/2:(1+l(2*v-1))/2}(C);default:return C}}function l(v){var T=7.5625,C=2.75;return v<1/C?T*v*v:v<2/C?T*(v-=1.5/C)*v+.75:v<2.5/C?T*(v-=2.25/C)*v+.9375:T*(v-=2.625/C)*v+.984375}v.InterpolationType=void 0,(C=v.InterpolationType||(v.InterpolationType={}))[C.LINEAR=0]="LINEAR",C[C.EASEINQUAD=1]="EASEINQUAD",C[C.EASEOUTQUAD=2]="EASEOUTQUAD",C[C.EASEQUAD=3]="EASEQUAD",C.EASEINSINE="easeinsine",C.EASEOUTSINE="easeoutsine",C.EASESINE="easeinoutsine",C.EASEINEXPO="easeinexpo",C.EASEOUTEXPO="easeoutexpo",C.EASEEXPO="easeinoutexpo",C.EASEINELASTIC="easeinelastic",C.EASEOUTELASTIC="easeoutelastic",C.EASEELASTIC="easeinoutelastic",C.EASEINBOUNCE="easeinbounce",C.EASEOUTEBOUNCE="easeoutbounce",C.EASEBOUNCE="easeinoutbounce";var A,E=function(){function t(C,A,E,R,z){void 0===z&&(z=v.InterpolationType.LINEAR),this.start=C,this.end=A,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=R,this.interpolationType=z,0!=E?this.speed=1/E:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),S.createAndAddToEngine().addComponentType(T)}var T;return T=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.start,this.end,this.lerpTime)},T=r([Component("moveTransformComponent")],t)}(),R=function(){function t(C,A,E,R,z){void 0===z&&(z=v.InterpolationType.LINEAR),this.start=C,this.end=A,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=R,this.interpolationType=z,0!=E?this.speed=1/E:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),S.createAndAddToEngine().addComponentType(T)}var T;return T=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.rotation=Quaternion.Slerp(this.start,this.end,this.lerpTime)},T=r([Component("rotateTransformComponent")],t)}(),z=function(){function t(C,A,E,R,z){void 0===z&&(z=v.InterpolationType.LINEAR),this.start=C,this.end=A,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=R,this.interpolationType=z,0!=E?this.speed=1/E:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),S.createAndAddToEngine().addComponentType(T)}var T;return T=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.scale=Vector3.Lerp(this.start,this.end,this.lerpTime)},T=r([Component("scaleTransformComponent")],t)}(),O=function(){function e(T,C,A,E){if(this.speed=[],this.normalizedTime=0,this.currentIndex=0,this.points=T,this.onFinishCallback=A,this.onPointReachedCallback=E,T.length<2)throw new Error("At least 2 points are needed for FollowPathComponent.");if(C>0){for(var R=0,z=[],O=0;O<T.length-1;O++){var M=Vector3.Distance(T[O],T[O+1]);R+=M,z.push(M)}for(O=0;O<z.length;O++)this.speed.push(1/(z[O]/R*C))}else this.normalizedTime=1,this.currentIndex=T.length-2;S.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed[this.currentIndex],0,1),this.normalizedTime>=1&&this.currentIndex<this.points.length-2&&(this.currentIndex++,this.normalizedTime=0,this.onPointReachedCallback&&this.currentIndex<this.points.length-1&&this.onPointReachedCallback(this.points[this.currentIndex],this.points[this.currentIndex+1]))},e.prototype.hasFinished=function(){return this.currentIndex>=this.points.length-2&&this.normalizedTime>=1},e.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.points[this.currentIndex],this.points[this.currentIndex+1],this.normalizedTime)},v=r([Component("followPathComponent")],e)}(),M=function(){function e(T,C,A,E,R,z){if(this.speed=[],this.turnToFaceNext=!1,this.facingNext=!1,this.normalizedTime=0,this.currentIndex=0,this.points=Curve3.CreateCatmullRomSpline(T,A,!!R).getPoints(),this.onFinishCallback=z,this.turnToFaceNext=E||!1,this.points.length<2)throw new Error("At least 2 points are needed for FollowPathComponent.");if(C>0){for(var O=0,M=[],B=0;B<this.points.length-1;B++){var V=Vector3.Distance(this.points[B],this.points[B+1]);O+=V,M.push(V)}for(B=0;B<M.length;B++)this.speed.push(1/(M[B]/O*C))}else this.normalizedTime=1,this.currentIndex=T.length-2;S.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed[this.currentIndex],0,1),this.normalizedTime>=1&&this.currentIndex<this.points.length-2&&(this.currentIndex++,this.normalizedTime=0,1==this.turnToFaceNext&&(this.facingNext=!1))},e.prototype.hasFinished=function(){return this.currentIndex>=this.points.length-2&&this.normalizedTime>=1},e.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.points[this.currentIndex],this.points[this.currentIndex+1],this.normalizedTime),this.facingNext||(this.facingNext=!0,this.currentIndex<this.points.length-1?v.lookAt(this.points[this.currentIndex+1]):v.lookAt(this.points[0]))},v=r([Component("followCurvedPathComponent")],e)}(),B=function(){function e(T,C){this.rotationVelocity=T,this.onFinishCallback=C,this.rotation=Quaternion.Identity,this.finished=!1,S.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.rotation=Quaternion.Slerp(Quaternion.Identity,this.rotationVelocity,v)},e.prototype.hasFinished=function(){return this.finished},e.prototype.assignValueToTransform=function(v){v.rotation=v.rotation.multiply(this.rotation)},e.prototype.stop=function(){this.finished=!0},v=r([Component("keepRotatingComponent")],e)}();v.ToggleState=void 0,(A=v.ToggleState||(v.ToggleState={}))[A.Off=0]="Off",A[A.On=1]="On";var V=function(){function t(T,C){void 0===T&&(T=v.ToggleState.On),this.enabled=!0,this.state=v.ToggleState.Off,this.set(T),C&&this.setCallback(C)}return t.prototype.set=function(v){this.state=v,this.onValueChangedCallback&&this.onValueChangedCallback(v)},t.prototype.toggle=function(){this.enabled&&this.set(1-this.state)},t.prototype.isOn=function(){return this.state==v.ToggleState.On},t.prototype.setCallback=function(v){this.onValueChangedCallback=v},r([Component("toggle")],t)}(),q=function(){function e(){this._components=[],e._instance=this}return e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.registerCustomComponent=function(v){this.createAndAddToEngine()._components.push(v)},e.prototype.addComponentType=function(v){var T,C;try{for(var S=s(this._components),A=S.next();!A.done;A=S.next())if(v==A.value)return}catch(v){T={error:v}}finally{try{A&&!A.done&&(C=S.return)&&C.call(S)}finally{if(T)throw T.error}}this._components.push(v)},e.prototype.update=function(v){var T=this;this._components.forEach((function(C){T.updateComponent(v,C)}))},e.prototype.updateComponent=function(v,T){var C=engine.getEntitiesWithComponent(T);for(var S in C)if(C.hasOwnProperty(S)){var A=C[S],E=A.getComponent(T);E.elapsedTime+=v,E.elapsedTime>=E.targetTime&&E.onTargetTimeReached(A)}},e._instance=null,e}(),j=function(){function e(T,C){var S=this;q.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=T/1e3,this.onTimeReachedCallback=C,this.onTargetTimeReached=function(v){S.onTimeReachedCallback&&S.onTimeReachedCallback(),v.removeComponent(S)}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerDelay")],e)}(),H=function(){function e(T,C){var S=this;q.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=T/1e3,this.onTimeReachedCallback=C,this.onTargetTimeReached=function(v){S.onTimeReachedCallback&&S.onTimeReachedCallback(),v.removeComponent(S),engine.removeEntity(v)}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerExpireIn")],e)}(),W=function(){function e(T,C){var S=this;q.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=T/1e3,this.onTimeReachedCallback=C,this.onTargetTimeReached=function(){S.elapsedTime=0,S.onTimeReachedCallback&&S.onTimeReachedCallback()}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerInterval")],e)}();function I(v,T,C,S,A,E){var R=new Entity;R.addComponent(new Transform(E||{position:new Vector3(0,1.5,0)})),R.setParent(T);var z=new TextShape(v);return z.fontSize=A||3,z.color=S||Color3.Black(),R.addComponent(z),C&&R.addComponent(new Billboard),engine.addEntity(R),R}var X,Q,Z=function(){function e(){this._triggers={},e._instance=this,this._cameraTriggerWrapper=new K(new P(new Vector3(.5,1.8,.5),new Vector3(0,.91,0))),this._componentGroup=engine.getComponentGroup($)}return Object.defineProperty(e,"instance",{get:function(){return this.createAndAddToEngine()},enumerable:!1,configurable:!0}),e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.prototype.setCameraTriggerShape=function(v){this._cameraTriggerWrapper.setShape(v)},e.prototype.update=function(){var v=this,T=this._componentGroup.entities;for(var C in T.forEach((function(T){v.shouldWrapTriggerEntity(T)&&v.wrapTriggerEntity(T)})),this._triggers)if(this._triggers.hasOwnProperty(C)){var S=this._triggers[C];S.isDebugging()&&S.updateDebugEntity(),S.isInEngine()?null!=S.trigger&&S.trigger.enabled?(S.wasEnabled||S.isDebugging()&&S.addDebugEntity(),S.wasEnabled=!0,(S.trigger.onCameraEnter||S.trigger.onCameraExit)&&this.checkCollisionAgainstCamera(S),(S.trigger.onTriggerEnter||S.trigger.onTriggerExit)&&this.checkCollisionAgainstOtherTriggers(S)):S.wasEnabled&&(S.wasEnabled=!1,S.isDebugging()&&S.removeDebugEntity(),e.removeTriggerFromSystem(S)):(S.isDebugging()&&S.removeDebugEntity(),e.removeTriggerFromSystem(S),delete this._triggers[C])}},e.prototype.shouldWrapTriggerEntity=function(v){return null==this._triggers[v.uuid]||null==this._triggers[v.uuid]},e.prototype.wrapTriggerEntity=function(v){this._triggers[v.uuid]=new J(v)},e.removeTriggerFromSystem=function(v){for(var T,C=v.getActiveCollisions(),S=0;S<C.length;S++)!(C[S]===(null===(T=e._instance)||void 0===T?void 0:T._cameraTriggerWrapper)||null==C[S].trigger)&&C[S].trigger.onTriggerExit&&v.entity&&C[S].trigger.onTriggerExit(v.entity),C[S].disengageActiveCollision(v),v.disengageActiveCollision(C[S])},e.disengageCollision=function(v,T){v.disengageActiveCollision(T),T.disengageActiveCollision(v),v.trigger.onTriggerExit&&T.entity&&v.trigger.onTriggerExit(T.entity),T.trigger.onTriggerExit&&v.entity&&T.trigger.onTriggerExit(v.entity)},e.engageCollision=function(v,T){v.engageCollision(T),T.engageCollision(v),v.trigger.onTriggerEnter&&T.entity&&v.trigger.onTriggerEnter(T.entity),T.trigger.onTriggerEnter&&v.entity&&T.trigger.onTriggerEnter(v.entity)},e.prototype.checkCollisionAgainstCamera=function(v){var T=v.hasActiveCollision(this._cameraTriggerWrapper),C=e.areColliding(v,this._cameraTriggerWrapper);T&&!C?(v.disengageActiveCollision(this._cameraTriggerWrapper),v.trigger.onCameraExit&&v.trigger.onCameraExit()):!T&&C&&(v.engageCollision(this._cameraTriggerWrapper),v.trigger.onCameraEnter&&v.trigger.onCameraEnter())},e.prototype.checkCollisionAgainstOtherTriggers=function(v){for(var T in this._triggers)if(this._triggers.hasOwnProperty(T)&&T!=v.uuid&&this._triggers[T].trigger.enabled&&e.canTriggersCollide(v,this._triggers[T])){var C=v.hasActiveCollision(this._triggers[T]),S=e.areColliding(v,this._triggers[T]);C&&!S?e.disengageCollision(v,this._triggers[T]):!C&&S&&e.engageCollision(v,this._triggers[T])}},e.canTriggersCollide=function(v,T){return 0==v.trigger.triggeredByLayer||0!=(T.trigger.layer&v.trigger.triggeredByLayer)},e.areColliding=function(v,T){return v.getShape()instanceof P&&T.getShape()instanceof P?e.areCollidingAABB(v.getGlobalPosition(),v.getShape(),T.getGlobalPosition(),T.getShape()):v.getShape()instanceof k&&T.getShape()instanceof k?e.areCollidingSphere(v.getGlobalPosition(),v.getShape(),T.getGlobalPosition(),T.getShape()):v.getShape()instanceof P&&T.getShape()instanceof k?e.areCollidingAABBSphere(v.getGlobalPosition(),v.getShape(),T.getGlobalPosition(),T.getShape()):v.getShape()instanceof k&&T.getShape()instanceof P&&e.areCollidingAABBSphere(T.getGlobalPosition(),T.getShape(),v.getGlobalPosition(),v.getShape())},e.areCollidingAABB=function(v,T,C,S){var A=e.getBoxShapeValues(v,T),E=e.getBoxShapeValues(C,S);return A.min.x<=E.max.x&&A.max.x>=E.min.x&&A.min.y<=E.max.y&&A.max.y>=E.min.y&&A.min.z<=E.max.z&&A.max.z>=E.min.z},e.areCollidingSphere=function(v,T,C,S){return Vector3.DistanceSquared(v.add(T.position),C.add(S.position))<T.radius*T.radius+S.radius*S.radius},e.areCollidingAABBSphere=function(v,T,C,S){var A=e.getBoxShapeValues(v,T),E=C.add(S.position),R=S.radius,z=0;return E.x<A.min.x&&(z+=(A.min.x-E.x)*(A.min.x-E.x)),E.x>A.max.x&&(z+=(E.x-A.max.x)*(E.x-A.max.x)),E.y<A.min.y&&(z+=(A.min.y-E.y)*(A.min.y-E.y)),E.y>A.max.y&&(z+=(E.y-A.max.y)*(E.y-A.max.y)),E.z<A.min.z&&(z+=(A.min.z-E.z)*(A.min.z-E.z)),E.z>A.max.z&&(z+=(E.z-A.max.z)*(E.z-A.max.z)),z<R*R},e.getBoxShapeValues=function(v,T){var C=v.add(T.position);return{center:C,min:C.subtract(T.size.scale(.5)),max:C.add(T.size.scale(.5))}},e._instance=null,e}(),J=function(){function e(v){this.wasEnabled=!0,this._uuid="",this._collidingWith={},this._isDebug=!1,this._debugEntity=null,this._entity=v,v&&(this._trigger=v.getComponent($),this._uuid=v.uuid,this._isDebug=this._trigger.debugEnabled,this._isDebug&&this.addDebugEntity())}return Object.defineProperty(e.prototype,"entity",{get:function(){return this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trigger",{get:function(){return this._trigger},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uuid",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),e.prototype.getGlobalPosition=function(){return this._entity?e.getEntityWorldPosition(this._entity):Vector3.Zero()},e.prototype.getShape=function(){return this._trigger.shape},e.prototype.isInEngine=function(){return null!=this._entity&&this._entity.isAddedToEngine()},e.prototype.getActiveCollisions=function(){var v=[];for(var T in this._collidingWith)this._collidingWith.hasOwnProperty(T)&&v.push(this._collidingWith[T]);return v},e.prototype.hasActiveCollision=function(v){return null!=this._collidingWith[v.uuid]&&null!=this._collidingWith[v.uuid]},e.prototype.disengageActiveCollision=function(v){delete this._collidingWith[v.uuid]},e.prototype.engageCollision=function(v){this._collidingWith[v.uuid]=v},e.prototype.isDebugging=function(){return this._isDebug},e.prototype.addDebugEntity=function(){return o(this,void 0,void 0,(function(){var v,C,S;return a(this,(function(A){switch(A.label){case 0:return[4,!T.isPreviewMode()];case 1:return A.sent()||(e._debugMaterial||(e._debugMaterial=new Material,e._debugMaterial.alphaTest=.5),null==this._debugEntity&&(this._debugEntity=new Entity,v=new Transform,this._debugEntity.addComponent(v),this._debugEntity.addComponent(e._debugMaterial),this.getShape()instanceof P&&((C=new BoxShape).withCollisions=!1,this._debugEntity.addComponent(C),v.scale=this.getShape().size),this.getShape()instanceof k&&((C=new SphereShape).withCollisions=!1,this._debugEntity.addComponent(C),S=this.getShape().radius,v.scale=new Vector3(S,S,S))),engine.addEntity(this._debugEntity)),[2]}}))}))},e.prototype.removeDebugEntity=function(){null!=this._debugEntity&&engine.removeEntity(this._debugEntity)},e.prototype.updateDebugEntity=function(){this._debugEntity&&(this._debugEntity.getComponent(Transform).position=this.getGlobalPosition().add(this.getShape().position))},e.getEntityWorldPosition=function(v){var T=v.hasComponent(Transform)?v.getComponent(Transform).position.clone():Vector3.Zero(),C=v.getParent();if(null!=C){var S=C.hasComponent(Transform)?C.getComponent(Transform).rotation:Quaternion.Identity;return this.getEntityWorldPosition(C).add(T.rotate(S))}return T},e._debugMaterial=null,e}(),K=function(v){function t(T){var C=v.call(this)||this;return C._shape=T,C._uuid="cameraTrigger",C}return i(t,v),t.prototype.getGlobalPosition=function(){return Camera.instance.position},t.prototype.getShape=function(){return this._shape},t.prototype.setShape=function(v){this._shape=v},t.prototype.isInEngine=function(){return!1},t.prototype.hasActiveCollision=function(v){return!1},t.prototype.disengageActiveCollision=function(v){},t.prototype.engageCollision=function(v){},t.prototype.isDebugging=function(){return!1},t}(J),$=function(){function e(v,T){this.enabled=!0,this.layer=0,this.triggeredByLayer=0,this._debugEnabled=!1,Z.createAndAddToEngine(),this.shape=v,T&&(T.layer&&(this.layer=T.layer),T.triggeredByLayer&&(this.triggeredByLayer=T.triggeredByLayer),T.onTriggerEnter&&(this.onTriggerEnter=T.onTriggerEnter),T.onTriggerExit&&(this.onTriggerExit=T.onTriggerExit),T.onCameraEnter&&(this.onCameraEnter=T.onCameraEnter),T.onCameraExit&&(this.onCameraExit=T.onCameraExit),T.enableDebug&&(this._debugEnabled=T.enableDebug))}return Object.defineProperty(e.prototype,"debugEnabled",{get:function(){return this._debugEnabled},enumerable:!1,configurable:!0}),r([Component("triggerComponent")],e)}(),P=function(v,T){void 0===v&&(v=Vector3.One().scale(2)),void 0===T&&(T=Vector3.Zero()),this.size=v,this.position=T},k=function(v,T){void 0===v&&(v=2),void 0===T&&(T=Vector3.Zero()),this.radius=v,this.position=T};v.ActionsSequenceSystem=function(){function e(v){this.beginSequenceNode=null,this.currentSequenceNode=null,this.running=!1,this.started=!1,v&&this.startSequence(v)}return e.prototype.startSequence=function(v){this.beginSequenceNode=v.beginSequenceNode,this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1},e.prototype.setOnFinishCallback=function(v){this.onFinishCallback=v},e.prototype.isRunning=function(){return this.running},e.prototype.stop=function(){this.running=!1},e.prototype.resume=function(){null!=this.beginSequenceNode&&(this.running=!0)},e.prototype.reset=function(){this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1},e.prototype.getRunningAction=function(){var v=this.currentSequenceNode;if(this.currentSequenceNode instanceof nt)do{v=v.currentInnerSequence}while(v instanceof nt);return v.action},e.prototype.update=function(v){this.running&&(this.started?this.currentSequenceNode.hasFinish()?(this.currentSequenceNode.onFinish(),this.currentSequenceNode=this.currentSequenceNode.next,this.currentSequenceNode?this.currentSequenceNode.onStart():(this.running=!1,this.onFinishCallback&&this.onFinishCallback())):this.currentSequenceNode.update(v):(this.currentSequenceNode.onStart(),this.started=!0))},e}(),X=v.ActionsSequenceSystem||(v.ActionsSequenceSystem={}),Q=function(){function e(){this.currentSequenceNode=null,this.beginSequenceNode=null,this.whileNodeStack=[]}return e.prototype.then=function(v){if(null==this.currentSequenceNode)this.currentSequenceNode=new et,this.currentSequenceNode.action=v,this.beginSequenceNode=this.currentSequenceNode;else{var T=new et;T.action=v,this.currentSequenceNode=this.currentSequenceNode.then(T)}return this},e.prototype.if=function(v){var T=new it(v);return null==this.currentSequenceNode?(this.currentSequenceNode=T,this.beginSequenceNode=T):this.currentSequenceNode=this.currentSequenceNode.then(T),this},e.prototype.else=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof it))throw new Error("IF statement is needed to be called before ELSE statement.");v.closed=!0;var T=new ot(v);return this.currentSequenceNode=this.currentSequenceNode.then(T),this},e.prototype.endIf=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof it||v instanceof ot))throw new Error("IF statement is needed to be called before ENDIF statement.");return v.closed=!0,this},e.prototype.while=function(v){var T=new rt(v);return null==this.currentSequenceNode?(this.currentSequenceNode=T,this.beginSequenceNode=T):this.currentSequenceNode=this.currentSequenceNode.then(T),this.whileNodeStack.push(T),this},e.prototype.endWhile=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof rt))throw new Error("WHILE statement is needed to be called before ENDWHILE statement.");return v.closed=!0,this.whileNodeStack.length>0&&this.whileNodeStack.splice(this.whileNodeStack.length-1,1),this},e.prototype.breakWhile=function(){if(!(this.whileNodeStack.length>0))throw new Error("WHILE statement is needed to be called before BREAKWHILE statement.");return this.currentSequenceNode=this.currentSequenceNode.then(new st(this.whileNodeStack[this.whileNodeStack.length-1])),this},e}(),X.SequenceBuilder=Q;var et=function(){function e(){this.action=null,this.next=null}return e.prototype.then=function(v){return this.next=v,v},e.prototype.onStart=function(){this.action&&this.action.onStart()},e.prototype.update=function(v){this.action&&this.action.update(v)},e.prototype.onFinish=function(){this.action&&this.action.onFinish()},e.prototype.hasFinish=function(){return!this.action||this.action.hasFinished},e.prototype.getSequence=function(){return this},e}(),nt=function(v){function t(){var T=null!==v&&v.apply(this,arguments)||this;return T.currentInnerSequence=null,T.startingInnerSequence=null,T.closed=!1,T}return i(t,v),t.prototype.then=function(v){if(null==this.currentInnerSequence)this.currentInnerSequence=v,this.startingInnerSequence=v;else{if(this.closed)return this.next=v,v;this.currentInnerSequence=this.currentInnerSequence.then(v)}return this},t.prototype.onStart=function(){this.currentInnerSequence=this.startingInnerSequence,this.currentInnerSequence&&this.currentInnerSequence.onStart()},t.prototype.update=function(v){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(v))},t.prototype.onFinish=function(){this.currentInnerSequence&&this.currentInnerSequence.onFinish()},t.prototype.hasFinish=function(){return null==this.currentInnerSequence},t.prototype.getSequence=function(){if(this.currentInnerSequence){var v=this.currentInnerSequence.getSequence();if(v instanceof t&&!v.closed)return v}return this},t}(et),it=function(v){function t(T){var C=v.call(this)||this;return C.result=!1,C.condition=T,C}return i(t,v),t.prototype.onStart=function(){this.result=this.condition(),this.result?v.prototype.onStart.call(this):this.currentInnerSequence=null},t}(nt),ot=function(v){function t(T){var C=v.call(this)||this;return C.ifSequence=null,C.ifSequence=T,C}return i(t,v),t.prototype.onStart=function(){this.ifSequence&&!this.ifSequence.result?v.prototype.onStart.call(this):this.currentInnerSequence=null},t}(nt),rt=function(v){function t(T){var C=v.call(this)||this;return C.breakWhile=!1,C.condition=T,C}return i(t,v),t.prototype.onStart=function(){this.breakWhile=!1,this.condition()?v.prototype.onStart.call(this):this.currentInnerSequence=null},t.prototype.update=function(v){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,null==this.currentInnerSequence&&(this.currentInnerSequence=this.startingInnerSequence),this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(v))},t.prototype.hasFinish=function(){return this.breakWhile||!this.condition()},t}(nt),st=function(v){function t(T){var C=v.call(this)||this;return C.whileNode=T,C}return i(t,v),t.prototype.onStart=function(){this.whileNode.breakWhile=!0},t}(et);v.Delay=j,v.ExpireIn=H,v.FollowCurvedPathComponent=M,v.FollowPathComponent=O,v.Interpolate=h,v.Interval=W,v.KeepRotatingComponent=B,v.MoveTransformComponent=E,v.RotateTransformComponent=R,v.ScaleTransformComponent=z,v.SequenceNode=et,v.ToggleComponent=V,v.TransformSystem=S,v.TriggerBoxShape=P,v.TriggerComponent=$,v.TriggerSphereShape=k,v.TriggerSystem=Z,v.addLabel=I,v.addOneTimeTrigger=function(v,T,C){var S=!1,A=!1,E=new Entity;E.addComponent(new Transform({}));var R={};return T.layer&&(R.layer=T.layer),T.triggeredByLayer&&(R.triggeredByLayer=T.triggeredByLayer),T.onCameraEnter&&(R.onCameraEnter=function(){S||(S=!0,T.onCameraEnter()),!S&&T.onCameraEnter||!A&&T.onCameraExit||engine.removeEntity(E)}),T.onCameraExit&&(R.onCameraExit=function(){A||(A=!0,T.onCameraExit()),!S&&T.onCameraEnter||!A&&T.onCameraExit||engine.removeEntity(E)}),T.enableDebug&&(R.enableDebug=T.enableDebug),E.addComponent(new $(v,R)),C&&E.setParent(C),engine.addEntity(E),E},v.addTestCube=function(v,C,S,A,E,R,z){return o(this,void 0,void 0,(function(){var O,M,B;return a(this,(function(V){switch(V.label){case 0:return(O=!z)?[4,!T.isPreviewMode()]:[3,2];case 1:O=V.sent(),V.label=2;case 2:return O?[2]:((M=new Entity).addComponent(new Transform(v)),E?(M.addComponent(new SphereShape),M.getComponent(Transform).scale.setAll(.5)):M.addComponent(new BoxShape),engine.addEntity(M),M.addComponent(new OnPointerDown(C,{hoverText:S||"click",button:ActionButton.POINTER})),A&&((B=new Material).albedoColor=A,M.addComponent(B)),R&&(M.getComponent(BoxShape).withCollisions=!1),S&&I(S,M,!0),[2,M])}}))}))},v.clamp=function(v,T,C){var S=v;return v>C?S=C:v<T&&(S=T),S},v.getEntityWorldPosition=function e(v){var T=v.hasComponent(Transform)?v.getComponent(Transform).position.clone():Vector3.Zero(),C=v.getParent();if(null!=C&&"0"!=C.uuid){if("FirstPersonCameraEntityReference"==C.uuid){var S=Camera.instance.rotation.clone();return Camera.instance.position.clone().add(T.rotate(S))}if("AvatarEntityReference"==C.uuid){var A=Camera.instance.rotation;return S=Quaternion.Euler(0,A.eulerAngles.y,0),Camera.instance.position.clone().add(T.rotate(S)).add(new Vector3(0,-.875,0))}return S=C.hasComponent(Transform)?C.getComponent(Transform).rotation:Quaternion.Identity,e(C).add(T.rotate(S))}return T},v.getEntityWorldRotation=function e(v){var T=v.hasComponent(Transform)?v.getComponent(Transform).rotation.clone():Quaternion.Zero(),C=v.getParent();if(null!=C&&"0"!=C.uuid){if("FirstPersonCameraEntityReference"==C.uuid){var S=Camera.instance.rotation.clone();return T.multiply(S)}return"AvatarEntityReference"==C.uuid?(S=Quaternion.Euler(0,Camera.instance.rotation.eulerAngles.y,0),T.multiply(S)):(S=e(C),T.multiply(S))}return T},v.map=function(v,T,C,S,A){return(v-T)/(C-T)*(A-S)+S},v.sendRequest=function(v,T,C,S){return o(this,void 0,void 0,(function(){var A,E,R;return a(this,(function(z){switch(z.label){case 0:return z.trys.push([0,6,,7]),A={method:T||"GET"},C&&(A.headers=C),S&&(A.body=JSON.stringify(S)),[4,fetch(v,A)];case 1:E=z.sent(),z.label=2;case 2:return z.trys.push([2,4,,5]),[4,E.json()];case 3:return[2,z.sent()];case 4:return z.sent(),[2,E];case 5:return[3,7];case 6:return R=z.sent(),log("error fetching from ",v," : ",R),[3,7];case 7:return[2]}}))}))},v.setTimeout=function(v,T){var C=new Entity;return C.addComponent(new j(v,(function(){T(),engine.removeEntity(C)}))),engine.addEntity(C),C},Object.defineProperty(v,"__esModule",{value:!0})})),define("dcl-builder-hud",["exports","@decentraland/EnvironmentAPI"],(function(v,T){function e(v,T,C,S){return new(C||(C=Promise))((function(A,E){function a(v){try{r(S.next(v))}catch(v){E(v)}}function h(v){try{r(S.throw(v))}catch(v){E(v)}}function r(v){var T;v.done?A(v.value):(T=v.value,T instanceof C?T:new C((function(v){v(T)}))).then(a,h)}r((S=S.apply(v,T||[])).next())}))}function n(v,T){var C,S,A,E,R={label:0,sent:function(){if(1&A[0])throw A[1];return A[1]},trys:[],ops:[]};return E={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(E[Symbol.iterator]=function(){return this}),E;function h(E){return function(z){return function(E){if(C)throw new TypeError("Generator is already executing.");for(;R;)try{if(C=1,S&&(A=2&E[0]?S.return:E[0]?S.throw||((A=S.return)&&A.call(S),0):S.next)&&!(A=A.call(S,E[1])).done)return A;switch(S=0,A&&(E=[2&E[0],A.value]),E[0]){case 0:case 1:A=E;break;case 4:return R.label++,{value:E[1],done:!1};case 5:R.label++,S=E[1],E=[0];continue;case 7:E=R.ops.pop(),R.trys.pop();continue;default:if(!((A=(A=R.trys).length>0&&A[A.length-1])||6!==E[0]&&2!==E[0])){R=0;continue}if(3===E[0]&&(!A||E[1]>A[0]&&E[1]<A[3])){R.label=E[1];break}if(6===E[0]&&R.label<A[1]){R.label=A[1],A=E;break}if(A&&R.label<A[2]){R.label=A[2],R.ops.push(E);break}A[2]&&R.ops.pop(),R.trys.pop();continue}E=T.call(v,R)}catch(v){E=[6,v],S=0}finally{C=A=0}if(5&E[0])throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}([E,z])}}}var C=function(){function t(v,T,C){this.direction=v,this.mode=T,this.pos=C||0}return t=function(v,T,C,S){var A,E=arguments.length,R=E<3?T:null===S?S=Object.getOwnPropertyDescriptor(T,C):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)R=Reflect.decorate(v,T,C,S);else for(var z=v.length-1;z>=0;z--)(A=v[z])&&(R=(E<3?A(R):E>3?A(T,C,R):A(T,C))||R);return E>3&&R&&Object.defineProperty(T,C,R),R}([Component("moving")],t),t}(),S=engine.getComponentGroup(C),A=function(){function t(){this.positions=[]}return t.prototype.addCameraPosition=function(v){this.positions.push(v),log(this.positions)},t.prototype.update=function(){var v,T;try{for(var A=function(v){var T="function"==typeof Symbol&&Symbol.iterator,C=T&&v[T],S=0;if(C)return C.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&S>=v.length&&(v=void 0),{value:v&&v[S++],done:!v}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")}(S.entities),E=A.next();!E.done;E=A.next()){var R=E.value,z=R.getComponent(Transform).position,O=R.getComponent(C).direction;switch(R.getComponent(C).mode){case"fixed":var M=R.getComponent(Transform).position.clone(),B=R.getComponent(C).pos;Vector3.Distance(M,this.positions[B])<.05?R.removeComponent(C):R.getComponent(Transform).position=Vector3.Lerp(M,this.positions[B],.04);break;case"free":"up"==O&&z.y<150&&(z.y+=.1),"down"==O&&(z.y>.2?z.y-=.1:R.removeComponent(C)),"forward"==O&&(z.z+=.1),"back"==O&&(z.z>1?z.z-=.1:R.removeComponent(C)),"right"==O&&(z.x+=.1),"left"==O&&(z.x>1?z.x-=.1:R.removeComponent(C))}}}catch(T){v={error:T}}finally{try{E&&!E.done&&(T=A.return)&&T.call(A)}finally{if(v)throw v.error}}},t}(),E=function(){function t(){var v=this;this.isSetup=!1,this.entities=[],this.numEntities=0,this.selectedEntityIndex=-1,this.selectionPointerScale=1,this.selectionPointerElevation=1,this.newEntityScale=.1,this.modePOSITION=0,this.modeROTATION=1,this.modeSCALE=2,this.mode=this.modePOSITION,this.snap=0,this.snapPosScale=1,this.snapRot=90,this.uiMaximized=!1,this.engineEntities=[],this.showingColliders=!1,this.transparent=new Texture("https://lsnft.mypinata.cloud/ipfs/QmaqcRuouE6Tip9acZmjxMyBftEA5aHASRDjn8Bmad87Ld"),this.scaffoldScale=new Vector3(1.2,1,1.2),this.transparentMat=new BasicMaterial,this.transparentMat.alphaTest=1,this.transparentMat.texture=this.transparent,this.scaffolding=new Entity,this.scaffolding.addComponent(new Transform({position:new Vector3(1,.3,1),scale:Vector3.Zero()})),engine.addEntity(this.scaffolding);var C=new Entity;C.addComponent(new Transform({position:new Vector3(-.5,1,-.5),scale:Vector3.One()})),C.setParent(this.scaffolding);var S=new Entity;S.addComponent(new BoxShape),S.addComponent(new Transform({position:new Vector3(2,0,.1),scale:new Vector3(4,.1,.1)})),S.setParent(C),S.getComponent(BoxShape).withCollisions=!1,S.addComponent(new Material),S.getComponent(Material).albedoColor=Color4.Red();var E=new Entity;E.addComponent(new TextShape("X")),E.addComponent(new Transform({position:new Vector3(3,.5,.4)})),E.addComponent(new Billboard(!1,!0,!1)),E.setParent(C);var R=new Entity;R.addComponent(new BoxShape),R.addComponent(new Transform({position:new Vector3(.1,2,.1),scale:new Vector3(.1,4,.1)})),R.setParent(C),R.getComponent(BoxShape).withCollisions=!1,R.addComponent(new Material),R.getComponent(Material).albedoColor=Color4.Green();var O=new Entity;O.addComponent(new TextShape("Y")),O.addComponent(new Transform({position:new Vector3(.5,3,.5)})),O.addComponent(new Billboard(!1,!0,!1)),O.setParent(C);var M=new Entity;M.addComponent(new BoxShape),M.addComponent(new Transform({position:new Vector3(.1,0,2),scale:new Vector3(.1,.1,4)})),M.setParent(C),M.addComponent(new Material),M.getComponent(BoxShape).withCollisions=!1,M.getComponent(Material).albedoColor=Color4.Blue();var B=new Entity;B.addComponent(new TextShape("Z")),B.addComponent(new Transform({position:new Vector3(.4,1,4)})),B.addComponent(new Billboard(!1,!0,!1)),B.setParent(C),this.scaffloor=new Entity,this.scaffloor.addComponent(new PlaneShape),this.scaffloor.addComponent(new Transform({position:new Vector3(0,0,0),rotation:Quaternion.Euler(90,0,0),scale:Vector3.One()})),this.scaffloor.addComponent(new Material),engine.addEntity(this.scaffloor),this.scaffloor.setParent(this.scaffolding),this.leftWall=new Entity,this.leftWall.addComponent(new PlaneShape),this.leftWall.addComponent(new Transform({position:new Vector3(0,-4.5,.6),rotation:Quaternion.Euler(0,180,0),scale:Vector3.Zero()})),this.leftWall.addComponent(this.transparentMat),this.leftWall.setParent(this.scaffolding),this.rightWall=new Entity,this.rightWall.addComponent(new PlaneShape),this.rightWall.addComponent(new Transform({position:new Vector3(0,-4.5,-.6),rotation:Quaternion.Euler(0,180,0),scale:Vector3.Zero()})),this.rightWall.addComponent(this.transparentMat),this.rightWall.setParent(this.scaffolding),this.frontWall=new Entity,this.frontWall.addComponent(new PlaneShape),this.frontWall.addComponent(new Transform({position:new Vector3(.6,-4.5,0),rotation:Quaternion.Euler(0,270,0),scale:Vector3.Zero()})),this.frontWall.addComponent(this.transparentMat),this.frontWall.setParent(this.scaffolding),this.backWall=new Entity,this.backWall.addComponent(new PlaneShape),this.backWall.addComponent(new Transform({position:new Vector3(-.6,-4.5,0),rotation:Quaternion.Euler(0,270,0),scale:Vector3.One()})),this.backWall.addComponent(this.transparentMat),this.backWall.setParent(this.scaffolding),this.selectionPointer=new Entity,this.selectionPointer.addComponent(new PlaneShape),this.selectionPointer.getComponent(PlaneShape).withCollisions=!1,this.selectionPointer.addComponent(new BasicMaterial),this.selectionPointer.getComponent(BasicMaterial).texture=new Texture("https://lsnft.mypinata.cloud/ipfs/QmWbKQtJjsLjgDFinoH6fvmbUoetLZd7LanChC1R4QkA2e"),this.selectionPointer.addComponent(new Transform({rotation:Quaternion.Euler(0,0,180),scale:Vector3.One()})),this.selectionPointer.addComponent(new Billboard(!1,!0,!1)),this.setupUI(),executeTask((function(){return e(v,void 0,void 0,(function(){return n(this,(function(v){switch(v.label){case 0:return[4,T.isPreviewMode()];case 1:return v.sent()?(log("in preview mode"),z.uiMinimizedContainer.visible=!0):(log("not in preview mode"),z.uiMinimizedContainer.visible=!1,z.uiMaximizedContainer.visible=!1,engine.removeEntity(this.selectionPointer)),[2]}}))}))})),this.unsavedContainer=new UIContainerRect(this.uiMaximizedContainer),this.unsavedContainer.hAlign="center",this.unsavedContainer.vAlign="center",this.unsavedContainer.width=160,this.unsavedContainer.height=20,this.unsavedContainer.positionY=225,this.unsavedContainer.positionX=0,this.unsavedContainer.color=Color4.Red(),this.unsavedContainer.visible=!1;var V=new UIText(this.unsavedContainer);V.hAlign="center",V.vAlign="center",V.positionY=0,V.positionX=0,V.height=10,V.fontSize=12,V.hTextAlign="center",V.value="** Unsaved Changes **",this.movingSystem=new A,engine.addSystem(this.movingSystem)}return t.prototype.setDefaultParent=function(v){this.defaultParent=v},t.prototype.setupUI=function(){return e(this,void 0,void 0,(function(){var v,T,C,S,A=this;return n(this,(function(E){return this.isSetup=!0,v=new Texture("https://lsnft.mypinata.cloud/ipfs/QmYyDWc67svskJWxQrZNJxjwNsvsXyG9dvVzXvJtYtmgAr"),this.canvas=new UICanvas,this.canvas.hAlign="center",this.canvas.vAlign="bottom",this.uiMinimizedContainer=new UIContainerRect(this.canvas),this.uiMinimizedContainer.hAlign="right",this.uiMinimizedContainer.vAlign="bottom",this.uiMinimizedContainer.width=70,this.uiMinimizedContainer.height=80,this.uiMinimizedContainer.positionY=100,this.uiMinimizedContainer.positionX=0,this.uiMinimizedContainer.color=new Color4(0,0,0,0),this.uiMinimizedContainer.visible=!1,this.maximizeButton=new UIImage(this.uiMinimizedContainer,v),this.maximizeButton.sourceLeft=826,this.maximizeButton.sourceTop=544,this.maximizeButton.sourceWidth=74,this.maximizeButton.sourceHeight=74,this.maximizeButton.hAlign="right",this.maximizeButton.vAlign="bottom",this.maximizeButton.positionX=-15,this.maximizeButton.positionY=30,this.maximizeButton.width=40,this.maximizeButton.height=40,this.maximizeButton.isPointerBlocker=!0,this.maximizeButton.onClick=new OnClick((function(){A.maximizeUI()})),this.uiMaximizedContainer=new UIContainerRect(this.canvas),this.uiMaximizedContainer.hAlign="right",this.uiMaximizedContainer.vAlign="bottom",this.uiMaximizedContainer.width=160,this.uiMaximizedContainer.height=430,this.uiMaximizedContainer.positionX=0,this.uiMaximizedContainer.positionY=100,this.uiMaximizedContainer.color=new Color4(0,0,0,.75),(T=new UIImage(this.uiMaximizedContainer,v)).sourceLeft=826,T.sourceTop=184,T.sourceWidth=74,T.sourceHeight=74,T.hAlign="right",T.vAlign="top",T.positionX=-60,T.positionY=-10,T.width=40,T.height=40,T.isPointerBlocker=!0,T.onClick=new OnClick((function(){A.toggleLift.sourceLeft=503,A.toggleColliders(!0),engine.addSystem(new O(T))})),this.toggleLift=new UIImage(this.uiMaximizedContainer,v),this.toggleLift.sourceLeft=584,this.toggleLift.sourceTop=544,this.toggleLift.sourceWidth=74,this.toggleLift.sourceHeight=74,this.toggleLift.hAlign="right",this.toggleLift.vAlign="top",this.toggleLift.positionX=-15,this.toggleLift.positionY=-10,this.toggleLift.width=40,this.toggleLift.height=40,this.toggleLift.isPointerBlocker=!0,this.toggleLift.onClick=new OnClick((function(){A.toggleColliders(!1),engine.addSystem(new O(A.toggleLift))})),this.toggleCamera=new UIImage(this.uiMaximizedContainer,v),this.toggleCamera.sourceLeft=16,this.toggleCamera.sourceTop=94,this.toggleCamera.sourceWidth=74,this.toggleCamera.sourceHeight=74,this.toggleCamera.hAlign="right",this.toggleCamera.vAlign="top",this.toggleCamera.positionX=-105,this.toggleCamera.positionY=-10,this.toggleCamera.width=40,this.toggleCamera.height=40,this.toggleCamera.isPointerBlocker=!0,this.toggleCamera.onClick=new OnClick((function(){A.toggleCameraOptions(),engine.addSystem(new O(A.toggleCamera))})),this.toggleCamera.visible=!1,this.scaffoldB=new UIImage(this.uiMaximizedContainer,v),this.scaffoldB.sourceLeft=340,this.scaffoldB.sourceTop=544,this.scaffoldB.sourceWidth=74,this.scaffoldB.sourceHeight=74,this.scaffoldB.hAlign="right",this.scaffoldB.vAlign="bottom",this.scaffoldB.positionX=-105,this.scaffoldB.positionY=335,this.scaffoldB.width=40,this.scaffoldB.height=40,this.scaffoldB.isPointerBlocker=!0,this.scaffoldB.onClick=new OnClick((function(){A.moveScaffold("q"),engine.addSystem(new O(A.scaffoldB))})),this.scaffoldU=new UIImage(this.uiMaximizedContainer,v),this.scaffoldU.sourceLeft=178,this.scaffoldU.sourceTop=544,this.scaffoldU.sourceWidth=74,this.scaffoldU.sourceHeight=74,this.scaffoldU.hAlign="right",this.scaffoldU.vAlign="bottom",this.scaffoldU.positionX=-60,this.scaffoldU.positionY=335,this.scaffoldU.width=40,this.scaffoldU.height=40,this.scaffoldU.isPointerBlocker=!0,this.scaffoldU.onClick=new OnClick((function(){A.moveScaffold("w"),engine.addSystem(new O(A.scaffoldU))})),this.scaffoldF=new UIImage(this.uiMaximizedContainer,v),this.scaffoldF.sourceLeft=422,this.scaffoldF.sourceTop=544,this.scaffoldF.sourceWidth=74,this.scaffoldF.sourceHeight=74,this.scaffoldF.hAlign="right",this.scaffoldF.vAlign="bottom",this.scaffoldF.positionX=-15,this.scaffoldF.positionY=335,this.scaffoldF.width=40,this.scaffoldF.height=40,this.scaffoldF.isPointerBlocker=!0,this.scaffoldF.onClick=new OnClick((function(){A.moveScaffold("e"),engine.addSystem(new O(A.scaffoldF))})),this.scaffoldL=new UIImage(this.uiMaximizedContainer,v),this.scaffoldL.sourceLeft=16,this.scaffoldL.sourceTop=544,this.scaffoldL.sourceWidth=74,this.scaffoldL.sourceHeight=74,this.scaffoldL.hAlign="right",this.scaffoldL.vAlign="bottom",this.scaffoldL.positionX=-105,this.scaffoldL.positionY=290,this.scaffoldL.width=40,this.scaffoldL.height=40,this.scaffoldL.isPointerBlocker=!0,this.scaffoldL.onClick=new OnClick((function(){A.moveScaffold("a"),engine.addSystem(new O(A.scaffoldL))})),this.scaffoldD=new UIImage(this.uiMaximizedContainer,v),this.scaffoldD.sourceLeft=259,this.scaffoldD.sourceTop=544,this.scaffoldD.sourceWidth=74,this.scaffoldD.sourceHeight=74,this.scaffoldD.hAlign="right",this.scaffoldD.vAlign="bottom",this.scaffoldD.positionX=-60,this.scaffoldD.positionY=290,this.scaffoldD.width=40,this.scaffoldD.height=40,this.scaffoldD.isPointerBlocker=!0,this.scaffoldD.onClick=new OnClick((function(){A.moveScaffold("s"),engine.addSystem(new O(A.scaffoldD))})),this.scaffoldR=new UIImage(this.uiMaximizedContainer,v),this.scaffoldR.sourceLeft=97,this.scaffoldR.sourceTop=544,this.scaffoldR.sourceWidth=74,this.scaffoldR.sourceHeight=74,this.scaffoldR.hAlign="right",this.scaffoldR.vAlign="bottom",this.scaffoldR.positionX=-15,this.scaffoldR.positionY=290,this.scaffoldR.width=40,this.scaffoldR.height=40,this.scaffoldR.isPointerBlocker=!0,this.scaffoldR.onClick=new OnClick((function(){A.moveScaffold("d"),engine.addSystem(new O(A.scaffoldR))})),this.displayName=new UIText(this.uiMaximizedContainer),this.displayName.hAlign="center",this.displayName.vAlign="top",this.displayName.positionY=-180,this.displayName.positionX=0,this.displayName.height=10,this.displayName.fontSize=12,this.displayName.hTextAlign="center",(C=new UIText(this.uiMaximizedContainer)).hAlign="center",C.vAlign="top",C.positionY=-160,C.positionX=0,C.height=10,C.fontSize=12,C.hTextAlign="center",C.value="Entity Label",this.displayPRS=new UIText(this.uiMaximizedContainer),this.displayPRS.hAlign="center",this.displayPRS.vAlign="top",this.displayPRS.positionY=-200,this.displayPRS.positionX=0,this.displayPRS.height=10,this.displayPRS.fontSize=12,this.displayPRS.hTextAlign="center",this.displayPRS.value="(0,0,0)",this.scaffoldTitle=new UIText(this.uiMaximizedContainer),this.scaffoldTitle.hAlign="center",this.scaffoldTitle.vAlign="top",this.scaffoldTitle.positionY=-25,this.scaffoldTitle.positionX=-45,this.scaffoldTitle.height=10,this.scaffoldTitle.fontSize=8,this.scaffoldTitle.hTextAlign="center",this.scaffoldTitle.value="Scaffold",this.selectPreviousButton=new UIImage(this.uiMaximizedContainer,v),this.selectPreviousButton.sourceLeft=16,this.selectPreviousButton.sourceTop=184,this.selectPreviousButton.sourceWidth=74,this.selectPreviousButton.sourceHeight=74,this.selectPreviousButton.hAlign="right",this.selectPreviousButton.vAlign="bottom",this.selectPreviousButton.positionX=-105,this.selectPreviousButton.positionY=30,this.selectPreviousButton.width=40,this.selectPreviousButton.height=40,this.selectPreviousButton.isPointerBlocker=!0,this.selectPreviousButton.onClick=new OnClick((function(){A.selectPrevious(),engine.addSystem(new O(A.selectPreviousButton))})),this.selectNextButton=new UIImage(this.uiMaximizedContainer,v),this.selectNextButton.sourceLeft=97,this.selectNextButton.sourceTop=184,this.selectNextButton.sourceWidth=74,this.selectNextButton.sourceHeight=74,this.selectNextButton.hAlign="right",this.selectNextButton.vAlign="bottom",this.selectNextButton.positionX=-60,this.selectNextButton.positionY=30,this.selectNextButton.width=40,this.selectNextButton.height=40,this.selectNextButton.isPointerBlocker=!0,this.selectNextButton.onClick=new OnClick((function(){A.selectNext(),engine.addSystem(new O(A.selectNextButton))})),this.saveButton=new UIImage(this.uiMaximizedContainer,v),this.saveButton.sourceLeft=745,this.saveButton.sourceTop=184,this.saveButton.sourceWidth=74,this.saveButton.sourceHeight=74,this.saveButton.hAlign="right",this.saveButton.vAlign="bottom",this.saveButton.positionX=-15,this.saveButton.positionY=75,this.saveButton.width=40,this.saveButton.height=40,this.saveButton.isPointerBlocker=!0,this.saveButton.onClick=new OnClick((function(){A.dump(),engine.addSystem(new O(A.saveButton))})),this.qButton=new UIImage(this.uiMaximizedContainer,v),this.qButton.sourceLeft=340,this.qButton.sourceTop=544,this.qButton.sourceWidth=74,this.qButton.sourceHeight=74,this.qButton.hAlign="right",this.qButton.vAlign="bottom",this.qButton.positionX=-105,this.qButton.positionY=165,this.qButton.width=40,this.qButton.height=40,this.qButton.isPointerBlocker=!0,this.qButton.onClick=new OnClick((function(v){A.adjustTransform("q"),engine.addSystem(new O(A.qButton))})),this.wButton=new UIImage(this.uiMaximizedContainer,v),this.wButton.sourceLeft=178,this.wButton.sourceTop=544,this.wButton.sourceWidth=74,this.wButton.sourceHeight=74,this.wButton.hAlign="right",this.wButton.vAlign="bottom",this.wButton.positionX=-60,this.wButton.positionY=165,this.wButton.width=40,this.wButton.height=40,this.wButton.isPointerBlocker=!0,this.wButton.onClick=new OnClick((function(){A.adjustTransform("w"),engine.addSystem(new O(A.wButton))})),this.eButton=new UIImage(this.uiMaximizedContainer,v),this.eButton.sourceLeft=422,this.eButton.sourceTop=544,this.eButton.sourceWidth=74,this.eButton.sourceHeight=74,this.eButton.hAlign="right",this.eButton.vAlign="bottom",this.eButton.positionX=-15,this.eButton.positionY=165,this.eButton.width=40,this.eButton.height=40,this.eButton.isPointerBlocker=!0,this.eButton.onClick=new OnClick((function(){A.adjustTransform("e"),engine.addSystem(new O(A.eButton))})),this.aButton=new UIImage(this.uiMaximizedContainer,v),this.aButton.sourceLeft=16,this.aButton.sourceTop=544,this.aButton.sourceWidth=74,this.aButton.sourceHeight=74,this.aButton.hAlign="right",this.aButton.vAlign="bottom",this.aButton.positionX=-105,this.aButton.positionY=120,this.aButton.width=40,this.aButton.height=40,this.aButton.isPointerBlocker=!0,this.aButton.onClick=new OnClick((function(){A.adjustTransform("a"),engine.addSystem(new O(A.aButton))})),this.sButton=new UIImage(this.uiMaximizedContainer,v),this.sButton.sourceLeft=259,this.sButton.sourceTop=544,this.sButton.sourceWidth=74,this.sButton.sourceHeight=74,this.sButton.hAlign="right",this.sButton.vAlign="bottom",this.sButton.positionX=-60,this.sButton.positionY=120,this.sButton.width=40,this.sButton.height=40,this.sButton.isPointerBlocker=!0,this.sButton.onClick=new OnClick((function(){A.adjustTransform("s"),engine.addSystem(new O(A.sButton))})),this.dButton=new UIImage(this.uiMaximizedContainer,v),this.dButton.sourceLeft=97,this.dButton.sourceTop=544,this.dButton.sourceWidth=74,this.dButton.sourceHeight=74,this.dButton.hAlign="right",this.dButton.vAlign="bottom",this.dButton.positionX=-15,this.dButton.positionY=120,this.dButton.width=40,this.dButton.height=40,this.dButton.isPointerBlocker=!0,this.dButton.onClick=new OnClick((function(){A.adjustTransform("d"),engine.addSystem(new O(A.dButton))})),this.modeButton=new UIImage(this.uiMaximizedContainer,v),this.modeButton.sourceLeft=259,this.modeButton.sourceTop=94,this.modeButton.sourceWidth=74,this.modeButton.sourceHeight=74,this.modeButton.hAlign="right",this.modeButton.vAlign="bottom",this.modeButton.positionX=-105,this.modeButton.positionY=75,this.modeButton.width=40,this.modeButton.height=40,this.modeButton.isPointerBlocker=!0,this.modeButton.onClick=new OnClick((function(){A.mode+=1,A.mode>A.modeSCALE&&(A.mode=A.modePOSITION),A.snap=0,A.setSnaps(),A.applyModeAndSnapLabels(),engine.addSystem(new O(A.modeButton))})),this.modeLabel=new UIText(this.modeButton),this.modeLabel.color=Color4.White(),this.modeLabel.hAlign="center",this.modeLabel.vAlign="bottom",this.modeLabel.paddingTop=0,this.modeLabel.paddingBottom=12,this.modeLabel.positionX=-30,this.modeLabel.paddingLeft=0,this.modeLabel.fontSize=12,this.modeLabel.fontWeight="bold",this.modeLabel.isPointerBlocker=!1,this.modeLabel.hTextAlign="center",this.snapButton=new UIImage(this.uiMaximizedContainer,v),this.snapButton.sourceLeft=259,this.snapButton.sourceTop=93,this.snapButton.sourceWidth=74,this.snapButton.sourceHeight=74,this.snapButton.hAlign="right",this.snapButton.vAlign="bottom",this.snapButton.positionX=-60,this.snapButton.positionY=75,this.snapButton.width=40,this.snapButton.height=40,this.snapButton.isPointerBlocker=!0,this.snapButton.onClick=new OnClick((function(){A.snap+=1,A.snap>3&&(A.snap=0),A.setSnaps(),A.applyModeAndSnapLabels(),engine.addSystem(new O(A.snapButton))})),this.snapLabel=new UIText(this.snapButton),this.snapLabel.color=Color4.White(),this.snapLabel.hAlign="right",this.snapLabel.vAlign="bottom",this.snapLabel.positionX=-30,this.snapLabel.paddingTop=0,this.snapLabel.paddingBottom=12,this.snapLabel.paddingLeft=0,this.snapLabel.fontSize=12,this.snapLabel.fontWeight="bold",this.snapLabel.hTextAlign="center",this.snapLabel.isPointerBlocker=!1,this.applyModeAndSnapLabels(!0),this.minimizeButton=new UIImage(this.uiMaximizedContainer,v),this.minimizeButton.sourceLeft=908,this.minimizeButton.sourceTop=544,this.minimizeButton.sourceWidth=74,this.minimizeButton.sourceHeight=74,this.minimizeButton.hAlign="right",this.minimizeButton.vAlign="bottom",this.minimizeButton.positionX=-15,this.minimizeButton.positionY=30,this.minimizeButton.width=40,this.minimizeButton.height=40,this.minimizeButton.isPointerBlocker=!0,this.minimizeButton.onClick=new OnClick((function(){A.minimizeUI(),engine.addSystem(new O(A.minimizeButton))})),(S=new UIText(this.uiMaximizedContainer)).value="Builder HUD",S.color=Color4.White(),S.hAlign="center",S.vAlign="bottom",S.paddingTop=0,S.paddingBottom=5,S.paddingLeft=15,S.fontSize=12,S.isPointerBlocker=!1,this.minimizeUI(),[2]}))}))},t.prototype.setSnaps=function(){switch(this.snap){case 0:this.snapPosScale=1,this.snapRot=90;break;case 1:this.snapPosScale=.1,this.snapRot=15;break;case 2:this.snapPosScale=.01,this.snapRot=5;break;case 3:this.snapPosScale=.001,this.snapRot=1}},t.prototype.applyModeAndSnapLabels=function(v){switch(this.mode){case this.modePOSITION:this.modeLabel.value="P";break;case this.modeROTATION:this.modeLabel.value="R";break;case this.modeSCALE:this.modeLabel.value="S";break;default:this.modeLabel.value="ERR"}switch(!v&&this.updateDisplayPRS(),this.snap){case 0:this.mode==this.modeROTATION?this.snapLabel.value="90":this.snapLabel.value="1";break;case 1:this.mode==this.modeROTATION?this.snapLabel.value="15":this.snapLabel.value="0.1";break;case 2:this.mode==this.modeROTATION?this.snapLabel.value="5":this.snapLabel.value="0.01";break;case 3:this.mode==this.modeROTATION?this.snapLabel.value="1":this.snapLabel.value="0.001";break;default:this.snapLabel.value="ERR"}},t.prototype.countDecimals=function(v){return Math.floor(v)===v?0:v.toString().split(".")[1].length||0},t.prototype.updateDisplayPRS=function(){switch(this.mode){case this.modePOSITION:this.displayPRS.value="POS: ("+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).position.x.toFixed(this.countDecimals(this.snapPosScale))+","+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).position.y.toFixed(this.countDecimals(this.snapPosScale))+","+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).position.z.toFixed(this.countDecimals(this.snapPosScale))+")";break;case this.modeROTATION:this.displayPRS.value="ROT: ("+Math.ceil(this.entities[this.selectedEntityIndex].entity.getComponent(Transform).rotation.eulerAngles.x)+","+Math.ceil(this.entities[this.selectedEntityIndex].entity.getComponent(Transform).rotation.eulerAngles.y)+","+Math.ceil(this.entities[this.selectedEntityIndex].entity.getComponent(Transform).rotation.eulerAngles.z)+")";break;case this.modeSCALE:this.displayPRS.value="SCL: ("+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).scale.x.toFixed(this.countDecimals(this.snapPosScale))+","+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).scale.y.toFixed(this.countDecimals(this.snapPosScale))+","+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).scale.z.toFixed(this.countDecimals(this.snapPosScale))+")"}},t.prototype.maximizeUI=function(){this.uiMinimizedContainer.visible=!1,this.uiMaximizedContainer.visible=!0,this.uiMaximized=!0,this.selectedEntityIndex>=0&&this.numEntities>0&&engine.addEntity(this.selectionPointer),this.mode=this.modePOSITION,this.applyModeAndSnapLabels(),this.displayName.value=this.entities[this.selectedEntityIndex].entity.name,this.updateDisplayPRS(),this.scaffolding.getComponent(Transform).scale=this.scaffoldScale},t.prototype.minimizeUI=function(){this.uiMaximizedContainer.visible=!1,this.uiMinimizedContainer.visible=!0,this.uiMaximized=!1,this.selectedEntityIndex>=0&&this.numEntities>0&&engine.removeEntity(this.selectionPointer),this.scaffolding.getComponent(Transform).scale=Vector3.Zero()},t.prototype.showUI=function(){this.canvas.visible=!0,this.canvas.isPointerBlocker=!0},t.prototype.hideUI=function(){this.canvas.visible=!1,this.canvas.isPointerBlocker=!1},t.prototype.updateSelectionPointerPOS=function(v){var T=v.position.clone();this.selectionPointer.getComponent(Transform).position=new Vector3(T.x,T.y+this.selectionPointerElevation,T.z)},t.prototype.selectEntity=function(v){this.selectedEntityIndex=v,null!=this.entities[v].entity&&(this.displayName.value=this.entities[this.selectedEntityIndex].entity.name,this.updateSelectionPointerPOS(this.entities[v].entity.getComponent(Transform)))},t.prototype.selectPrevious=function(){this.selectedEntityIndex>0&&this.selectEntity(this.selectedEntityIndex-1),this.updateDisplayPRS()},t.prototype.selectNext=function(){this.selectedEntityIndex<this.numEntities-1&&this.selectEntity(this.selectedEntityIndex+1),this.updateDisplayPRS()},t.prototype.discardSelected=function(){log("Discard Selected Entity isn't implemented at this time.")},t.prototype.toggleCameraOptions=function(){this.movingSystem.addCameraPosition(new Vector3(8,8,8)),log(this.movingSystem.positions),this.scaffolding.addComponent(new C("","fixed",0))},t.prototype.toggleColliders=function(v){584==this.toggleLift.sourceLeft?(this.toggleLift.sourceLeft=503,this.scaffloor.getComponent(Material).albedoColor=new Color4(.97,.27,.34),this.backWall.getComponent(Transform).scale=this.scaffoldScale,this.backWall.getComponent(Transform).position=new Vector3(-.6,1.5,0),this.frontWall.getComponent(Transform).scale=this.scaffoldScale,this.frontWall.getComponent(Transform).position=new Vector3(.6,1.5,0),this.leftWall.getComponent(Transform).scale=this.scaffoldScale,this.leftWall.getComponent(Transform).position=new Vector3(0,1.5,.6),this.rightWall.getComponent(Transform).scale=this.scaffoldScale,this.rightWall.getComponent(Transform).position=new Vector3(0,1.5,-.6)):(this.toggleLift.sourceLeft=584,this.backWall.getComponent(Transform).scale=Vector3.Zero(),this.frontWall.getComponent(Transform).scale=Vector3.Zero(),this.leftWall.getComponent(Transform).scale=Vector3.Zero(),this.rightWall.getComponent(Transform).scale=Vector3.Zero(),this.rightWall.getComponent(Transform).position=new Vector3(0,-41.5,-.6),this.backWall.getComponent(Transform).position=new Vector3(0,-4.5,-.6),this.frontWall.getComponent(Transform).position=new Vector3(0,-4.5,-.6),this.leftWall.getComponent(Transform).position=new Vector3(0,-4.5,-.6),this.scaffloor.getComponent(Material).albedoColor=Color4.White()),v&&(this.scaffolding.getComponent(Transform).position=new Vector3(1,.3,1))},t.prototype.moveScaffold=function(v){var T=this.scaffolding.getComponent(Transform);if(this.mode===this.modePOSITION)switch(T.position,v){case"a":this.scaffolding.hasComponent(C)?this.scaffolding.removeComponent(C):this.scaffolding.addComponent(new C("left","free"));break;case"s":this.scaffolding.hasComponent(C)?this.scaffolding.removeComponent(C):this.scaffolding.addComponent(new C("down","free"));break;case"d":this.scaffolding.hasComponent(C)?this.scaffolding.removeComponent(C):this.scaffolding.addComponent(new C("right","free"));break;case"q":this.scaffolding.hasComponent(C)?this.scaffolding.removeComponent(C):this.scaffolding.addComponent(new C("back","free"));break;case"w":this.scaffolding.hasComponent(C)?this.scaffolding.removeComponent(C):this.scaffolding.addComponent(new C("up","free"));break;case"e":this.scaffolding.hasComponent(C)?this.scaffolding.removeComponent(C):this.scaffolding.addComponent(new C("forward","free"))}},t.prototype.adjustTransform=function(v){this.unsavedContainer.visible=!0;var T=this.entities[this.selectedEntityIndex].entity.getComponent(Transform);switch(this.mode){case this.modePOSITION:var C=T.position;switch(v){case"a":C.x-=this.snapPosScale;break;case"s":C.y-=this.snapPosScale;break;case"d":C.x+=this.snapPosScale;break;case"q":C.z-=this.snapPosScale;break;case"w":C.y+=this.snapPosScale;break;case"e":C.z+=this.snapPosScale}this.updateSelectionPointerPOS(T);break;case this.modeROTATION:switch(v){case"a":T.rotate(Vector3.Left(),-this.snapRot);break;case"s":T.rotate(Vector3.Up(),this.snapRot);break;case"d":T.rotate(Vector3.Left(),this.snapRot);break;case"q":T.rotate(Vector3.Forward(),-this.snapRot);break;case"w":T.rotate(Vector3.Up(),-this.snapRot);break;case"e":T.rotate(Vector3.Forward(),this.snapRot)}break;case this.modeSCALE:var S=T.scale;switch(v){case"a":S.x-=this.snapPosScale;break;case"s":S.y-=this.snapPosScale;break;case"d":S.x+=this.snapPosScale;break;case"q":S.z-=this.snapPosScale;break;case"w":S.y+=this.snapPosScale;break;case"e":S.z+=this.snapPosScale}}this.updateDisplayPRS()},t.prototype.attachToEntity=function(v,T){return void 0===T&&(T=!0),e(this,void 0,void 0,(function(){return n(this,(function(C){return null==v?log("BuilderHUD attachToEntity called with a null entity"):z.isSetup&&(this.entities[this.numEntities]={entity:v,transform:v.getComponent(Transform),preexisting:T},T?(this.selectedEntityIndex=-1)&&this.selectEntity(0):this.selectEntity(this.numEntities),this.numEntities++),[2]}))}))},t.prototype.newEntity=function(){var v=Camera.instance,T=v.rotation.eulerAngles.y;T>=180?T-=180:T+=180;var C=0,S=0,A=0,E=1,R=1,z=1;if(null!=this.defaultParent){var O=this.defaultParent.getComponent(Transform);C=O.position.x,S=O.position.y,A=O.position.z,O.rotation.eulerAngles.x,O.rotation.eulerAngles.y,O.rotation.eulerAngles.z,E=O.scale.x,R=O.scale.y,z=O.scale.z}var M=new Transform({position:new Vector3((v.position.x-C)/E,(0-S)/R,(v.position.z-A)/z),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(this.newEntityScale/E,this.newEntityScale/R,this.newEntityScale/z)});M.rotate(Vector3.Up(),-T);var B=new Entity;if(B.name="Entity"+this.numEntities,B.addComponent(M),null==this.newEntityShape)try{this.newEntityShape=new GLTFShape("models/xyz/xyzLeftHand.glb")}catch(B){this.newEntityShape=new BoxShape,(new Material).albedoColor=Color3.Green()}B.addComponent(this.newEntityShape),null!=this.defaultParent&&B.setParent(this.defaultParent),engine.addEntity(B),this.attachToEntity(B,!1)},t.prototype.round=function(v){return Math.floor(1e3*(v+49e-5))/1e3},t.prototype.dump=function(){for(var v in this.unsavedContainer.visible=!1,log("--------------- BuilderHUD entities -------------"),this.entities){var T=null==this.entities[v].entity.name?"Existing":""+this.entities[v].entity.name,C=this.entities[v].transform,S=C.position,A=C.rotation.eulerAngles,E=C.scale,R="position: new Vector3("+this.round(S.x)+","+this.round(S.y)+","+this.round(S.z)+"), rotation: Quaternion.Euler("+this.round(A.x)+","+this.round(A.y)+","+this.round(A.z)+"), scale: new Vector3("+this.round(E.x)+","+this.round(E.y)+","+this.round(E.z)+")";log(T+" {"+R+"}")}log("-------------------------------------------------")},t.prototype.destroy=function(){for(var v in this.dump(),this.entities)this.entities[v].preexisting||(this.entities[v].entity.setParent(null),engine.removeEntity(this.entities[v].entity));this.entities=[],this.numEntities=0,this.refreshDisplay()},t.prototype.refreshDisplay=function(){},t}(),R=function(){function t(v){this.timer=4,this.entities=[],this.hud=v}return t.prototype.pendingEntity=function(v){this.entities.push(v)},t.prototype.update=function(v){if(this.timer>0)this.timer-=v;else{this.timer=4;for(var T=0;T<this.entities.length;T++)log("here"),this.hud.attachToEntity(this.entities[T],!0);this.entities=[]}},t}(),z=new E;z.pendingEntityAdd=new R(z),engine.addSystem(z.pendingEntityAdd);var O=function(){function t(v){this.timer=.1,this.uiIMage=v}return t.prototype.update=function(v){this.timer>0?(this.uiIMage.opacity-=.3,this.timer-=v):(this.timer=.1,this.uiIMage.opacity=1,engine.removeSystem(this))},t}();v.hud=z,Object.defineProperty(v,"__esModule",{value:!0})}));var __awaiter=this&&this.__awaiter||function(v,T,C,S){return new(C||(C=Promise))((function(A,E){function fulfilled(v){try{step(S.next(v))}catch(v){E(v)}}function rejected(v){try{step(S.throw(v))}catch(v){E(v)}}function step(v){var T;v.done?A(v.value):(T=v.value,T instanceof C?T:new C((function(v){v(T)}))).then(fulfilled,rejected)}step((S=S.apply(v,T||[])).next())}))},__generator=this&&this.__generator||function(v,T){var C,S,A,E,R={label:0,sent:function(){if(1&A[0])throw A[1];return A[1]},trys:[],ops:[]};return E={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(E[Symbol.iterator]=function(){return this}),E;function verb(E){return function(z){return function(E){if(C)throw new TypeError("Generator is already executing.");for(;R;)try{if(C=1,S&&(A=2&E[0]?S.return:E[0]?S.throw||((A=S.return)&&A.call(S),0):S.next)&&!(A=A.call(S,E[1])).done)return A;switch(S=0,A&&(E=[2&E[0],A.value]),E[0]){case 0:case 1:A=E;break;case 4:return R.label++,{value:E[1],done:!1};case 5:R.label++,S=E[1],E=[0];continue;case 7:E=R.ops.pop(),R.trys.pop();continue;default:if(!((A=(A=R.trys).length>0&&A[A.length-1])||6!==E[0]&&2!==E[0])){R=0;continue}if(3===E[0]&&(!A||E[1]>A[0]&&E[1]<A[3])){R.label=E[1];break}if(6===E[0]&&R.label<A[1]){R.label=A[1],A=E;break}if(A&&R.label<A[2]){R.label=A[2],R.ops.push(E);break}A[2]&&R.ops.pop(),R.trys.pop();continue}E=T.call(v,R)}catch(v){E=[6,v],S=0}finally{C=A=0}if(5&E[0])throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}([E,z])}}},__extends=this&&this.__extends||function(){var extendStatics=function(v,T){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,T){v.__proto__=T}||function(v,T){for(var C in T)Object.prototype.hasOwnProperty.call(T,C)&&(v[C]=T[C])},extendStatics(v,T)};return function(v,T){if("function"!=typeof T&&null!==T)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function __(){this.constructor=v}extendStatics(v,T),v.prototype=null===T?Object.create(T):(__.prototype=T.prototype,new __)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(v){for(var T,C=1,S=arguments.length;C<S;C++)for(var A in T=arguments[C])Object.prototype.hasOwnProperty.call(T,A)&&(v[A]=T[A]);return v},__assign.apply(this,arguments)},__values=this&&this.__values||function(v){var T="function"==typeof Symbol&&Symbol.iterator,C=T&&v[T],S=0;if(C)return C.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&S>=v.length&&(v=void 0),{value:v&&v[S++],done:!v}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")};define("src/danceArea",["require","exports","@dcl/ecs-scene-utils","@decentraland/EnvironmentAPI","@decentraland/RestrictedActions"],(function(v,T,C,S,A){Object.defineProperty(T,"__esModule",{value:!0}),T.DanceSystem=T.danceAreas=void 0,T.danceAreas=[{transform:{position:new Vector3(8,0,8),scale:new Vector3(15,3,15)},type:"all"}];var E=function(){function DanceSystem(v){var T=this;this.length=11,this.timer=2,this.danceFunction=function(){T.dance()},this.routines=["robot","tik","hammer","tektonik","disco","dab"],this.routine=v}return DanceSystem.prototype.update=function(v){this.timer>0?this.timer-=v:this.dance()},DanceSystem.prototype.dance=function(){if(this.timer=this.length,"all"===this.routine){var v=Math.floor(Math.random()*(this.routine.length-0)+0);(0,A.triggerEmote)({predefined:this.routines[v]})}else(0,A.triggerEmote)({predefined:this.routine})},DanceSystem.prototype.addEvents=function(){Input.instance.subscribe("BUTTON_UP",ActionButton.FORWARD,!1,this.danceFunction),Input.instance.subscribe("BUTTON_UP",ActionButton.BACKWARD,!1,this.danceFunction),Input.instance.subscribe("BUTTON_UP",ActionButton.RIGHT,!1,this.danceFunction),Input.instance.subscribe("BUTTON_UP",ActionButton.LEFT,!1,this.danceFunction)},DanceSystem.prototype.removeEvents=function(){Input.instance.unsubscribe("BUTTON_UP",ActionButton.FORWARD,this.danceFunction),Input.instance.unsubscribe("BUTTON_UP",ActionButton.BACKWARD,this.danceFunction),Input.instance.unsubscribe("BUTTON_UP",ActionButton.RIGHT,this.danceFunction),Input.instance.unsubscribe("BUTTON_UP",ActionButton.LEFT,this.danceFunction)},DanceSystem}();T.DanceSystem=E;var _loop_1=function(v){var A=new Entity("dance-"+v);A.addComponent(new Transform(T.danceAreas[v].transform)),executeTask((function(){return __awaiter(void 0,void 0,void 0,(function(){var v;return __generator(this,(function(T){switch(T.label){case 0:return(v=!1)?[4,(0,S.isPreviewMode)()]:[3,2];case 1:v=T.sent(),T.label=2;case 2:return v&&(A.addComponent(new BoxShape),A.getComponent(BoxShape).withCollisions=!1),[2]}}))}))})),engine.addEntity(A);var R=new E(T.danceAreas[v].type);A.addComponent(new C.TriggerComponent(new C.TriggerBoxShape(new Vector3(A.getComponent(Transform).scale.x,A.getComponent(Transform).scale.y,A.getComponent(Transform).scale.z),new Vector3(0,2.5,0)),{enableDebug:!1,onCameraEnter:function(){engine.addSystem(R),R.addEvents()},onCameraExit:function(){R.removeEvents(),engine.removeSystem(R)}}))};for(var R in T.danceAreas)_loop_1(R)})),define("src/sound",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.Sound=void 0;var C=function(v){function Sound(T,C){var S=v.call(this)||this;return engine.addEntity(S),S.addComponent(new AudioSource(T)),S.getComponent(AudioSource).loop=C,S.addComponent(new Transform),S.setParent(Attachable.AVATAR),S}return __extends(Sound,v),Sound.prototype.playOnce=function(){this.getComponent(AudioSource).volume=1,this.getComponent(AudioSource).playOnce()},Sound}(Entity);T.Sound=C})),define("src/data",["require","exports","src/sound"],(function(v,T,C){Object.defineProperty(T,"__esModule",{value:!0}),T.ApeShit=void 0,T.ApeShit=new C.Sound(new AudioClip("sounds/ApeShit.mp3"),!1)})),define("node_modules/decentraland-builder-scripts/channel",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.createChannel=void 0;var C="__request_value__",S="__reply_value__";T.createChannel=function(v,T,A){var E={},R={},z={};return A.on(T.name,(function(v){var T=E[v.actionId];T&&T(v),R={}})),A.on(C,(function(C){if(C.sender!==v&&C.entityName===T.name){var E=C.key,O=z[E];if(O){var M=O(),B={entityName:T.name,key:E,sender:v,value:M};A.emit(S,B)}delete R[E]}})),A.on(S,(function(C){if(C.sender!==v&&C.entityName===T.name){var S=C.key,A=C.value,E=R[S];E&&E(A),delete R[S]}})),{id:v,bus:A,createAction:function(v,C){return{entityName:T.name,actionId:v,values:C}},sendActions:function(T){var C,S;void 0===T&&(T=[]);try{for(var E=__values(T),R=E.next();!R.done;R=E.next()){var z=R.value,O=__assign(__assign({},z),{sender:v});A.emit(O.entityName,O)}}catch(v){C={error:v}}finally{try{R&&!R.done&&(S=E.return)&&S.call(E)}finally{if(C)throw C.error}}},handleAction:function(v,T){E[v]=T},request:function(S,E){R[S]=E;var z={entityName:T.name,key:S,sender:v},O=setInterval((function(){S in R?A.emit(C,z):clearInterval(O)}),5e3)},reply:function(v,T){z[v]=T}}}})),define("node_modules/decentraland-builder-scripts/inventory",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.createInventory=void 0,T.createInventory=function(v,T,C){var S=null,A=null,E={};return{add:function(R,z){var O=E[R]||new C((S||(S=new v),A||((A=new T(S)).isPointerBlocker=!1,A.vAlign="bottom",A.hAlign="right",A.stackOrientation=0,A.spacing=0,A.positionY=75,A.positionX=-25),A),z);O.width=128,O.height=128,O.sourceTop=0,O.sourceLeft=0,O.sourceHeight=256,O.sourceWidth=256,O.isPointerBlocker=!1,O.visible=!0,E[R]=O},remove:function(v){var T=E[v];T&&(T.visible=!1,T.height=0,T.width=0)},has:function(v){return v in E&&E[v].visible}}}})),define("ff9257ec-9d62-404f-97c7-cf19c4035761/src/item",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0});var C=function(){function Button(){this.openClip=new AudioClip("ff9257ec-9d62-404f-97c7-cf19c4035761/sounds/open.mp3"),this.closeClip=new AudioClip("ff9257ec-9d62-404f-97c7-cf19c4035761/sounds/close.mp3"),this.active={}}return Button.prototype.init=function(){},Button.prototype.toggle=function(v,T,C){if(void 0===C&&(C=!0),this.active[v.name]!==T){if(C){var S=new AudioSource(T?this.openClip:this.closeClip);v.addComponentOrReplace(S),S.playing=!0}var A=v.getComponent(Animator),E=A.getClip("open"),R=A.getClip("close");E.stop(),R.stop(),(T?E:R).play(),this.active[v.name]=T}},Button.prototype.spawn=function(v,T,C){var S=this,A=new Entity(v.name+"-button");A.setParent(v);var E=new Animator,R=new AnimationState("close",{looping:!1}),z=new AnimationState("open",{looping:!1});E.addClip(R),E.addClip(z),A.addComponent(E),z.stop(),A.addComponent(new GLTFShape("ff9257ec-9d62-404f-97c7-cf19c4035761/models/Chest_Fantasy.glb")),A.addComponent(new OnPointerDown((function(){C.sendActions(T.onClick)}),{button:ActionButton.POINTER,hoverText:'Gold "Bars"',distance:6})),this.active[A.name]=!1,C.handleAction("open",(function(v){var E=v.sender;S.active[A.name]||S.toggle(A,!0),E===C.id&&C.sendActions(T.onOpen)})),C.handleAction("close",(function(v){var E=v.sender;S.active[A.name]&&S.toggle(A,!1),E===C.id&&C.sendActions(T.onClose)})),C.handleAction("toggle",(function(v){var E=v.sender,R=!S.active[A.name];S.toggle(A,R),E===C.id&&C.sendActions(R?T.onOpen:T.onClose)})),C.request("isOpen",(function(v){return S.toggle(A,v,!1)})),C.reply("isOpen",(function(){return S.active[A.name]}))},Button}();T.default=C})),define("src/game",["require","exports","node_modules/decentraland-builder-scripts/channel","node_modules/decentraland-builder-scripts/inventory","ff9257ec-9d62-404f-97c7-cf19c4035761/src/item","dcl-builder-hud","@decentraland/Identity"],(function(v,T,C,S,A,E,R){Object.defineProperty(T,"__esModule",{value:!0});var z=new Entity("_scene");engine.addEntity(z);var O=new Transform({position:new Vector3(0,0,0),rotation:new Quaternion(0,0,0,1),scale:new Vector3(1,1,1)});z.addComponentOrReplace(O);var M=new Entity("entity");engine.addEntity(M),M.setParent(z);var B=new GLTFShape("6b33f46e-9667-45e5-bd90-85f372ee2490/CityTile.glb");B.withCollisions=!0,B.isPointerBlocker=!0,B.visible=!0,M.addComponentOrReplace(B);var V=new Transform({position:new Vector3(8,0,8),rotation:new Quaternion(0,0,0,1),scale:new Vector3(1,1,1)});M.addComponentOrReplace(V);var q=new Entity("lastSlicePizzaBox");engine.addEntity(q),q.setParent(z);var j=new Transform({position:new Vector3(8.4,.03,5.9),rotation:new Quaternion(.2,.20526227355003357,.6766590476036072,.6766590476036072),scale:new Vector3(.415,.25,.27)});q.addComponentOrReplace(j),E.hud.attachToEntity(q);var H=new GLTFShape("4d5ab1ac-99b6-4a4f-8317-4f3f8e8df33a/last_slice_pizza_box.glb");H.withCollisions=!0,H.isPointerBlocker=!0,H.visible=!0,q.addComponentOrReplace(H);var W=new Entity("neatDRotating");engine.addEntity(W),W.setParent(z);var X=new Transform({position:new Vector3(13,2.65,3),rotation:new Quaternion(0,0,0,1),scale:new Vector3(1.2499998807907104,1.25,1.500000238418579)});W.addComponentOrReplace(X),E.hud.attachToEntity(W);var Q=new GLTFShape("43b77ce0-07eb-493f-8c21-c091815984c7/NEAT_3D_rotating.glb");Q.withCollisions=!0,Q.isPointerBlocker=!0,Q.visible=!0,W.addComponentOrReplace(Q);var Z=new Entity("neatDRotating2");engine.addEntity(Z),Z.setParent(z);var J=new Transform({position:new Vector3(3,2.65,3),rotation:new Quaternion(0,0,0,1),scale:new Vector3(1.2499998807907104,1.25,1.500000238418579)});Z.addComponentOrReplace(J),E.hud.attachToEntity(Z);var K=new GLTFShape("43b77ce0-07eb-493f-8c21-c091815984c7/NEAT_3D_rotating.glb");K.withCollisions=!0,K.isPointerBlocker=!0,K.visible=!0,Z.addComponentOrReplace(K);var $=new Entity("fantasyChest");engine.addEntity($),$.setParent(z);var et=new Transform({position:new Vector3(8,0,8),rotation:new Quaternion(0,180,NaN),scale:new Vector3(1.000000238418579,1,1.000000238418579)});$.addComponentOrReplace(et),E.hud.attachToEntity($);var nt=Math.random().toString(16).slice(2),it=new MessageBus,ot=((0,S.createInventory)(UICanvas,UIContainerStack,UIImage),new A.default);ot.init(),ot.spawn($,{onClickText:"Open/Close",onClick:[{entityName:"fantasyChest",actionId:"toggle",values:{}}]},(0,C.createChannel)(nt,$,it));var rt=new Entity,st=new AvatarShape;st.bodyShape="urn:decentraland:off-chain:base-avatars:BaseFemale",st.wearables=["urn:decentraland:off-chain:base-avatars:f_sweater","urn:decentraland:off-chain:base-avatars:f_jeans","urn:decentraland:off-chain:base-avatars:bun_shoes","urn:decentraland:off-chain:base-avatars:standard_hair","urn:decentraland:off-chain:base-avatars:f_eyes_00","urn:decentraland:off-chain:base-avatars:f_eyebrows_00","urn:decentraland:off-chain:base-avatars:f_mouth_00"],st.skinColor=new Color4(.94921875,.76171875,.6484375,1),st.eyeColor=new Color4(.23046875,.625,.3125,1),st.hairColor=new Color4(.234375,.12890625,.04296875,1),rt.addComponent(st),rt.addComponent(new Transform({position:new Vector3(2.3,-1.16,13.3),rotation:new Quaternion(0,180,0),scale:new Vector3(2.5,2.5,2.5)})),engine.addEntity(rt),E.hud.attachToEntity(rt),(0,R.getUserData)().then((function(v){return __awaiter(void 0,void 0,void 0,(function(){var T,C;return __generator(this,(function(S){switch(S.label){case 0:return[4,fetch("https://peer.decentraland.org/lambdas/profiles/".concat(null==v?void 0:v.publicKey))];case 1:return[4,S.sent().json()];case 2:return T=S.sent(),C=T.avatars[0].avatar,st.bodyShape=C.bodyShape,st.skinColor=new Color4(C.skin.color.r,C.skin.color.g,C.skin.color.b,1),st.eyeColor=new Color4(C.eyes.color.r,C.eyes.color.g,C.eyes.color.b,1),st.hairColor=new Color4(C.hair.color.r,C.hair.color.g,C.hair.color.b,1),st.wearables=C.wearables,st.name=C.name,[2]}}))}))}));var at=new Entity,ht=new AvatarShape;ht.bodyShape="urn:decentraland:off-chain:base-avatars:BaseFemale",ht.wearables=["urn:decentraland:off-chain:base-avatars:f_sweater","urn:decentraland:off-chain:base-avatars:f_jeans","urn:decentraland:off-chain:base-avatars:bun_shoes","urn:decentraland:off-chain:base-avatars:standard_hair","urn:decentraland:off-chain:base-avatars:f_eyes_00","urn:decentraland:off-chain:base-avatars:f_eyebrows_00","urn:decentraland:off-chain:base-avatars:f_mouth_00"],ht.skinColor=new Color4(.94921875,.76171875,.6484375,1),ht.eyeColor=new Color4(.23046875,.625,.3125,1),ht.hairColor=new Color4(.234375,.12890625,.04296875,1),at.addComponent(ht),at.addComponent(new Transform({position:new Vector3(13.5,-1.16,12.8),rotation:new Quaternion(0,180,0),scale:new Vector3(2.5,2.5,2.5)})),engine.addEntity(at),E.hud.attachToEntity(at),(0,R.getUserData)().then((function(v){return __awaiter(void 0,void 0,void 0,(function(){var T,C;return __generator(this,(function(S){switch(S.label){case 0:return[4,fetch("https://peer.decentraland.org/lambdas/profiles/".concat(null==v?void 0:v.publicKey))];case 1:return[4,S.sent().json()];case 2:return T=S.sent(),C=T.avatars[0].avatar,ht.bodyShape=C.bodyShape,ht.skinColor=new Color4(C.skin.color.r,C.skin.color.g,C.skin.color.b,1),ht.eyeColor=new Color4(C.eyes.color.r,C.eyes.color.g,C.eyes.color.b,1),ht.hairColor=new Color4(C.hair.color.r,C.hair.color.g,C.hair.color.b,1),ht.wearables=C.wearables,ht.name="",[2]}}))}))}))}));